ROOT_PATH: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language
Building Bayesian Optimizer for 
 data:MPQA 
 choices:[{'name': 'lr', 'type': 'continuous', 'domain': [5e-05, 0.005]}, {'name': 'rnn_dropout', 'type': 'continuous', 'domain': [0, 1]}, {'name': 'dropout', 'type': 'continuous', 'domain': [0, 1]}, {'name': 'l2', 'type': 'continuous', 'domain': [0, 1]}]
SETTINGS FOR THIS RUN
{'tune_wordvecs': False, 'tune_attn': False, 'l2': 0.4022621995384825, 'attn_type': 'similarity', 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.5691364879936501, 'wordvec_dim': 300, 'dropout': 0.19718330921055827, 'wordvec_source': 'glove', 'data': 'MPQA', 'lr': 0.002279297103481781}
Using CUDA!
here
similarity
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['GloVe']
Getting GloVe Vectors with 300 dims
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fb0d521a668>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
similarity
Using Attention model with following args:
{'train_word_vecs': False, 'hidden_size': 300, 'attn_type': 'similarity', 'cuda': True, 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.5691364879936501, 'num_classes': 2, 'input_size': 300, 'dropout': 0.19718330921055827, 'tune_attn': False, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
-0.4786 -0.1089 -0.0076  ...   0.7458  0.7174  0.6185
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
-0.0479  0.9828  0.9182  ...   0.0424  0.4554 -0.3210
[torch.FloatTensor of size 15284x300]
, 'attention_dim': 350, 'vocab_size': 15284}
Not Tuning Word Vectors!
Begin Training...
Completing Train Step at 0th epoch...
At time: 1.2280220985412598 accuracy is 0.58125 and loss is 0.7734767913818359
At time: 1.3860242366790771 accuracy is 0.65625 and loss is 0.6626557350158692
At time: 1.5597753524780273 accuracy is 0.553125 and loss is 0.6906839847564697
At time: 1.7406244277954102 accuracy is 0.6390625 and loss is 0.7916199684143066
At time: 1.9288041591644287 accuracy is 0.7234375 and loss is 0.5770268440246582
At time: 2.132307767868042 accuracy is 0.7203125 and loss is 0.7347306728363037
At time: 2.3642406463623047 accuracy is 0.703125 and loss is 0.594617509841919
At time: 2.577630043029785 accuracy is 0.69375 and loss is 0.5975513935089112
At time: 2.8119516372680664 accuracy is 0.70625 and loss is 0.5968774795532227
At time: 3.0492892265319824 accuracy is 0.75 and loss is 0.6172791004180909
At time: 3.3121843338012695 accuracy is 0.7234375 and loss is 0.6014010429382324
At time: 3.594592571258545 accuracy is 0.734375 and loss is 0.5543917655944824
Evaluating...
Done Evaluating: Achieved accuracy of 0.6308139534883721
Achieved new best!
Completing Train Step at 1th epoch...
At time: 4.485761880874634 accuracy is 0.7015625 and loss is 0.6896914958953857
At time: 4.658127307891846 accuracy is 0.6953125 and loss is 0.5772441864013672
At time: 4.818782567977905 accuracy is 0.7953125 and loss is 0.4922493934631348
At time: 4.984230995178223 accuracy is 0.7234375 and loss is 0.5282301425933837
At time: 5.157413959503174 accuracy is 0.734375 and loss is 0.5716036796569824
At time: 5.328450679779053 accuracy is 0.7640625 and loss is 0.5110465526580811
At time: 5.505447864532471 accuracy is 0.728125 and loss is 0.5795855522155762
At time: 5.691349744796753 accuracy is 0.746875 and loss is 0.5311402320861817
At time: 5.882566452026367 accuracy is 0.7640625 and loss is 0.5092647075653076
At time: 6.072826862335205 accuracy is 0.790625 and loss is 0.49910292625427244
At time: 6.271863698959351 accuracy is 0.809375 and loss is 0.5223502159118653
At time: 6.485532522201538 accuracy is 0.771875 and loss is 0.5000417232513428
Evaluating...
Done Evaluating: Achieved accuracy of 0.7925145348837209
Achieved new best!
Completing Train Step at 2th epoch...
At time: 7.264636993408203 accuracy is 0.759375 and loss is 0.5440187931060791
At time: 7.416881322860718 accuracy is 0.6890625 and loss is 0.6101219177246093
At time: 7.575546503067017 accuracy is 0.7875 and loss is 0.4591668605804443
At time: 7.73790168762207 accuracy is 0.7203125 and loss is 0.5348876953125
At time: 7.9041454792022705 accuracy is 0.775 and loss is 0.4746695995330811
At time: 8.073486566543579 accuracy is 0.8109375 and loss is 0.4208359718322754
At time: 8.248634815216064 accuracy is 0.7921875 and loss is 0.47433180809020997
At time: 8.432034015655518 accuracy is 0.8140625 and loss is 0.41466326713562013
At time: 8.617434978485107 accuracy is 0.825 and loss is 0.38652377128601073
At time: 8.807635068893433 accuracy is 0.79375 and loss is 0.4754988193511963
At time: 9.005624771118164 accuracy is 0.8203125 and loss is 0.44681715965270996
At time: 9.2238929271698 accuracy is 0.771875 and loss is 0.4537803649902344
Evaluating...
Done Evaluating: Achieved accuracy of 0.7151162790697675
Not better for 1
Completing Train Step at 3th epoch...
At time: 10.00590443611145 accuracy is 0.740625 and loss is 0.5963088989257812
At time: 10.155622243881226 accuracy is 0.8015625 and loss is 0.4728090286254883
At time: 10.317442893981934 accuracy is 0.8359375 and loss is 0.4011728286743164
At time: 10.48336935043335 accuracy is 0.80625 and loss is 0.40010871887207033
At time: 10.652279615402222 accuracy is 0.8234375 and loss is 0.3737377166748047
At time: 10.82356071472168 accuracy is 0.8515625 and loss is 0.3459599733352661
At time: 11.001972913742065 accuracy is 0.815625 and loss is 0.4237203121185303
At time: 11.183761358261108 accuracy is 0.859375 and loss is 0.3333899974822998
At time: 11.369407892227173 accuracy is 0.86875 and loss is 0.3899101257324219
At time: 11.562999963760376 accuracy is 0.834375 and loss is 0.4205669403076172
At time: 11.776012659072876 accuracy is 0.8359375 and loss is 0.36142606735229493
At time: 11.985288381576538 accuracy is 0.809375 and loss is 0.3925790786743164
Evaluating...
Done Evaluating: Achieved accuracy of 0.7845203488372093
Not better for 2
Completing Train Step at 4th epoch...
At time: 12.763624668121338 accuracy is 0.803125 and loss is 0.4710865020751953
At time: 12.919145822525024 accuracy is 0.8328125 and loss is 0.44812836647033694
At time: 13.082903385162354 accuracy is 0.8796875 and loss is 0.2871454954147339
At time: 13.245356798171997 accuracy is 0.8453125 and loss is 0.36855173110961914
At time: 13.419402599334717 accuracy is 0.8578125 and loss is 0.3148250341415405
At time: 13.588989734649658 accuracy is 0.825 and loss is 0.3755075454711914
At time: 13.763997554779053 accuracy is 0.859375 and loss is 0.3362898349761963
At time: 13.94242000579834 accuracy is 0.875 and loss is 0.3009235382080078
At time: 14.12636137008667 accuracy is 0.8640625 and loss is 0.29322359561920164
At time: 14.314332485198975 accuracy is 0.8703125 and loss is 0.2894625186920166
At time: 14.512735605239868 accuracy is 0.884375 and loss is 0.3036184549331665
At time: 14.717754602432251 accuracy is 0.8515625 and loss is 0.3034571647644043
Evaluating...
Done Evaluating: Achieved accuracy of 0.768531976744186
Not better for 3
Completing Train Step at 5th epoch...
At time: 15.496619701385498 accuracy is 0.834375 and loss is 0.4179865837097168
At time: 15.650042533874512 accuracy is 0.8421875 and loss is 0.38108510971069337
At time: 15.806568622589111 accuracy is 0.9 and loss is 0.2609159708023071
At time: 15.969810009002686 accuracy is 0.846875 and loss is 0.3750643014907837
At time: 16.13651466369629 accuracy is 0.8796875 and loss is 0.2674288272857666
At time: 16.30750560760498 accuracy is 0.8875 and loss is 0.24507763385772705
At time: 16.4811110496521 accuracy is 0.9015625 and loss is 0.2275097131729126
At time: 16.658398389816284 accuracy is 0.8953125 and loss is 0.23409619331359863
At time: 16.841620683670044 accuracy is 0.8734375 and loss is 0.27206101417541506
At time: 17.031137943267822 accuracy is 0.884375 and loss is 0.2573673963546753
At time: 17.229971408843994 accuracy is 0.8671875 and loss is 0.2922311782836914
At time: 17.438409566879272 accuracy is 0.8890625 and loss is 0.29541099071502686
Evaluating...
Done Evaluating: Achieved accuracy of 0.7590843023255814
Not better for 4
Completing Train Step at 6th epoch...
At time: 18.24196720123291 accuracy is 0.8375 and loss is 0.3807282209396362
At time: 18.394176244735718 accuracy is 0.865625 and loss is 0.33517656326293943
At time: 18.554787635803223 accuracy is 0.896875 and loss is 0.2320300817489624
At time: 18.715397119522095 accuracy is 0.8828125 and loss is 0.3033382177352905
At time: 18.881214380264282 accuracy is 0.9 and loss is 0.2194392204284668
At time: 19.05583095550537 accuracy is 0.921875 and loss is 0.18762390613555907
At time: 19.233153104782104 accuracy is 0.9125 and loss is 0.18387019634246826
At time: 19.413732767105103 accuracy is 0.915625 and loss is 0.2829728603363037
At time: 19.59842276573181 accuracy is 0.9015625 and loss is 0.21712403297424315
At time: 19.793968200683594 accuracy is 0.9265625 and loss is 0.19923945665359497
At time: 19.993915796279907 accuracy is 0.9171875 and loss is 0.21072690486907958
At time: 20.203091859817505 accuracy is 0.928125 and loss is 0.20477805137634278
Evaluating...
Done Evaluating: Achieved accuracy of 0.7634447674418605
Not better for 5
Completing Train Step at 7th epoch...
At time: 20.97672939300537 accuracy is 0.890625 and loss is 0.2865075349807739
At time: 21.12963891029358 accuracy is 0.8796875 and loss is 0.31351666450500487
At time: 21.286568641662598 accuracy is 0.9375 and loss is 0.16357706785202025
At time: 21.450018167495728 accuracy is 0.9109375 and loss is 0.23293921947479249
At time: 21.61627435684204 accuracy is 0.9359375 and loss is 0.16128101348876953
At time: 21.789028644561768 accuracy is 0.90625 and loss is 0.2025538444519043
At time: 21.96587562561035 accuracy is 0.9109375 and loss is 0.1952011227607727
At time: 22.142465353012085 accuracy is 0.9421875 and loss is 0.14207444190979004
At time: 22.325799703598022 accuracy is 0.9015625 and loss is 0.2564697742462158
At time: 22.51541233062744 accuracy is 0.9234375 and loss is 0.16580904722213746
At time: 22.713887214660645 accuracy is 0.934375 and loss is 0.1845356345176697
At time: 22.927414894104004 accuracy is 0.9265625 and loss is 0.16051467657089233
Evaluating...
Done Evaluating: Achieved accuracy of 0.7750726744186046
Not better for 6
Completing Train Step at 8th epoch...
At time: 23.73931074142456 accuracy is 0.9125 and loss is 0.23215930461883544
At time: 23.89039945602417 accuracy is 0.9046875 and loss is 0.24370186328887938
At time: 24.048429012298584 accuracy is 0.953125 and loss is 0.15086499452590943
At time: 24.21122407913208 accuracy is 0.9203125 and loss is 0.18146227598190307
At time: 24.37495994567871 accuracy is 0.9390625 and loss is 0.16765184402465821
At time: 24.54798436164856 accuracy is 0.8921875 and loss is 0.27523250579833985
At time: 24.72375226020813 accuracy is 0.9296875 and loss is 0.16197612285614013
At time: 24.905210256576538 accuracy is 0.9234375 and loss is 0.2267918348312378
At time: 25.093719244003296 accuracy is 0.9359375 and loss is 0.1730370879173279
At time: 25.283446311950684 accuracy is 0.9546875 and loss is 0.12695428133010864
At time: 25.48356866836548 accuracy is 0.9359375 and loss is 0.1397705078125
At time: 25.694353580474854 accuracy is 0.9171875 and loss is 0.1810116648674011
Evaluating...
Done Evaluating: Achieved accuracy of 0.7859738372093024
Not better for 7
Completing Train Step at 9th epoch...
At time: 26.46423077583313 accuracy is 0.9296875 and loss is 1.446589469909668
At time: 26.614773988723755 accuracy is 0.9296875 and loss is 0.28311612606048586
At time: 26.774424076080322 accuracy is 0.95 and loss is 0.1325647234916687
At time: 26.94006657600403 accuracy is 0.94375 and loss is 0.16255414485931396
At time: 27.10469651222229 accuracy is 0.95625 and loss is 0.11593337059020996
At time: 27.27648901939392 accuracy is 0.925 and loss is 0.22104480266571044
At time: 27.45196294784546 accuracy is 0.953125 and loss is 0.12040210962295532
At time: 27.632002592086792 accuracy is 0.9515625 and loss is 0.12181494235992432
At time: 27.818002223968506 accuracy is 0.9546875 and loss is 0.12178030014038085
At time: 28.00862979888916 accuracy is 0.953125 and loss is 0.11423043012619019
At time: 28.206353187561035 accuracy is 0.9640625 and loss is 0.08778007626533509
At time: 28.412999153137207 accuracy is 0.9484375 and loss is 0.13562461137771606
Evaluating...
Done Evaluating: Achieved accuracy of 0.7837936046511628
Not better for 8
Completing Train Step at 10th epoch...
At time: 29.18510413169861 accuracy is 0.9125 and loss is 0.2546377182006836
At time: 29.33657217025757 accuracy is 0.9484375 and loss is 0.14927576780319213
At time: 29.499833822250366 accuracy is 0.975 and loss is 0.0798495054244995
At time: 29.66287326812744 accuracy is 0.925 and loss is 0.19999951124191284
At time: 29.82576012611389 accuracy is 0.9515625 and loss is 0.16046081781387328
At time: 29.997803211212158 accuracy is 0.9546875 and loss is 0.14857068061828613
At time: 30.173831701278687 accuracy is 0.959375 and loss is 0.13238677978515626
At time: 30.352539539337158 accuracy is 0.9625 and loss is 0.1232364296913147
At time: 30.536972284317017 accuracy is 0.9578125 and loss is 0.10916727781295776
At time: 30.733644247055054 accuracy is 0.93125 and loss is 0.16498647928237914
At time: 30.934624910354614 accuracy is 0.953125 and loss is 0.115925133228302
At time: 31.145009756088257 accuracy is 0.94375 and loss is 0.1413038969039917
Evaluating...
Done Evaluating: Achieved accuracy of 0.7848837209302325
Not better for 9
Completing Train Step at 11th epoch...
At time: 31.91498613357544 accuracy is 0.9203125 and loss is 0.2088552713394165
At time: 32.067445039749146 accuracy is 0.959375 and loss is 0.12341154813766479
At time: 32.22941064834595 accuracy is 0.95625 and loss is 0.1240986704826355
At time: 32.39361047744751 accuracy is 0.95 and loss is 0.14790525436401367
At time: 32.561121702194214 accuracy is 0.934375 and loss is 0.15381782054901122
At time: 32.73333477973938 accuracy is 0.9640625 and loss is 0.09486464262008668
At time: 32.90452861785889 accuracy is 0.959375 and loss is 0.11298788785934448
At time: 33.08596754074097 accuracy is 0.9609375 and loss is 0.1042333722114563
At time: 33.27202296257019 accuracy is 0.946875 and loss is 0.1664325475692749
At time: 33.46357345581055 accuracy is 0.975 and loss is 0.099521803855896
At time: 33.66407918930054 accuracy is 0.8828125 and loss is 0.30224945545196535
At time: 33.87629675865173 accuracy is 0.9484375 and loss is 0.14074033498764038
Evaluating...
Done Evaluating: Achieved accuracy of 0.7834302325581395
Not better for 10
Model not improving. Stopping earlyat 0.7925145348837209 epochs.
Done Training. Achieved Best Accuracy of 0.7925145348837209
Improved accuracyfrom -10000000 to 0.7925145348837209
keyvalattn
SETTINGS FOR THIS RUN
{'tune_wordvecs': False, 'tune_attn': False, 'l2': 0.8229856890014869, 'attn_type': 'similarity', 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.4071526000314305, 'wordvec_dim': 300, 'dropout': 0.7908405900471712, 'wordvec_source': 'glove', 'data': 'MPQA', 'lr': 0.0008369691177334823}
Using CUDA!
here
similarity
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['GloVe']
Getting GloVe Vectors with 300 dims
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fb0c79cfd68>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
similarity
Using Attention model with following args:
{'train_word_vecs': False, 'hidden_size': 300, 'attn_type': 'similarity', 'cuda': True, 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.4071526000314305, 'num_classes': 2, 'input_size': 300, 'dropout': 0.7908405900471712, 'tune_attn': False, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
-0.4786 -0.1089 -0.0076  ...   0.7458  0.7174  0.6185
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
-0.0479  0.9828  0.9182  ...   0.0424  0.4554 -0.3210
[torch.FloatTensor of size 15284x300]
, 'attention_dim': 350, 'vocab_size': 15284}
Not Tuning Word Vectors!
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.16860651969909668 accuracy is 0.55 and loss is 0.7737082481384278
At time: 0.32714056968688965 accuracy is 0.575 and loss is 0.6977222442626954
At time: 0.49393320083618164 accuracy is 0.7390625 and loss is 0.567619514465332
At time: 0.6642603874206543 accuracy is 0.709375 and loss is 0.6980034828186035
At time: 0.8442521095275879 accuracy is 0.7421875 and loss is 0.557518720626831
At time: 1.028259515762329 accuracy is 0.734375 and loss is 0.5754836559295654
At time: 1.2152221202850342 accuracy is 0.725 and loss is 0.5809123039245605
At time: 1.4090826511383057 accuracy is 0.7796875 and loss is 0.5740263938903809
At time: 1.6122076511383057 accuracy is 0.759375 and loss is 0.6211063861846924
At time: 1.8211054801940918 accuracy is 0.78125 and loss is 0.5224472045898437
At time: 2.037949562072754 accuracy is 0.7578125 and loss is 0.5367533683776855
At time: 2.2662062644958496 accuracy is 0.759375 and loss is 0.5013669967651367
Evaluating...
Done Evaluating: Achieved accuracy of 0.7710755813953488
Achieved new best!
Completing Train Step at 1th epoch...
At time: 3.0686097145080566 accuracy is 0.6828125 and loss is 0.661961030960083
At time: 3.2242822647094727 accuracy is 0.7140625 and loss is 0.6354096889495849
At time: 3.381680727005005 accuracy is 0.78125 and loss is 0.4777155876159668
At time: 3.5438852310180664 accuracy is 0.7625 and loss is 0.5033211231231689
At time: 3.7093234062194824 accuracy is 0.76875 and loss is 0.5031617164611817
At time: 3.880483865737915 accuracy is 0.7890625 and loss is 0.4969184398651123
At time: 4.056897163391113 accuracy is 0.7546875 and loss is 0.5399805068969726
At time: 4.23951268196106 accuracy is 0.8 and loss is 0.46864876747131345
At time: 4.4250311851501465 accuracy is 0.790625 and loss is 0.4699560165405273
At time: 4.614895343780518 accuracy is 0.7984375 and loss is 0.44668850898742674
At time: 4.813259601593018 accuracy is 0.80625 and loss is 0.443299388885498
At time: 5.022494792938232 accuracy is 0.7828125 and loss is 0.4344996452331543
Evaluating...
Done Evaluating: Achieved accuracy of 0.7361918604651163
Not better for 1
Completing Train Step at 2th epoch...
At time: 5.8349449634552 accuracy is 0.734375 and loss is 0.5799487590789795
At time: 5.992271900177002 accuracy is 0.7671875 and loss is 0.5947361946105957
At time: 6.1630859375 accuracy is 0.8109375 and loss is 0.4226621150970459
At time: 6.32548713684082 accuracy is 0.79375 and loss is 0.450899600982666
At time: 6.491888761520386 accuracy is 0.7984375 and loss is 0.48312768936157224
At time: 6.6624884605407715 accuracy is 0.7921875 and loss is 0.45490427017211915
At time: 6.841593503952026 accuracy is 0.7484375 and loss is 0.48172826766967775
At time: 7.022890329360962 accuracy is 0.81875 and loss is 0.45061373710632324
At time: 7.208257436752319 accuracy is 0.796875 and loss is 0.4541322708129883
At time: 7.398708820343018 accuracy is 0.7734375 and loss is 0.4762871742248535
At time: 7.59966254234314 accuracy is 0.828125 and loss is 0.387824559211731
At time: 7.808220148086548 accuracy is 0.79375 and loss is 0.4521960258483887
Evaluating...
Done Evaluating: Achieved accuracy of 0.8059593023255814
Achieved new best!
Completing Train Step at 3th epoch...
At time: 8.588971376419067 accuracy is 0.796875 and loss is 0.51057448387146
At time: 8.738091945648193 accuracy is 0.775 and loss is 0.5155941009521484
At time: 8.90107536315918 accuracy is 0.8078125 and loss is 0.3802156448364258
At time: 9.065446853637695 accuracy is 0.7953125 and loss is 0.45871477127075194
At time: 9.233396053314209 accuracy is 0.815625 and loss is 0.38317222595214845
At time: 9.40644884109497 accuracy is 0.8171875 and loss is 0.4258134365081787
At time: 9.58161735534668 accuracy is 0.8015625 and loss is 0.41152567863464357
At time: 9.761298656463623 accuracy is 0.8421875 and loss is 0.3584003925323486
At time: 9.946772813796997 accuracy is 0.828125 and loss is 0.4212021350860596
At time: 10.132563352584839 accuracy is 0.8203125 and loss is 0.3916446685791016
At time: 10.33253264427185 accuracy is 0.8234375 and loss is 0.3523146390914917
At time: 10.538567543029785 accuracy is 0.81875 and loss is 0.39630258083343506
Evaluating...
Done Evaluating: Achieved accuracy of 0.8077761627906976
Achieved new best!
Completing Train Step at 4th epoch...
At time: 11.309216737747192 accuracy is 0.8125 and loss is 0.492183780670166
At time: 11.459172487258911 accuracy is 0.8359375 and loss is 0.35132532119750975
At time: 11.61806035041809 accuracy is 0.8484375 and loss is 0.3496131658554077
At time: 11.77836799621582 accuracy is 0.8234375 and loss is 0.4182403087615967
At time: 11.941766738891602 accuracy is 0.859375 and loss is 0.29602584838867185
At time: 12.115099906921387 accuracy is 0.8484375 and loss is 0.37719810009002686
At time: 12.290865182876587 accuracy is 0.8390625 and loss is 0.3659858703613281
At time: 12.469055891036987 accuracy is 0.8671875 and loss is 0.3094256639480591
At time: 12.652719497680664 accuracy is 0.85625 and loss is 0.3567332744598389
At time: 12.843591928482056 accuracy is 0.8484375 and loss is 0.34421534538269044
At time: 13.040654182434082 accuracy is 0.871875 and loss is 0.3013126850128174
At time: 13.248167514801025 accuracy is 0.8421875 and loss is 0.36626036167144777
Evaluating...
Done Evaluating: Achieved accuracy of 0.782703488372093
Not better for 1
Completing Train Step at 5th epoch...
At time: 14.023767709732056 accuracy is 0.815625 and loss is 0.4394881248474121
At time: 14.175391435623169 accuracy is 0.85625 and loss is 0.3239163637161255
At time: 14.335873365402222 accuracy is 0.8875 and loss is 0.3110488414764404
At time: 14.501270294189453 accuracy is 0.8265625 and loss is 0.3776254653930664
At time: 14.670064449310303 accuracy is 0.8953125 and loss is 0.2332047700881958
At time: 14.842186689376831 accuracy is 0.890625 and loss is 0.27706303596496584
At time: 15.023918151855469 accuracy is 0.8796875 and loss is 0.2972684144973755
At time: 15.203562021255493 accuracy is 0.8734375 and loss is 0.29373974800109864
At time: 15.389872550964355 accuracy is 0.8671875 and loss is 0.28799917697906496
At time: 15.578710317611694 accuracy is 0.86875 and loss is 0.2818223237991333
At time: 15.77637267112732 accuracy is 0.9015625 and loss is 0.23130691051483154
At time: 15.984090089797974 accuracy is 0.8578125 and loss is 0.35472681522369387
Evaluating...
Done Evaluating: Achieved accuracy of 0.7867005813953488
Not better for 2
Completing Train Step at 6th epoch...
At time: 16.755645036697388 accuracy is 0.8140625 and loss is 0.4370106220245361
At time: 16.90901756286621 accuracy is 0.8671875 and loss is 0.2834620475769043
At time: 17.067657232284546 accuracy is 0.91875 and loss is 0.24957578182220458
At time: 17.231245756149292 accuracy is 0.8671875 and loss is 0.3537569522857666
At time: 17.401078701019287 accuracy is 0.8890625 and loss is 0.24149658679962158
At time: 17.572611093521118 accuracy is 0.890625 and loss is 0.23858280181884767
At time: 17.75037431716919 accuracy is 0.890625 and loss is 0.21752407550811767
At time: 17.931009531021118 accuracy is 0.88125 and loss is 0.24306123256683348
At time: 18.117471933364868 accuracy is 0.903125 and loss is 0.24170777797698975
At time: 18.310425996780396 accuracy is 0.896875 and loss is 0.21815986633300782
At time: 18.508491039276123 accuracy is 0.9140625 and loss is 0.1721300959587097
At time: 18.716825246810913 accuracy is 0.9 and loss is 0.23815770149230958
Evaluating...
Done Evaluating: Achieved accuracy of 0.7776162790697675
Not better for 3
Completing Train Step at 7th epoch...
At time: 19.49355936050415 accuracy is 0.8234375 and loss is 0.38208208084106443
At time: 19.6489896774292 accuracy is 0.909375 and loss is 0.25243353843688965
At time: 19.814082860946655 accuracy is 0.9390625 and loss is 0.2016975164413452
At time: 19.977038383483887 accuracy is 0.9203125 and loss is 0.21610498428344727
At time: 20.1462619304657 accuracy is 0.8921875 and loss is 0.20440537929534913
At time: 20.31803059577942 accuracy is 0.928125 and loss is 0.16537847518920898
At time: 20.495032787322998 accuracy is 0.9265625 and loss is 0.16836245059967042
At time: 20.67921757698059 accuracy is 0.921875 and loss is 0.19264068603515624
At time: 20.87037181854248 accuracy is 0.9140625 and loss is 0.23208773136138916
At time: 21.064799308776855 accuracy is 0.921875 and loss is 0.1814168930053711
At time: 21.26451826095581 accuracy is 0.9421875 and loss is 0.14298180341720582
At time: 21.47223472595215 accuracy is 0.9109375 and loss is 0.1902848958969116
Evaluating...
Done Evaluating: Achieved accuracy of 0.7739825581395349
Not better for 4
Completing Train Step at 8th epoch...
At time: 22.244356393814087 accuracy is 0.8765625 and loss is 0.3051341772079468
At time: 22.39761471748352 accuracy is 0.9234375 and loss is 0.17825744152069092
At time: 22.55355453491211 accuracy is 0.9625 and loss is 0.11002893447875976
At time: 22.714448928833008 accuracy is 0.928125 and loss is 0.1813839077949524
At time: 22.880910396575928 accuracy is 0.9484375 and loss is 0.14626168012619017
At time: 23.051121950149536 accuracy is 0.9546875 and loss is 0.10760481357574463
At time: 23.226553678512573 accuracy is 0.959375 and loss is 0.12450572252273559
At time: 23.408612728118896 accuracy is 0.959375 and loss is 0.10493139028549195
At time: 23.59595274925232 accuracy is 0.915625 and loss is 0.22389626502990723
At time: 23.788063526153564 accuracy is 0.91875 and loss is 0.18155795335769653
At time: 23.99269676208496 accuracy is 0.9453125 and loss is 0.10798075199127197
At time: 24.20687770843506 accuracy is 0.9109375 and loss is 0.21190025806427001
Evaluating...
Done Evaluating: Achieved accuracy of 0.7830668604651163
Not better for 5
Completing Train Step at 9th epoch...
At time: 24.980572938919067 accuracy is 0.8921875 and loss is 0.266423773765564
At time: 25.132572650909424 accuracy is 0.9609375 and loss is 0.1117664098739624
At time: 25.292952299118042 accuracy is 0.9625 and loss is 0.20709497928619386
At time: 25.456321477890015 accuracy is 0.95 and loss is 0.1668087959289551
At time: 25.6241192817688 accuracy is 0.9578125 and loss is 0.11805562973022461
At time: 25.79507541656494 accuracy is 0.93125 and loss is 0.23015522956848145
At time: 25.972084522247314 accuracy is 0.959375 and loss is 0.09615002870559693
At time: 26.15532636642456 accuracy is 0.95625 and loss is 0.1459744691848755
At time: 26.348580598831177 accuracy is 0.9578125 and loss is 0.13481593132019043
At time: 26.54098916053772 accuracy is 0.95625 and loss is 0.1296854257583618
At time: 26.741979360580444 accuracy is 0.9625 and loss is 0.09403017163276672
At time: 26.951086282730103 accuracy is 0.946875 and loss is 0.13345811367034913
Evaluating...
Done Evaluating: Achieved accuracy of 0.7605377906976745
Not better for 6
Completing Train Step at 10th epoch...
At time: 27.724382162094116 accuracy is 0.91875 and loss is 0.24178004264831543
At time: 27.879495859146118 accuracy is 0.9765625 and loss is 0.1080586314201355
At time: 28.038662433624268 accuracy is 0.946875 and loss is 0.1384119749069214
At time: 28.200080394744873 accuracy is 0.959375 and loss is 0.09282623529434204
At time: 28.365418434143066 accuracy is 0.9578125 and loss is 0.14274821281433106
At time: 28.535130739212036 accuracy is 0.9734375 and loss is 0.06953913569450379
At time: 28.710899591445923 accuracy is 0.96875 and loss is 0.09708678126335143
At time: 28.889236211776733 accuracy is 0.95625 and loss is 0.1223923921585083
At time: 29.080551385879517 accuracy is 0.9390625 and loss is 0.18760663270950317
At time: 29.281702995300293 accuracy is 0.953125 and loss is 0.11602749824523925
At time: 29.491186380386353 accuracy is 0.9734375 and loss is 0.06633143424987793
At time: 29.70612096786499 accuracy is 0.9515625 and loss is 0.15087242126464845
Evaluating...
Done Evaluating: Achieved accuracy of 0.7449127906976745
Not better for 7
Completing Train Step at 11th epoch...
At time: 30.49265432357788 accuracy is 0.940625 and loss is 0.14204854965209962
At time: 30.64560627937317 accuracy is 0.965625 and loss is 0.12020542621612548
At time: 30.80550265312195 accuracy is 0.94375 and loss is 0.1469881296157837
At time: 30.971633195877075 accuracy is 0.9625 and loss is 0.10814253091812134
At time: 31.13848900794983 accuracy is 0.975 and loss is 0.07038812637329102
At time: 31.31046772003174 accuracy is 0.9703125 and loss is 0.0765885591506958
At time: 31.489609718322754 accuracy is 0.975 and loss is 0.07375492453575135
At time: 31.670499563217163 accuracy is 0.98125 and loss is 0.08079702854156494
At time: 31.859442710876465 accuracy is 0.9765625 and loss is 0.05682300925254822
At time: 32.05335330963135 accuracy is 0.9671875 and loss is 0.0744127631187439
At time: 32.2603645324707 accuracy is 0.9890625 and loss is 0.028910118341445922
At time: 32.47566080093384 accuracy is 0.953125 and loss is 0.1381697416305542
Evaluating...
Done Evaluating: Achieved accuracy of 0.768531976744186
Not better for 8
Completing Train Step at 12th epoch...
At time: 33.24817204475403 accuracy is 0.965625 and loss is 0.09235353469848633
At time: 33.41319394111633 accuracy is 0.9875 and loss is 0.04372376799583435
At time: 33.577476263046265 accuracy is 0.9828125 and loss is 0.06910889148712158
At time: 33.712114095687866 accuracy is 0.96875 and loss is 0.1017185091972351
At time: 33.89734506607056 accuracy is 0.9796875 and loss is 0.09162653684616089
At time: 34.07304549217224 accuracy is 0.978125 and loss is 0.0627511739730835
At time: 34.25323939323425 accuracy is 0.99375 and loss is 0.022125709056854247
At time: 34.432968616485596 accuracy is 0.959375 and loss is 0.2621472358703613
At time: 34.61712145805359 accuracy is 0.959375 and loss is 0.14477791786193847
At time: 34.80738377571106 accuracy is 0.9703125 and loss is 0.10927125215530395
At time: 35.00982046127319 accuracy is 0.971875 and loss is 0.06644063591957092
At time: 35.22208762168884 accuracy is 0.9640625 and loss is 0.10784417390823364
Evaluating...
Done Evaluating: Achieved accuracy of 0.7867005813953488
Not better for 9
Completing Train Step at 13th epoch...
At time: 35.996055126190186 accuracy is 0.9703125 and loss is 0.07612905502319336
At time: 36.14916467666626 accuracy is 0.9546875 and loss is 0.1404667854309082
At time: 36.306729555130005 accuracy is 0.953125 and loss is 0.1877331018447876
At time: 36.46989440917969 accuracy is 0.9546875 and loss is 0.12807465791702272
At time: 36.63512110710144 accuracy is 0.971875 and loss is 0.14801278114318847
At time: 36.80543327331543 accuracy is 0.946875 and loss is 0.19584672451019286
At time: 36.982414960861206 accuracy is 0.9609375 and loss is 0.12205530405044555
At time: 37.16020369529724 accuracy is 0.95625 and loss is 0.12360178232192993
At time: 37.34728503227234 accuracy is 0.9421875 and loss is 0.16178669929504394
At time: 37.53727841377258 accuracy is 0.9765625 and loss is 0.06427010297775268
At time: 37.73678493499756 accuracy is 0.96875 and loss is 0.08024319410324096
At time: 37.94361472129822 accuracy is 0.978125 and loss is 0.061292093992233274
Evaluating...
Done Evaluating: Achieved accuracy of 0.7801598837209303
Not better for 10
Model not improving. Stopping earlyat 0.8077761627906976 epochs.
Done Training. Achieved Best Accuracy of 0.8077761627906976
Improved accuracyfrom 0.7925145348837209 to 0.8077761627906976
keyvalattn
SETTINGS FOR THIS RUN
{'tune_wordvecs': False, 'tune_attn': False, 'l2': 0.12991053423094034, 'attn_type': 'similarity', 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.7352481041038139, 'wordvec_dim': 300, 'dropout': 0.9671986213710806, 'wordvec_source': 'glove', 'data': 'MPQA', 'lr': 0.002106900900554126}
Using CUDA!
here
similarity
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['GloVe']
Getting GloVe Vectors with 300 dims
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fb0ca88c630>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
similarity
Using Attention model with following args:
{'train_word_vecs': False, 'hidden_size': 300, 'attn_type': 'similarity', 'cuda': True, 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.7352481041038139, 'num_classes': 2, 'input_size': 300, 'dropout': 0.9671986213710806, 'tune_attn': False, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
-0.4786 -0.1089 -0.0076  ...   0.7458  0.7174  0.6185
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
-0.0479  0.9828  0.9182  ...   0.0424  0.4554 -0.3210
[torch.FloatTensor of size 15284x300]
, 'attention_dim': 350, 'vocab_size': 15284}
Not Tuning Word Vectors!
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.16740846633911133 accuracy is 0.565625 and loss is 0.7451445102691651
At time: 0.32790350914001465 accuracy is 0.665625 and loss is 0.688049602508545
At time: 0.49522972106933594 accuracy is 0.6390625 and loss is 0.8502877235412598
At time: 0.665463924407959 accuracy is 0.6859375 and loss is 0.7751981258392334
At time: 0.839256763458252 accuracy is 0.709375 and loss is 0.5760600566864014
At time: 1.0232882499694824 accuracy is 0.7484375 and loss is 0.5574657440185546
At time: 1.2112536430358887 accuracy is 0.7328125 and loss is 0.5441721916198731
At time: 1.4004912376403809 accuracy is 0.784375 and loss is 0.5412631034851074
At time: 1.6002802848815918 accuracy is 0.7296875 and loss is 0.5680846214294434
At time: 1.8038489818572998 accuracy is 0.7390625 and loss is 0.5522982597351074
At time: 2.0203630924224854 accuracy is 0.725 and loss is 0.6025900840759277
At time: 2.246464490890503 accuracy is 0.7328125 and loss is 0.5361474990844727
Evaluating...
Done Evaluating: Achieved accuracy of 0.7754360465116279
Achieved new best!
Completing Train Step at 1th epoch...
At time: 3.052602767944336 accuracy is 0.653125 and loss is 0.6513576030731201
At time: 3.2027454376220703 accuracy is 0.7234375 and loss is 0.6309454441070557
At time: 3.360016107559204 accuracy is 0.7953125 and loss is 0.47153620719909667
At time: 3.5234487056732178 accuracy is 0.75 and loss is 0.5636613845825196
At time: 3.691488265991211 accuracy is 0.6578125 and loss is 0.6164572238922119
At time: 3.8643665313720703 accuracy is 0.7703125 and loss is 0.5373324394226074
At time: 4.0420966148376465 accuracy is 0.7484375 and loss is 0.580183744430542
At time: 4.222599506378174 accuracy is 0.7625 and loss is 0.5117889881134033
At time: 4.408643960952759 accuracy is 0.7703125 and loss is 0.5137533187866211
At time: 4.5985400676727295 accuracy is 0.7546875 and loss is 0.5828614711761475
At time: 4.818324565887451 accuracy is 0.778125 and loss is 0.4850155830383301
At time: 5.03194260597229 accuracy is 0.784375 and loss is 0.5489653587341309
Evaluating...
Done Evaluating: Achieved accuracy of 0.731468023255814
Not better for 1
Completing Train Step at 2th epoch...
At time: 5.806990385055542 accuracy is 0.5765625 and loss is 0.7180328369140625
At time: 5.9572436809539795 accuracy is 0.7328125 and loss is 0.567731237411499
At time: 6.115942716598511 accuracy is 0.796875 and loss is 0.4261303901672363
At time: 6.278919458389282 accuracy is 0.7734375 and loss is 0.5139250755310059
At time: 6.444974422454834 accuracy is 0.7765625 and loss is 0.4634274959564209
At time: 6.617940664291382 accuracy is 0.8 and loss is 0.4321526050567627
At time: 6.797229528427124 accuracy is 0.8 and loss is 0.4575382709503174
At time: 6.979788303375244 accuracy is 0.803125 and loss is 0.4551504611968994
At time: 7.163820743560791 accuracy is 0.8015625 and loss is 0.43201518058776855
At time: 7.353589773178101 accuracy is 0.79375 and loss is 0.4280234336853027
At time: 7.550809860229492 accuracy is 0.815625 and loss is 0.3690869092941284
At time: 7.760167121887207 accuracy is 0.8078125 and loss is 0.41202664375305176
Evaluating...
Done Evaluating: Achieved accuracy of 0.7616279069767442
Not better for 2
Completing Train Step at 3th epoch...
At time: 8.54134464263916 accuracy is 0.784375 and loss is 0.5549558639526367
At time: 8.692831993103027 accuracy is 0.7796875 and loss is 0.44043645858764646
At time: 8.852226257324219 accuracy is 0.8453125 and loss is 0.36071486473083497
At time: 9.015069007873535 accuracy is 0.7890625 and loss is 0.4557168960571289
At time: 9.18923544883728 accuracy is 0.7703125 and loss is 0.42944927215576173
At time: 9.369989156723022 accuracy is 0.8390625 and loss is 0.3776727199554443
At time: 9.546784162521362 accuracy is 0.8 and loss is 0.40309953689575195
At time: 9.72450566291809 accuracy is 0.8390625 and loss is 0.4109194278717041
At time: 9.917993307113647 accuracy is 0.8171875 and loss is 0.411761474609375
At time: 10.108729124069214 accuracy is 0.8390625 and loss is 0.3765681982040405
At time: 10.308796405792236 accuracy is 0.846875 and loss is 0.35553607940673826
At time: 10.519583225250244 accuracy is 0.846875 and loss is 0.3287786960601807
Evaluating...
Done Evaluating: Achieved accuracy of 0.798328488372093
Achieved new best!
Completing Train Step at 4th epoch...
At time: 11.2959885597229 accuracy is 0.7390625 and loss is 0.6169915199279785
At time: 11.450215578079224 accuracy is 0.8203125 and loss is 0.42116756439208985
At time: 11.606829166412354 accuracy is 0.86875 and loss is 0.3068848609924316
At time: 11.769611835479736 accuracy is 0.8484375 and loss is 0.3091987371444702
At time: 11.936747074127197 accuracy is 0.821875 and loss is 0.35568509101867674
At time: 12.108975648880005 accuracy is 0.828125 and loss is 0.36581711769104003
At time: 12.28264856338501 accuracy is 0.834375 and loss is 0.3348874092102051
At time: 12.463389873504639 accuracy is 0.86875 and loss is 0.2984946250915527
At time: 12.650263547897339 accuracy is 0.871875 and loss is 0.33518688678741454
At time: 12.840808868408203 accuracy is 0.821875 and loss is 0.368144154548645
At time: 13.040575504302979 accuracy is 0.8765625 and loss is 0.291876220703125
At time: 13.24711799621582 accuracy is 0.8625 and loss is 0.27643957138061526
Evaluating...
Done Evaluating: Achieved accuracy of 0.7837936046511628
Not better for 1
Completing Train Step at 5th epoch...
At time: 14.062314987182617 accuracy is 0.8015625 and loss is 0.4604171276092529
At time: 14.21630334854126 accuracy is 0.8390625 and loss is 15.252328491210937
At time: 14.375416278839111 accuracy is 0.8578125 and loss is 2.0808202743530275
At time: 14.539858102798462 accuracy is 0.8671875 and loss is 0.33446812629699707
At time: 14.70820164680481 accuracy is 0.8171875 and loss is 0.3731168985366821
At time: 14.880951166152954 accuracy is 0.8453125 and loss is 0.33957481384277344
At time: 15.059859991073608 accuracy is 0.86875 and loss is 0.28054184913635255
At time: 15.242087841033936 accuracy is 0.8671875 and loss is 0.31591408252716063
At time: 15.431503534317017 accuracy is 0.8546875 and loss is 0.3536070823669434
At time: 15.622917652130127 accuracy is 0.8546875 and loss is 0.32800979614257814
At time: 15.823461055755615 accuracy is 0.9046875 and loss is 0.24333529472351073
At time: 16.034717321395874 accuracy is 0.871875 and loss is 0.2654526948928833
Evaluating...
Done Evaluating: Achieved accuracy of 0.7583575581395349
Not better for 2
Completing Train Step at 6th epoch...
At time: 16.811230421066284 accuracy is 0.840625 and loss is 0.6142913818359375
At time: 16.96222472190857 accuracy is 0.8609375 and loss is 0.36451895236968995
At time: 17.118832111358643 accuracy is 0.9140625 and loss is 0.17321885824203492
At time: 17.281514644622803 accuracy is 0.8765625 and loss is 0.2736996650695801
At time: 17.44875454902649 accuracy is 0.8796875 and loss is 0.2534590244293213
At time: 17.621623992919922 accuracy is 0.853125 and loss is 0.3068821668624878
At time: 17.79758882522583 accuracy is 0.8859375 and loss is 0.26301815509796145
At time: 17.97672462463379 accuracy is 0.8875 and loss is 0.25943305492401125
At time: 18.161924123764038 accuracy is 0.8828125 and loss is 0.2547149181365967
At time: 18.35379648208618 accuracy is 0.890625 and loss is 0.2759997844696045
At time: 18.552997827529907 accuracy is 0.90625 and loss is 0.20422675609588622
At time: 18.762218236923218 accuracy is 0.8875 and loss is 0.25065720081329346
Evaluating...
Done Evaluating: Achieved accuracy of 0.767078488372093
Not better for 3
Completing Train Step at 7th epoch...
At time: 19.53606414794922 accuracy is 0.8515625 and loss is 0.37041990756988524
At time: 19.69391369819641 accuracy is 0.9 and loss is 0.2628944873809814
At time: 19.853164672851562 accuracy is 0.9546875 and loss is 0.13560138940811156
At time: 20.017314910888672 accuracy is 0.9265625 and loss is 0.179410982131958
At time: 20.18447518348694 accuracy is 0.8875 and loss is 0.25794503688812254
At time: 20.358813762664795 accuracy is 0.8921875 and loss is 0.22736222743988038
At time: 20.536761045455933 accuracy is 0.896875 and loss is 0.20335965156555175
At time: 20.717657566070557 accuracy is 0.9171875 and loss is 0.21955204010009766
At time: 20.90739631652832 accuracy is 0.90625 and loss is 0.185354483127594
At time: 21.097668886184692 accuracy is 0.9046875 and loss is 0.22867720127105712
At time: 21.296727180480957 accuracy is 0.9234375 and loss is 0.1835784673690796
At time: 21.507905960083008 accuracy is 0.9 and loss is 0.27160708904266356
Evaluating...
Done Evaluating: Achieved accuracy of 0.7823401162790697
Not better for 4
Completing Train Step at 8th epoch...
At time: 22.281514883041382 accuracy is 0.871875 and loss is 0.3661172389984131
At time: 22.431981086730957 accuracy is 0.915625 and loss is 0.22640581130981446
At time: 22.591914653778076 accuracy is 0.9609375 and loss is 0.19074583053588867
At time: 22.755147218704224 accuracy is 0.9359375 and loss is 0.18170504570007323
At time: 22.92055916786194 accuracy is 0.915625 and loss is 0.20894126892089843
At time: 23.09434962272644 accuracy is 0.940625 and loss is 0.14202743768692017
At time: 23.27149271965027 accuracy is 0.90625 and loss is 0.21559462547302247
At time: 23.453741788864136 accuracy is 0.9359375 and loss is 0.1355893611907959
At time: 23.64483880996704 accuracy is 0.9015625 and loss is 0.24316782951354982
At time: 23.835860013961792 accuracy is 0.925 and loss is 0.17275030612945558
At time: 24.034735202789307 accuracy is 0.91875 and loss is 0.194618821144104
At time: 24.242022037506104 accuracy is 0.928125 and loss is 0.16594656705856323
Evaluating...
Done Evaluating: Achieved accuracy of 0.784156976744186
Not better for 5
Completing Train Step at 9th epoch...
At time: 25.053858280181885 accuracy is 0.9109375 and loss is 0.25550570487976076
At time: 25.206652641296387 accuracy is 0.9390625 and loss is 0.15955820083618164
At time: 25.366963863372803 accuracy is 0.9515625 and loss is 0.1645369291305542
At time: 25.530592918395996 accuracy is 0.9453125 and loss is 0.1732996702194214
At time: 25.698299407958984 accuracy is 0.90625 and loss is 0.2765753984451294
At time: 25.872153997421265 accuracy is 0.903125 and loss is 0.2335198402404785
At time: 26.04761791229248 accuracy is 0.90625 and loss is 0.23669171333312988
At time: 26.22884511947632 accuracy is 0.9296875 and loss is 0.17591687440872192
At time: 26.417359590530396 accuracy is 0.9328125 and loss is 0.1619402527809143
At time: 26.608347177505493 accuracy is 0.94375 and loss is 0.14687453508377074
At time: 26.80802345275879 accuracy is 0.94375 and loss is 0.12129693031311035
At time: 27.01651954650879 accuracy is 0.9421875 and loss is 0.13859251737594605
Evaluating...
Done Evaluating: Achieved accuracy of 0.7856104651162791
Not better for 6
Completing Train Step at 10th epoch...
At time: 27.827083587646484 accuracy is 0.9265625 and loss is 0.22341811656951904
At time: 27.979167222976685 accuracy is 0.9453125 and loss is 0.1365900754928589
At time: 28.137980937957764 accuracy is 0.95625 and loss is 0.1183122992515564
At time: 28.300275325775146 accuracy is 0.9546875 and loss is 0.1301034450531006
At time: 28.468165397644043 accuracy is 0.946875 and loss is 0.13265128135681153
At time: 28.642510414123535 accuracy is 0.9453125 and loss is 0.11011221408843994
At time: 28.817845106124878 accuracy is 0.959375 and loss is 0.10740044116973876
At time: 29.004387617111206 accuracy is 0.9546875 and loss is 0.09821848869323731
At time: 29.200145483016968 accuracy is 0.95625 and loss is 0.1255319595336914
At time: 29.392711877822876 accuracy is 0.953125 and loss is 0.13534173965454102
At time: 29.591073036193848 accuracy is 0.959375 and loss is 0.11538890600204468
At time: 29.801837921142578 accuracy is 0.9359375 and loss is 0.15310479402542115
Evaluating...
Done Evaluating: Achieved accuracy of 0.7801598837209303
Not better for 7
Completing Train Step at 11th epoch...
At time: 30.58287262916565 accuracy is 0.9015625 and loss is 0.3095586061477661
At time: 30.739699840545654 accuracy is 0.9375 and loss is 0.16162279844284058
At time: 30.899664640426636 accuracy is 0.95625 and loss is 0.09648138284683228
At time: 31.060325384140015 accuracy is 0.946875 and loss is 0.1881946325302124
At time: 31.227843046188354 accuracy is 0.9421875 and loss is 0.16800353527069092
At time: 31.401233196258545 accuracy is 0.95 and loss is 0.12660768032073974
At time: 31.57678484916687 accuracy is 0.9484375 and loss is 0.12121044397354126
At time: 31.758622884750366 accuracy is 0.9671875 and loss is 0.08469182252883911
At time: 31.944990634918213 accuracy is 0.9484375 and loss is 0.16461385488510133
At time: 32.13800120353699 accuracy is 0.971875 and loss is 0.08432588577270508
At time: 32.33803653717041 accuracy is 0.9796875 and loss is 0.0684600293636322
At time: 32.551114082336426 accuracy is 0.940625 and loss is 0.13631826639175415
Evaluating...
Done Evaluating: Achieved accuracy of 0.7750726744186046
Not better for 8
Completing Train Step at 12th epoch...
At time: 33.32707166671753 accuracy is 0.909375 and loss is 0.27058584690093995
At time: 33.478739738464355 accuracy is 0.953125 and loss is 0.14389948844909667
At time: 33.63374042510986 accuracy is 0.959375 and loss is 0.10598528385162354
At time: 33.79477548599243 accuracy is 0.9546875 and loss is 0.09933044910430908
At time: 33.959447622299194 accuracy is 0.953125 and loss is 0.11452544927597046
At time: 34.13291645050049 accuracy is 0.953125 and loss is 0.1408923625946045
At time: 34.30940508842468 accuracy is 0.953125 and loss is 0.1207588791847229
At time: 34.48929572105408 accuracy is 0.959375 and loss is 0.09752882719039917
At time: 34.675031900405884 accuracy is 0.9734375 and loss is 0.08474408388137818
At time: 34.86648440361023 accuracy is 0.9796875 and loss is 0.05296759009361267
At time: 35.065412282943726 accuracy is 0.9625 and loss is 0.11483883857727051
At time: 35.27764844894409 accuracy is 0.9640625 and loss is 0.07914947271347046
Evaluating...
Done Evaluating: Achieved accuracy of 0.7772529069767442
Not better for 9
Completing Train Step at 13th epoch...
At time: 36.053635597229004 accuracy is 0.9359375 and loss is 0.17063981294631958
At time: 36.20447254180908 accuracy is 0.9734375 and loss is 0.07523444890975953
At time: 36.361873626708984 accuracy is 0.9578125 and loss is 0.11219314336776734
At time: 36.52589559555054 accuracy is 0.94375 and loss is 0.1374796748161316
At time: 36.6992301940918 accuracy is 0.9578125 and loss is 0.12304955720901489
At time: 36.871928691864014 accuracy is 0.9546875 and loss is 0.11975420713424682
At time: 37.06153917312622 accuracy is 0.953125 and loss is 0.15475063323974608
At time: 37.250285387039185 accuracy is 0.959375 and loss is 0.09963266849517823
At time: 37.45325303077698 accuracy is 0.971875 and loss is 0.07133491635322571
At time: 37.65654683113098 accuracy is 0.9359375 and loss is 0.16095117330551148
At time: 37.867926597595215 accuracy is 0.959375 and loss is 0.09580101370811463
At time: 38.096423864364624 accuracy is 0.9484375 and loss is 0.12204122543334961
Evaluating...
Done Evaluating: Achieved accuracy of 0.7616279069767442
Not better for 10
Model not improving. Stopping earlyat 0.798328488372093 epochs.
Done Training. Achieved Best Accuracy of 0.798328488372093
keyvalattn
SETTINGS FOR THIS RUN
{'tune_wordvecs': False, 'tune_attn': False, 'l2': 0.9921872247673922, 'attn_type': 'similarity', 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.6084692913981343, 'wordvec_dim': 300, 'dropout': 0.7171939578485692, 'wordvec_source': 'glove', 'data': 'MPQA', 'lr': 0.004679524359007832}
Using CUDA!
here
similarity
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['GloVe']
Getting GloVe Vectors with 300 dims
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fb0c7689e10>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
similarity
Using Attention model with following args:
{'train_word_vecs': False, 'hidden_size': 300, 'attn_type': 'similarity', 'cuda': True, 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.6084692913981343, 'num_classes': 2, 'input_size': 300, 'dropout': 0.7171939578485692, 'tune_attn': False, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
-0.4786 -0.1089 -0.0076  ...   0.7458  0.7174  0.6185
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
-0.0479  0.9828  0.9182  ...   0.0424  0.4554 -0.3210
[torch.FloatTensor of size 15284x300]
, 'attention_dim': 350, 'vocab_size': 15284}
Not Tuning Word Vectors!
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.180952787399292 accuracy is 0.5375 and loss is 0.8546449661254882
At time: 0.34107041358947754 accuracy is 0.5953125 and loss is 0.7583235740661621
At time: 0.5126354694366455 accuracy is 0.665625 and loss is 0.649663782119751
At time: 0.6950953006744385 accuracy is 0.6375 and loss is 0.6939953327178955
At time: 0.8740863800048828 accuracy is 0.6859375 and loss is 0.6902918815612793
At time: 1.0618839263916016 accuracy is 0.534375 and loss is 0.7395047664642334
At time: 1.2589201927185059 accuracy is 0.60625 and loss is 0.6864880561828614
At time: 1.4595997333526611 accuracy is 0.7171875 and loss is 0.9495564460754394
At time: 1.6633243560791016 accuracy is 0.7140625 and loss is 0.587754201889038
At time: 1.8704173564910889 accuracy is 0.7015625 and loss is 0.6135713577270507
At time: 2.0901401042938232 accuracy is 0.734375 and loss is 0.550636100769043
At time: 2.31953763961792 accuracy is 0.7515625 and loss is 0.5111844539642334
Evaluating...
Done Evaluating: Achieved accuracy of 0.7605377906976745
Achieved new best!
Completing Train Step at 1th epoch...
At time: 3.1658430099487305 accuracy is 0.6921875 and loss is 0.6529260635375976
At time: 3.3203463554382324 accuracy is 0.70625 and loss is 0.5605982303619385
At time: 3.4793307781219482 accuracy is 0.7796875 and loss is 0.4858527660369873
At time: 3.6439054012298584 accuracy is 0.7421875 and loss is 0.5307591915130615
At time: 3.8108832836151123 accuracy is 0.771875 and loss is 0.46207642555236816
At time: 3.9851584434509277 accuracy is 0.71875 and loss is 0.5349099636077881
At time: 4.1618499755859375 accuracy is 0.7640625 and loss is 0.47997441291809084
At time: 4.343745708465576 accuracy is 0.7671875 and loss is 0.5026546001434327
At time: 4.527993202209473 accuracy is 0.78125 and loss is 0.4827760696411133
At time: 4.726747751235962 accuracy is 0.7984375 and loss is 0.47160000801086427
At time: 4.9271392822265625 accuracy is 0.8046875 and loss is 0.4273535251617432
At time: 5.1462531089782715 accuracy is 0.775 and loss is 0.4550325393676758
Evaluating...
Done Evaluating: Achieved accuracy of 0.8026889534883721
Achieved new best!
Completing Train Step at 2th epoch...
At time: 5.94534707069397 accuracy is 0.753125 and loss is 0.5558545112609863
At time: 6.100654602050781 accuracy is 0.7765625 and loss is 0.47776117324829104
At time: 6.264653921127319 accuracy is 0.80625 and loss is 0.45660810470581054
At time: 6.433497905731201 accuracy is 0.7890625 and loss is 0.6049716949462891
At time: 6.605206251144409 accuracy is 0.83125 and loss is 0.3811109781265259
At time: 6.780592679977417 accuracy is 0.7921875 and loss is 0.4635786533355713
At time: 6.959733724594116 accuracy is 0.796875 and loss is 0.4616112232208252
At time: 7.1419289112091064 accuracy is 0.7984375 and loss is 0.44913554191589355
At time: 7.333172559738159 accuracy is 0.8125 and loss is 0.4046004772186279
At time: 7.530755996704102 accuracy is 0.8046875 and loss is 0.455629825592041
At time: 7.734866619110107 accuracy is 0.815625 and loss is 0.368488073348999
At time: 7.949439764022827 accuracy is 0.809375 and loss is 0.415440034866333
Evaluating...
Done Evaluating: Achieved accuracy of 0.7874273255813954
Not better for 1
Completing Train Step at 3th epoch...
At time: 8.779024600982666 accuracy is 0.7625 and loss is 0.56362886428833
At time: 8.934279203414917 accuracy is 0.7734375 and loss is 0.4770458221435547
At time: 9.096491575241089 accuracy is 0.8171875 and loss is 0.43249149322509767
At time: 9.262507438659668 accuracy is 0.79375 and loss is 0.46105070114135743
At time: 9.431312799453735 accuracy is 0.7875 and loss is 0.4172581672668457
At time: 9.603284358978271 accuracy is 0.8296875 and loss is 0.4090339183807373
At time: 9.779639482498169 accuracy is 0.8109375 and loss is 0.40947632789611815
At time: 9.96811556816101 accuracy is 0.840625 and loss is 0.37898836135864256
At time: 10.155327796936035 accuracy is 0.84375 and loss is 0.3484238386154175
At time: 10.34894061088562 accuracy is 0.8375 and loss is 0.37679979801177976
At time: 10.551286458969116 accuracy is 0.8640625 and loss is 0.3128315210342407
At time: 10.76672911643982 accuracy is 0.8515625 and loss is 0.3218533039093018
Evaluating...
Done Evaluating: Achieved accuracy of 0.7914244186046512
Not better for 2
Completing Train Step at 4th epoch...
At time: 11.547085046768188 accuracy is 0.78125 and loss is 0.5092953205108642
At time: 11.70189118385315 accuracy is 0.828125 and loss is 0.3821967840194702
At time: 11.869339227676392 accuracy is 0.859375 and loss is 0.3658881187438965
At time: 12.032655477523804 accuracy is 0.815625 and loss is 0.4274136066436768
At time: 12.19920802116394 accuracy is 0.84375 and loss is 0.35978193283081056
At time: 12.375860452651978 accuracy is 0.8359375 and loss is 0.3770033597946167
At time: 12.557667255401611 accuracy is 0.8359375 and loss is 0.3656893253326416
At time: 12.735620498657227 accuracy is 0.8390625 and loss is 0.38095293045043943
At time: 12.922313690185547 accuracy is 0.81875 and loss is 0.37981090545654295
At time: 13.111659049987793 accuracy is 0.8328125 and loss is 0.3994465351104736
At time: 13.316402673721313 accuracy is 0.8609375 and loss is 0.3122160196304321
At time: 13.532006025314331 accuracy is 0.846875 and loss is 0.37473177909851074
Evaluating...
Done Evaluating: Achieved accuracy of 0.7194767441860465
Not better for 3
Completing Train Step at 5th epoch...
At time: 14.322940111160278 accuracy is 0.7828125 and loss is 0.4861269474029541
At time: 14.482914209365845 accuracy is 0.825 and loss is 0.397525954246521
At time: 14.653715133666992 accuracy is 0.859375 and loss is 0.3155089855194092
At time: 14.838190078735352 accuracy is 0.8390625 and loss is 0.4578081130981445
At time: 15.026588916778564 accuracy is 0.8796875 and loss is 0.27105002403259276
At time: 15.216922521591187 accuracy is 0.8484375 and loss is 0.3282276153564453
At time: 15.40871000289917 accuracy is 0.853125 and loss is 0.3600707769393921
At time: 15.601183414459229 accuracy is 0.85625 and loss is 0.3229825973510742
At time: 15.811142683029175 accuracy is 0.846875 and loss is 0.3233055591583252
At time: 16.020426750183105 accuracy is 0.821875 and loss is 0.4343418121337891
At time: 16.246211290359497 accuracy is 0.884375 and loss is 0.3041673183441162
At time: 16.478529691696167 accuracy is 0.8390625 and loss is 0.34357850551605223
Evaluating...
Done Evaluating: Achieved accuracy of 0.737281976744186
Not better for 4
Completing Train Step at 6th epoch...
At time: 17.280946254730225 accuracy is 0.7765625 and loss is 0.4845437049865723
At time: 17.433008909225464 accuracy is 0.8578125 and loss is 0.3595543146133423
At time: 17.598236560821533 accuracy is 0.8734375 and loss is 0.45334224700927733
At time: 17.774383068084717 accuracy is 0.846875 and loss is 0.33369994163513184
At time: 17.945156574249268 accuracy is 0.8625 and loss is 0.2955799102783203
At time: 18.12023687362671 accuracy is 0.8546875 and loss is 0.33510842323303225
At time: 18.297216653823853 accuracy is 0.8734375 and loss is 0.31993756294250486
At time: 18.479430437088013 accuracy is 0.871875 and loss is 0.2895923852920532
At time: 18.670203685760498 accuracy is 0.8546875 and loss is 0.33540160655975343
At time: 18.87305235862732 accuracy is 0.821875 and loss is 0.3745398044586182
At time: 19.101572513580322 accuracy is 0.8375 and loss is 0.3359510898590088
At time: 19.340991973876953 accuracy is 0.8515625 and loss is 0.3412168025970459
Evaluating...
Done Evaluating: Achieved accuracy of 0.7768895348837209
Not better for 5
Completing Train Step at 7th epoch...
At time: 20.163630962371826 accuracy is 0.79375 and loss is 0.48076543807983396
At time: 20.320083379745483 accuracy is 0.85 and loss is 0.3517871379852295
At time: 20.479039430618286 accuracy is 0.85625 and loss is 0.348818302154541
At time: 20.642119646072388 accuracy is 0.85625 and loss is 0.3324069261550903
At time: 20.811107873916626 accuracy is 0.871875 and loss is 0.2960406064987183
At time: 20.985788345336914 accuracy is 0.8390625 and loss is 0.35839176177978516
At time: 21.161375284194946 accuracy is 0.871875 and loss is 0.30993309020996096
At time: 21.345253467559814 accuracy is 0.884375 and loss is 0.2610296726226807
At time: 21.544162034988403 accuracy is 0.871875 and loss is 0.30585196018218996
At time: 21.74022674560547 accuracy is 0.8328125 and loss is 0.37856807708740237
At time: 21.944005727767944 accuracy is 0.8546875 and loss is 0.31301083564758303
At time: 22.15231704711914 accuracy is 0.8453125 and loss is 0.3374600887298584
Evaluating...
Done Evaluating: Achieved accuracy of 0.7852470930232558
Not better for 6
Completing Train Step at 8th epoch...
At time: 22.942495584487915 accuracy is 0.7921875 and loss is 0.4651347637176514
At time: 23.096012115478516 accuracy is 0.86875 and loss is 0.3453131914138794
At time: 23.25466299057007 accuracy is 0.8703125 and loss is 0.30123879909515383
At time: 23.421037197113037 accuracy is 0.84375 and loss is 0.3790157318115234
At time: 23.590842962265015 accuracy is 0.8734375 and loss is 0.3051579236984253
At time: 23.76260542869568 accuracy is 0.8796875 and loss is 0.28574814796447756
At time: 23.940953493118286 accuracy is 0.896875 and loss is 0.2292417049407959
At time: 24.123067378997803 accuracy is 0.8828125 and loss is 0.3023721694946289
At time: 24.31244444847107 accuracy is 0.8875 and loss is 0.2776123762130737
At time: 24.50437045097351 accuracy is 0.8734375 and loss is 0.3115731477737427
At time: 24.708796739578247 accuracy is 0.8859375 and loss is 0.25074448585510256
At time: 24.9215829372406 accuracy is 0.8625 and loss is 0.4060945510864258
Evaluating...
Done Evaluating: Achieved accuracy of 0.734375
Not better for 7
Completing Train Step at 9th epoch...
At time: 25.71926975250244 accuracy is 0.8046875 and loss is 0.4471170902252197
At time: 25.87332272529602 accuracy is 0.853125 and loss is 0.34280316829681395
At time: 26.03121566772461 accuracy is 0.9078125 and loss is 0.24328455924987794
At time: 26.192506074905396 accuracy is 0.8734375 and loss is 0.29302124977111815
At time: 26.357366800308228 accuracy is 0.9015625 and loss is 0.2349029541015625
At time: 26.533666133880615 accuracy is 0.90625 and loss is 0.214172625541687
At time: 26.712273359298706 accuracy is 0.8734375 and loss is 0.3112917184829712
At time: 26.898939847946167 accuracy is 0.8921875 and loss is 0.2557424306869507
At time: 27.090524673461914 accuracy is 0.890625 and loss is 0.24836244583129882
At time: 27.283231735229492 accuracy is 0.8734375 and loss is 0.3007898092269897
At time: 27.484341382980347 accuracy is 0.9046875 and loss is 0.2084272861480713
At time: 27.69432044029236 accuracy is 0.878125 and loss is 0.28996460437774657
Evaluating...
Done Evaluating: Achieved accuracy of 0.7525436046511628
Not better for 8
Completing Train Step at 10th epoch...
At time: 28.518077611923218 accuracy is 0.8453125 and loss is 0.38493595123291013
At time: 28.671046018600464 accuracy is 0.8765625 and loss is 0.2887047529220581
At time: 28.831676483154297 accuracy is 0.909375 and loss is 0.21412510871887208
At time: 28.99636149406433 accuracy is 0.8703125 and loss is 0.3121970176696777
At time: 29.163177967071533 accuracy is 0.8890625 and loss is 0.24451100826263428
At time: 29.340174913406372 accuracy is 0.9 and loss is 0.24390177726745604
At time: 29.51870059967041 accuracy is 0.909375 and loss is 0.22951231002807618
At time: 29.70537567138672 accuracy is 0.9203125 and loss is 0.18453384637832643
At time: 29.89896845817566 accuracy is 0.9015625 and loss is 0.25677359104156494
At time: 30.09194040298462 accuracy is 0.915625 and loss is 0.2286151170730591
At time: 30.293845415115356 accuracy is 0.91875 and loss is 0.18677771091461182
At time: 30.506851196289062 accuracy is 0.8734375 and loss is 0.2629646062850952
Evaluating...
Done Evaluating: Achieved accuracy of 0.7376453488372093
Not better for 9
Completing Train Step at 11th epoch...
At time: 31.29961109161377 accuracy is 0.8359375 and loss is 0.3513480663299561
At time: 31.452264547348022 accuracy is 0.884375 and loss is 0.26190762519836425
At time: 31.613189935684204 accuracy is 0.9296875 and loss is 0.21971554756164552
At time: 31.776790618896484 accuracy is 0.9078125 and loss is 0.23502953052520753
At time: 31.944299936294556 accuracy is 0.9125 and loss is 0.22114121913909912
At time: 32.11855936050415 accuracy is 0.915625 and loss is 0.20527663230895996
At time: 32.29660105705261 accuracy is 0.91875 and loss is 0.1790688991546631
At time: 32.48910617828369 accuracy is 0.93125 and loss is 0.18051887750625611
At time: 32.6872079372406 accuracy is 0.8953125 and loss is 0.25423731803894045
At time: 32.880342960357666 accuracy is 0.9078125 and loss is 0.21884920597076415
At time: 33.07781434059143 accuracy is 0.9171875 and loss is 0.17942904233932494
At time: 33.28788781166077 accuracy is 0.89375 and loss is 0.24308559894561768
Evaluating...
Done Evaluating: Achieved accuracy of 0.7238372093023255
Not better for 10
Model not improving. Stopping earlyat 0.8026889534883721 epochs.
Done Training. Achieved Best Accuracy of 0.8026889534883721
keyvalattn
SETTINGS FOR THIS RUN
{'tune_wordvecs': False, 'tune_attn': False, 'l2': 0.6819518225146731, 'attn_type': 'similarity', 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.8128967940273392, 'wordvec_dim': 300, 'dropout': 0.9178533733076936, 'wordvec_source': 'glove', 'data': 'MPQA', 'lr': 0.0017232191318039445}
Using CUDA!
here
similarity
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['GloVe']
Getting GloVe Vectors with 300 dims
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fb0c6297198>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
similarity
Using Attention model with following args:
{'train_word_vecs': False, 'hidden_size': 300, 'attn_type': 'similarity', 'cuda': True, 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.8128967940273392, 'num_classes': 2, 'input_size': 300, 'dropout': 0.9178533733076936, 'tune_attn': False, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
-0.4786 -0.1089 -0.0076  ...   0.7458  0.7174  0.6185
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
-0.0479  0.9828  0.9182  ...   0.0424  0.4554 -0.3210
[torch.FloatTensor of size 15284x300]
, 'attention_dim': 350, 'vocab_size': 15284}
Not Tuning Word Vectors!
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.16695237159729004 accuracy is 0.590625 and loss is 0.7349853038787841
At time: 0.32648229598999023 accuracy is 0.671875 and loss is 0.5855091094970704
At time: 0.49463772773742676 accuracy is 0.64375 and loss is 0.6738444328308105
At time: 0.6695573329925537 accuracy is 0.6875 and loss is 0.6908606052398681
At time: 0.8472702503204346 accuracy is 0.725 and loss is 0.6223947048187256
At time: 1.0395312309265137 accuracy is 0.7484375 and loss is 0.5897500038146972
At time: 1.2308011054992676 accuracy is 0.734375 and loss is 0.5332204818725585
At time: 1.4269583225250244 accuracy is 0.7765625 and loss is 0.6029015064239502
At time: 1.632591962814331 accuracy is 0.740625 and loss is 0.6417952537536621
At time: 1.8438537120819092 accuracy is 0.75625 and loss is 0.5190569400787354
At time: 2.0594429969787598 accuracy is 0.74375 and loss is 0.5446520328521729
At time: 2.285677909851074 accuracy is 0.7140625 and loss is 0.6374851703643799
Evaluating...
Done Evaluating: Achieved accuracy of 0.7845203488372093
Achieved new best!
Completing Train Step at 1th epoch...
At time: 3.1137211322784424 accuracy is 0.671875 and loss is 0.6769651412963867
At time: 3.2683334350585938 accuracy is 0.7375 and loss is 0.5580322742462158
At time: 3.4275763034820557 accuracy is 0.784375 and loss is 0.5142971992492675
At time: 3.58852219581604 accuracy is 0.7453125 and loss is 0.5158949851989746
At time: 3.7636899948120117 accuracy is 0.7796875 and loss is 0.4597414493560791
At time: 3.942657947540283 accuracy is 0.790625 and loss is 0.5262089252471924
At time: 4.12115740776062 accuracy is 0.7515625 and loss is 0.49957499504089353
At time: 4.308570146560669 accuracy is 0.7953125 and loss is 0.4568930149078369
At time: 4.494034290313721 accuracy is 0.7640625 and loss is 0.5026016712188721
At time: 4.686541795730591 accuracy is 0.7640625 and loss is 0.489917516708374
At time: 4.886673450469971 accuracy is 0.784375 and loss is 0.4724101543426514
At time: 5.101223707199097 accuracy is 0.7796875 and loss is 0.4885715484619141
Evaluating...
Done Evaluating: Achieved accuracy of 0.7870639534883721
Achieved new best!
Completing Train Step at 2th epoch...
At time: 5.887286424636841 accuracy is 0.7578125 and loss is 0.5889801025390625
At time: 6.043799877166748 accuracy is 0.765625 and loss is 0.5722651004791259
At time: 6.204264402389526 accuracy is 0.775 and loss is 0.5031460285186767
At time: 6.3681323528289795 accuracy is 0.8 and loss is 0.4444597244262695
At time: 6.536905288696289 accuracy is 0.8125 and loss is 0.483717155456543
At time: 6.711583375930786 accuracy is 0.78125 and loss is 0.424800968170166
At time: 6.891968011856079 accuracy is 0.7953125 and loss is 0.4302555561065674
At time: 7.0747997760772705 accuracy is 0.81875 and loss is 0.4297426700592041
At time: 7.264751434326172 accuracy is 0.7953125 and loss is 0.4498276233673096
At time: 7.458253383636475 accuracy is 0.81875 and loss is 0.43039960861206056
At time: 7.6603710651397705 accuracy is 0.8453125 and loss is 0.3764482498168945
At time: 7.870074987411499 accuracy is 0.7828125 and loss is 0.4610637664794922
Evaluating...
Done Evaluating: Achieved accuracy of 0.8070494186046512
Achieved new best!
Completing Train Step at 3th epoch...
At time: 8.66792917251587 accuracy is 0.7640625 and loss is 0.6044820308685303
At time: 8.821421384811401 accuracy is 0.809375 and loss is 0.46192178726196287
At time: 8.981452465057373 accuracy is 0.825 and loss is 0.36799719333648684
At time: 9.146886110305786 accuracy is 0.8203125 and loss is 0.44534740447998045
At time: 9.320621252059937 accuracy is 0.8625 and loss is 0.35830566883087156
At time: 9.498178958892822 accuracy is 0.8234375 and loss is 0.40028948783874513
At time: 9.676128387451172 accuracy is 0.834375 and loss is 0.38764755725860595
At time: 9.857528686523438 accuracy is 0.840625 and loss is 0.3518606424331665
At time: 10.045413494110107 accuracy is 0.83125 and loss is 0.36820805072784424
At time: 10.238624811172485 accuracy is 0.846875 and loss is 0.34840898513793944
At time: 10.43791913986206 accuracy is 0.89375 and loss is 0.29141314029693605
At time: 10.654181957244873 accuracy is 0.8375 and loss is 0.37868456840515136
Evaluating...
Done Evaluating: Achieved accuracy of 0.7877906976744186
Not better for 1
Completing Train Step at 4th epoch...
At time: 11.443302631378174 accuracy is 0.7703125 and loss is 0.562011432647705
At time: 11.604663372039795 accuracy is 0.815625 and loss is 0.8327309608459472
At time: 11.775373697280884 accuracy is 0.884375 and loss is 0.6514712333679199
At time: 11.93939208984375 accuracy is 0.8453125 and loss is 0.34103553295135497
At time: 12.10933780670166 accuracy is 0.8734375 and loss is 0.29896981716156007
At time: 12.28392219543457 accuracy is 0.8421875 and loss is 0.3478222131729126
At time: 12.459361553192139 accuracy is 0.8015625 and loss is 0.4155838966369629
At time: 12.642935037612915 accuracy is 0.821875 and loss is 0.37382330894470217
At time: 12.829298496246338 accuracy is 0.8578125 and loss is 0.31392698287963866
At time: 13.024638652801514 accuracy is 0.865625 and loss is 0.3499621391296387
At time: 13.223591804504395 accuracy is 0.853125 and loss is 0.3288963556289673
At time: 13.434625625610352 accuracy is 0.8328125 and loss is 0.37190706729888917
Evaluating...
Done Evaluating: Achieved accuracy of 0.8023255813953488
Not better for 2
Completing Train Step at 5th epoch...
At time: 14.136087894439697 accuracy is 0.76875 and loss is 0.5590178012847901
At time: 14.267720937728882 accuracy is 0.8546875 and loss is 0.326591944694519
At time: 14.397939205169678 accuracy is 0.85 and loss is 0.49728989601135254
At time: 14.53256869316101 accuracy is 0.8546875 and loss is 0.2973564386367798
At time: 14.670633316040039 accuracy is 0.8703125 and loss is 0.2435744047164917
At time: 14.81289291381836 accuracy is 0.9125 and loss is 0.22072348594665528
At time: 14.959175825119019 accuracy is 0.853125 and loss is 0.37742316722869873
At time: 15.108481168746948 accuracy is 0.9 and loss is 0.26445775032043456
At time: 15.318790674209595 accuracy is 0.8984375 and loss is 0.2613964319229126
At time: 15.52322006225586 accuracy is 0.9046875 and loss is 0.2509770393371582
At time: 15.739128589630127 accuracy is 0.903125 and loss is 0.22755885124206543
At time: 15.957457542419434 accuracy is 0.865625 and loss is 0.29789252281188966
Evaluating...
Done Evaluating: Achieved accuracy of 0.7779796511627907
Not better for 3
Completing Train Step at 6th epoch...
At time: 16.729817390441895 accuracy is 0.83125 and loss is 0.448639440536499
At time: 16.874390363693237 accuracy is 0.8875 and loss is 0.25720744132995604
At time: 17.028412342071533 accuracy is 0.8890625 and loss is 0.24584100246429444
At time: 17.18383765220642 accuracy is 0.8609375 and loss is 0.2782121658325195
At time: 17.344913005828857 accuracy is 0.9015625 and loss is 0.2231114149093628
At time: 17.50918698310852 accuracy is 0.9 and loss is 0.23877949714660646
At time: 17.67630887031555 accuracy is 0.8859375 and loss is 0.2607278823852539
At time: 17.8473162651062 accuracy is 0.8765625 and loss is 0.27171313762664795
At time: 18.025330305099487 accuracy is 0.8890625 and loss is 0.24372475147247313
At time: 18.205697774887085 accuracy is 0.9203125 and loss is 0.20180778503417968
At time: 18.39310359954834 accuracy is 0.9265625 and loss is 0.1640363335609436
At time: 18.591047763824463 accuracy is 0.90625 and loss is 0.21288397312164306
Evaluating...
Done Evaluating: Achieved accuracy of 0.7808866279069767
Not better for 4
Completing Train Step at 7th epoch...
At time: 19.329665422439575 accuracy is 0.828125 and loss is 0.4013396739959717
At time: 19.47607111930847 accuracy is 0.9421875 and loss is 0.16298729181289673
At time: 19.62596607208252 accuracy is 0.9234375 and loss is 0.20689835548400878
At time: 19.78069758415222 accuracy is 0.91875 and loss is 0.17821847200393676
At time: 19.939110040664673 accuracy is 0.95 and loss is 0.14842263460159302
At time: 20.1029314994812 accuracy is 0.9421875 and loss is 0.14289729595184325
At time: 20.26804256439209 accuracy is 0.915625 and loss is 0.18266080617904662
At time: 20.437975883483887 accuracy is 0.89375 and loss is 0.2562587261199951
At time: 20.61396884918213 accuracy is 0.9109375 and loss is 0.19499152898788452
At time: 20.794349431991577 accuracy is 0.9140625 and loss is 0.1859939932823181
At time: 20.982733726501465 accuracy is 0.9484375 and loss is 0.1382090926170349
At time: 21.18148398399353 accuracy is 0.9359375 and loss is 0.1712377429008484
Evaluating...
Done Evaluating: Achieved accuracy of 0.7205668604651163
Not better for 5
Completing Train Step at 8th epoch...
At time: 21.977917909622192 accuracy is 0.859375 and loss is 0.3621258020401001
At time: 22.150264024734497 accuracy is 0.896875 and loss is 0.32171194553375243
At time: 22.316511869430542 accuracy is 0.921875 and loss is 0.2025744676589966
At time: 22.48874044418335 accuracy is 0.903125 and loss is 0.24249415397644042
At time: 22.66055202484131 accuracy is 0.921875 and loss is 0.18298696279525756
At time: 22.831315517425537 accuracy is 0.9625 and loss is 0.11514048576354981
At time: 23.00087022781372 accuracy is 0.9390625 and loss is 0.16131820678710937
At time: 23.177421808242798 accuracy is 0.9359375 and loss is 0.16521319150924682
At time: 23.35323715209961 accuracy is 0.928125 and loss is 0.17161742448806763
At time: 23.534201622009277 accuracy is 0.934375 and loss is 0.14070284366607666
At time: 23.722665786743164 accuracy is 0.9453125 and loss is 0.13544119596481324
At time: 23.91988754272461 accuracy is 0.9421875 and loss is 0.1663538932800293
Evaluating...
Done Evaluating: Achieved accuracy of 0.7481831395348837
Not better for 6
Completing Train Step at 9th epoch...
At time: 24.655088901519775 accuracy is 0.915625 and loss is 0.19573898315429689
At time: 24.80332064628601 accuracy is 0.9453125 and loss is 0.18708586692810059
At time: 24.954712390899658 accuracy is 0.96875 and loss is 0.0941839337348938
At time: 25.12521481513977 accuracy is 0.9359375 and loss is 0.24204092025756835
At time: 25.31014108657837 accuracy is 0.9609375 and loss is 0.10041733980178832
At time: 25.497341632843018 accuracy is 0.971875 and loss is 0.07840348482131958
At time: 25.681321144104004 accuracy is 0.953125 and loss is 0.10092004537582397
At time: 25.86501169204712 accuracy is 0.9546875 and loss is 0.12183674573898315
At time: 26.071949005126953 accuracy is 0.9484375 and loss is 0.12805937528610228
At time: 26.263389825820923 accuracy is 0.959375 and loss is 0.10728375911712647
At time: 26.451765298843384 accuracy is 0.9671875 and loss is 0.10085704326629638
At time: 26.651487827301025 accuracy is 0.9421875 and loss is 0.14957077503204347
Evaluating...
Done Evaluating: Achieved accuracy of 0.762718023255814
Not better for 7
Completing Train Step at 10th epoch...
At time: 27.41283369064331 accuracy is 0.9328125 and loss is 0.17652658224105836
At time: 27.581635236740112 accuracy is 0.940625 and loss is 0.12976957559585572
At time: 27.746084451675415 accuracy is 0.946875 and loss is 0.17613427639007567
At time: 27.91964840888977 accuracy is 0.9609375 and loss is 0.12066969871520997
At time: 28.086500883102417 accuracy is 0.975 and loss is 0.09474588632583618
At time: 28.26068878173828 accuracy is 0.9453125 and loss is 0.1339990258216858
At time: 28.436466217041016 accuracy is 0.9484375 and loss is 0.13167303800582886
At time: 28.61687922477722 accuracy is 0.940625 and loss is 0.12207064628601075
At time: 28.805530548095703 accuracy is 0.9546875 and loss is 0.14414993524551392
At time: 28.998717069625854 accuracy is 0.96875 and loss is 0.09082911014556885
At time: 29.201224088668823 accuracy is 0.9515625 and loss is 0.1646331787109375
At time: 29.411214113235474 accuracy is 0.9625 and loss is 0.0718209207057953
Evaluating...
Done Evaluating: Achieved accuracy of 0.7761627906976745
Not better for 8
Completing Train Step at 11th epoch...
At time: 30.203433990478516 accuracy is 0.9421875 and loss is 0.15488481521606445
At time: 30.355993270874023 accuracy is 0.95625 and loss is 0.1339040517807007
At time: 30.51884126663208 accuracy is 0.9640625 and loss is 0.11030607223510742
At time: 30.68388557434082 accuracy is 0.965625 and loss is 0.07744017243385315
At time: 30.849649667739868 accuracy is 0.96875 and loss is 0.10093109607696533
At time: 31.02423119544983 accuracy is 0.95 and loss is 0.1497095823287964
At time: 31.203807830810547 accuracy is 0.9453125 and loss is 0.12005605697631835
At time: 31.38486647605896 accuracy is 0.9375 and loss is 0.23205089569091797
At time: 31.573617458343506 accuracy is 0.9625 and loss is 0.10274831056594849
At time: 31.764402866363525 accuracy is 0.959375 and loss is 0.19378888607025146
At time: 31.967800855636597 accuracy is 0.9453125 and loss is 0.14034923315048217
At time: 32.18315076828003 accuracy is 0.9625 and loss is 0.09242593050003052
Evaluating...
Done Evaluating: Achieved accuracy of 0.7678052325581395
Not better for 9
Completing Train Step at 12th epoch...
At time: 32.969719886779785 accuracy is 0.95 and loss is 0.12497580051422119
At time: 33.12575149536133 accuracy is 0.96875 and loss is 0.09581843614578248
At time: 33.280285596847534 accuracy is 0.9453125 and loss is 0.14169933795928955
At time: 33.446757793426514 accuracy is 0.96875 and loss is 0.06951547265052796
At time: 33.61717128753662 accuracy is 0.98125 and loss is 0.062241131067276
At time: 33.789764165878296 accuracy is 0.978125 and loss is 0.09598239660263061
At time: 33.96642184257507 accuracy is 0.9625 and loss is 0.12946367263793945
At time: 34.14591884613037 accuracy is 0.975 and loss is 0.08494205474853515
At time: 34.33422660827637 accuracy is 0.9734375 and loss is 0.07519655227661133
At time: 34.526448011398315 accuracy is 0.959375 and loss is 0.08794589042663574
At time: 34.72975754737854 accuracy is 0.971875 and loss is 0.06498405933380128
At time: 34.94524908065796 accuracy is 0.9859375 and loss is 0.06504520773887634
Evaluating...
Done Evaluating: Achieved accuracy of 0.7496366279069767
Not better for 10
Model not improving. Stopping earlyat 0.8070494186046512 epochs.
Done Training. Achieved Best Accuracy of 0.8070494186046512
keyvalattn



RESULTS:
[{'params': {'tune_wordvecs': False, 'tune_attn': False, 'l2': 0.4022621995384825, 'attn_type': 'similarity', 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.5691364879936501, 'wordvec_dim': 300, 'dropout': 0.19718330921055827, 'wordvec_source': 'glove', 'data': 'MPQA', 'lr': 0.002279297103481781}, 'best_accuracy': 0.7925145348837209}, {'params': {'tune_wordvecs': False, 'tune_attn': False, 'l2': 0.8229856890014869, 'attn_type': 'similarity', 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.4071526000314305, 'wordvec_dim': 300, 'dropout': 0.7908405900471712, 'wordvec_source': 'glove', 'data': 'MPQA', 'lr': 0.0008369691177334823}, 'best_accuracy': 0.8077761627906976}, {'params': {'tune_wordvecs': False, 'tune_attn': False, 'l2': 0.12991053423094034, 'attn_type': 'similarity', 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.7352481041038139, 'wordvec_dim': 300, 'dropout': 0.9671986213710806, 'wordvec_source': 'glove', 'data': 'MPQA', 'lr': 0.002106900900554126}, 'best_accuracy': 0.798328488372093}, {'params': {'tune_wordvecs': False, 'tune_attn': False, 'l2': 0.9921872247673922, 'attn_type': 'similarity', 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.6084692913981343, 'wordvec_dim': 300, 'dropout': 0.7171939578485692, 'wordvec_source': 'glove', 'data': 'MPQA', 'lr': 0.004679524359007832}, 'best_accuracy': 0.8026889534883721}, {'params': {'tune_wordvecs': False, 'tune_attn': False, 'l2': 0.6819518225146731, 'attn_type': 'similarity', 'batch_size': 32, 'num_layers': 2, 'rnn_dropout': 0.8128967940273392, 'wordvec_dim': 300, 'dropout': 0.9178533733076936, 'wordvec_source': 'glove', 'data': 'MPQA', 'lr': 0.0017232191318039445}, 'best_accuracy': 0.8070494186046512}]
