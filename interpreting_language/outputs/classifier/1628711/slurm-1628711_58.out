ROOT_PATH: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language
Building Bayesian Optimizer for 
 data:MPQA 
 choices:[{'name': 'lr', 'type': 'continuous', 'domain': [5e-05, 0.005]}, {'name': 'rnn_dropout', 'type': 'continuous', 'domain': [0, 1]}, {'name': 'dropout', 'type': 'continuous', 'domain': [0, 1]}, {'name': 'l2', 'type': 'continuous', 'domain': [0, 1]}, {'name': 'attention_dim', 'type': 'continuous', 'domain': [5, 100]}]
SETTINGS FOR THIS RUN
{'dropout': 0.5376350632534027, 'rnn_dropout': 0.008176655799947308, 'attn_type': 'MLP', 'attention_dim': 97, 'tune_wordvecs': True, 'wordvec_source': 'google', 'lr': 0.0006325079919326121, 'batch_size': 32, 'l2': 0.5897964839902454, 'num_layers': 1, 'data': 'MPQA', 'wordvec_dim': 300}
Using CUDA!
here
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['googlenews']
Getting google news vectors
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fa7eb656160>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'vocab_size': 15284, 'dropout': 0.5376350632534027, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'attention_dim': 97, 'cuda': True, 'tune_attn': 'True', 'input_size': 300, 'attn_type': 'MLP', 'num_classes': 2, 'batch_size': 32, 'hidden_size': 300, 'num_layers': 1, 'rnn_dropout': 0.008176655799947308, 'train_word_vecs': True}
Begin Training...
Completing Train Step at 0th epoch...
At time: 1.115311622619629 accuracy is 0.56875 and loss is 0.7206243515014649
At time: 1.3157992362976074 accuracy is 0.540625 and loss is 0.6886987686157227
At time: 1.5176022052764893 accuracy is 0.5984375 and loss is 0.6612739086151123
At time: 1.7243163585662842 accuracy is 0.6515625 and loss is 0.6421281814575195
At time: 1.9333107471466064 accuracy is 0.70625 and loss is 0.5699047565460205
At time: 2.138427495956421 accuracy is 0.7359375 and loss is 0.5357171058654785
At time: 2.3416643142700195 accuracy is 0.753125 and loss is 0.5459746837615966
At time: 2.548276424407959 accuracy is 0.7375 and loss is 0.5168004989624023
At time: 2.7483034133911133 accuracy is 0.7578125 and loss is 0.5163649559020996
At time: 2.9526314735412598 accuracy is 0.7671875 and loss is 0.5137511730194092
At time: 3.156348943710327 accuracy is 0.7640625 and loss is 0.4777667045593262
At time: 3.362136125564575 accuracy is 0.7671875 and loss is 0.46784286499023436
Evaluating...
Done Evaluating: Achieved accuracy of 0.7441860465116279
Achieved new best!
Completing Train Step at 1th epoch...
At time: 4.1454973220825195 accuracy is 0.6421875 and loss is 0.6776938915252686
At time: 4.341647386550903 accuracy is 0.80625 and loss is 0.476483678817749
At time: 4.534447431564331 accuracy is 0.86875 and loss is 0.3403045892715454
At time: 4.723234176635742 accuracy is 0.834375 and loss is 0.3994150638580322
At time: 4.915031909942627 accuracy is 0.8296875 and loss is 0.37738006114959716
At time: 5.1093971729278564 accuracy is 0.8640625 and loss is 0.31171164512634275
At time: 5.3031463623046875 accuracy is 0.8640625 and loss is 0.32177348136901857
At time: 5.498406171798706 accuracy is 0.825 and loss is 0.40036354064941404
At time: 5.701558828353882 accuracy is 0.8453125 and loss is 0.3390359401702881
At time: 5.901816368103027 accuracy is 0.875 and loss is 0.29257874488830565
At time: 6.106122016906738 accuracy is 0.9015625 and loss is 0.2726491928100586
At time: 6.312358856201172 accuracy is 0.9109375 and loss is 0.2273862600326538
Evaluating...
Done Evaluating: Achieved accuracy of 0.7721656976744186
Achieved new best!
Completing Train Step at 2th epoch...
At time: 7.090441465377808 accuracy is 0.8453125 and loss is 0.43131103515625
At time: 7.27989935874939 accuracy is 0.896875 and loss is 0.2379920482635498
At time: 7.467804908752441 accuracy is 0.946875 and loss is 0.13107354640960694
At time: 7.6576173305511475 accuracy is 0.8859375 and loss is 0.2791548728942871
At time: 7.848560810089111 accuracy is 0.9171875 and loss is 0.22557194232940675
At time: 8.056873798370361 accuracy is 0.896875 and loss is 0.26462883949279786
At time: 8.251779317855835 accuracy is 0.9203125 and loss is 0.2179135799407959
At time: 8.451514482498169 accuracy is 0.8875 and loss is 0.26996846199035646
At time: 8.647510290145874 accuracy is 0.9046875 and loss is 0.22052538394927979
At time: 8.840417385101318 accuracy is 0.9078125 and loss is 0.20833024978637696
At time: 9.037233114242554 accuracy is 0.8984375 and loss is 0.2404151201248169
At time: 9.237539529800415 accuracy is 0.909375 and loss is 0.21404104232788085
Evaluating...
Done Evaluating: Achieved accuracy of 0.7307412790697675
Not better for 1
Completing Train Step at 3th epoch...
At time: 9.998895406723022 accuracy is 0.9203125 and loss is 0.26976940631866453
At time: 10.179049968719482 accuracy is 0.9796875 and loss is 0.07600319981575013
At time: 10.361725807189941 accuracy is 0.96875 and loss is 0.09527868032455444
At time: 10.544676065444946 accuracy is 0.8921875 and loss is 0.3648996353149414
At time: 10.729899168014526 accuracy is 0.921875 and loss is 0.17207597494125365
At time: 10.917480945587158 accuracy is 0.946875 and loss is 0.1406644105911255
At time: 11.104777097702026 accuracy is 0.9734375 and loss is 0.09802307486534119
At time: 11.302582025527954 accuracy is 0.94375 and loss is 0.15388259887695313
At time: 11.495684146881104 accuracy is 0.934375 and loss is 0.1720975875854492
At time: 11.689142227172852 accuracy is 0.9546875 and loss is 0.11880905628204345
At time: 11.885887384414673 accuracy is 0.9484375 and loss is 0.13489118814468384
At time: 12.08538293838501 accuracy is 0.9640625 and loss is 0.10937298536300659
Evaluating...
Done Evaluating: Achieved accuracy of 0.7263808139534884
Not better for 2
Completing Train Step at 4th epoch...
At time: 12.844509601593018 accuracy is 0.9234375 and loss is 0.21103267669677733
At time: 13.024190902709961 accuracy is 0.9765625 and loss is 0.06765706539154052
At time: 13.205795764923096 accuracy is 0.934375 and loss is 0.15161796808242797
At time: 13.389539241790771 accuracy is 0.925 and loss is 0.2625699996948242
At time: 13.57457971572876 accuracy is 0.9515625 and loss is 0.11726765632629395
At time: 13.76045560836792 accuracy is 0.98125 and loss is 0.05676760077476502
At time: 13.947093963623047 accuracy is 0.975 and loss is 0.07748421430587768
At time: 14.138039112091064 accuracy is 0.959375 and loss is 0.1157636284828186
At time: 14.336560487747192 accuracy is 0.9484375 and loss is 0.13914440870285033
At time: 14.532254695892334 accuracy is 0.9578125 and loss is 0.10198630094528198
At time: 14.731966018676758 accuracy is 0.971875 and loss is 0.07506665587425232
At time: 14.930831909179688 accuracy is 0.9828125 and loss is 0.059285467863082884
Evaluating...
Done Evaluating: Achieved accuracy of 0.7452761627906976
Not better for 3
Completing Train Step at 5th epoch...
At time: 15.687654972076416 accuracy is 0.940625 and loss is 0.16322143077850343
At time: 15.868257999420166 accuracy is 0.9796875 and loss is 0.04523332417011261
At time: 16.05189800262451 accuracy is 0.9484375 and loss is 0.14570337533950806
At time: 16.23463201522827 accuracy is 0.934375 and loss is 0.2057361125946045
At time: 16.419016361236572 accuracy is 0.9484375 and loss is 0.13942277431488037
At time: 16.607096195220947 accuracy is 0.9375 and loss is 0.16249208450317382
At time: 16.79797911643982 accuracy is 0.946875 and loss is 0.13308871984481813
At time: 16.992998123168945 accuracy is 0.9578125 and loss is 0.1051762580871582
At time: 17.188472032546997 accuracy is 0.9734375 and loss is 0.06339231729507447
At time: 17.382885217666626 accuracy is 0.9796875 and loss is 0.05807289481163025
At time: 17.58210563659668 accuracy is 0.9796875 and loss is 0.05140842199325561
At time: 17.782921075820923 accuracy is 0.9890625 and loss is 0.050175529718399045
Evaluating...
Done Evaluating: Achieved accuracy of 0.7460029069767442
Not better for 4
Completing Train Step at 6th epoch...
At time: 18.546363592147827 accuracy is 0.9734375 and loss is 0.08779755830764771
At time: 18.725754737854004 accuracy is 0.978125 and loss is 0.04997642040252685
At time: 18.91084384918213 accuracy is 0.9734375 and loss is 0.06421562433242797
At time: 19.095629692077637 accuracy is 0.946875 and loss is 0.11515761613845825
At time: 19.281208515167236 accuracy is 0.9546875 and loss is 0.1101790189743042
At time: 19.468132257461548 accuracy is 0.9796875 and loss is 0.0686235249042511
At time: 19.665566444396973 accuracy is 0.96875 and loss is 0.08653520345687866
At time: 19.8566837310791 accuracy is 0.984375 and loss is 0.04450616538524628
At time: 20.04977560043335 accuracy is 0.9875 and loss is 0.029178285598754884
At time: 20.25011134147644 accuracy is 0.959375 and loss is 0.0959668755531311
At time: 20.447253704071045 accuracy is 0.9859375 and loss is 0.03788800239562988
At time: 20.647992849349976 accuracy is 0.9828125 and loss is 0.05726099610328674
Evaluating...
Done Evaluating: Achieved accuracy of 0.752906976744186
Not better for 5
Completing Train Step at 7th epoch...
At time: 21.40808367729187 accuracy is 0.9796875 and loss is 0.07972198128700256
At time: 21.585784435272217 accuracy is 0.978125 and loss is 0.052434468269348146
At time: 21.76621389389038 accuracy is 0.9828125 and loss is 0.050163555145263675
At time: 21.95292592048645 accuracy is 0.971875 and loss is 0.0815314531326294
At time: 22.1375675201416 accuracy is 0.990625 and loss is 0.025407856702804564
At time: 22.325090646743774 accuracy is 0.9859375 and loss is 0.05192722082138061
At time: 22.518206357955933 accuracy is 0.98125 and loss is 0.05988415479660034
At time: 22.713682651519775 accuracy is 0.971875 and loss is 0.09026172757148743
At time: 22.9067325592041 accuracy is 0.95 and loss is 0.1672717809677124
At time: 23.104448318481445 accuracy is 0.9765625 and loss is 0.07234813570976258
At time: 23.300870656967163 accuracy is 0.9796875 and loss is 0.0430410236120224
At time: 23.500611543655396 accuracy is 0.9921875 and loss is 0.03888588547706604
Evaluating...
Done Evaluating: Achieved accuracy of 0.747093023255814
Not better for 6
Completing Train Step at 8th epoch...
At time: 24.26343584060669 accuracy is 0.978125 and loss is 0.060769522190093996
At time: 24.441891193389893 accuracy is 0.975 and loss is 0.053764748573303225
At time: 24.624713897705078 accuracy is 0.9609375 and loss is 0.10179202556610108
At time: 24.808400630950928 accuracy is 0.9734375 and loss is 0.10795047283172607
At time: 24.993350744247437 accuracy is 0.965625 and loss is 0.08352353572845458
At time: 25.18065881729126 accuracy is 0.990625 and loss is 0.030470624566078186
At time: 25.372825145721436 accuracy is 0.9828125 and loss is 0.05247305035591125
At time: 25.56324791908264 accuracy is 0.978125 and loss is 0.08440200686454773
At time: 25.755637407302856 accuracy is 0.9859375 and loss is 0.038213640451431274
At time: 25.94999933242798 accuracy is 0.9890625 and loss is 0.04005737006664276
At time: 26.147095441818237 accuracy is 0.9890625 and loss is 0.03131216466426849
At time: 26.35233473777771 accuracy is 0.990625 and loss is 0.048749491572380066
Evaluating...
Done Evaluating: Achieved accuracy of 0.7430959302325582
Not better for 7
Completing Train Step at 9th epoch...
At time: 27.11690878868103 accuracy is 0.984375 and loss is 0.06598404049873352
At time: 27.296570301055908 accuracy is 0.990625 and loss is 0.022074437141418456
At time: 27.477606534957886 accuracy is 0.99375 and loss is 0.02610907256603241
At time: 27.66101098060608 accuracy is 0.9828125 and loss is 0.039422607421875
At time: 27.845844984054565 accuracy is 0.99375 and loss is 0.01926409751176834
At time: 28.033183813095093 accuracy is 0.9953125 and loss is 0.02034513056278229
At time: 28.22292971611023 accuracy is 0.9765625 and loss is 0.08027437925338746
At time: 28.411049365997314 accuracy is 0.984375 and loss is 0.052293521165847776
At time: 28.602556943893433 accuracy is 0.9734375 and loss is 0.05767509341239929
At time: 28.79540181159973 accuracy is 0.971875 and loss is 0.07418272495269776
At time: 28.990745306015015 accuracy is 0.9921875 and loss is 0.02735530138015747
At time: 29.191149473190308 accuracy is 0.9875 and loss is 0.04638039171695709
Evaluating...
Done Evaluating: Achieved accuracy of 0.7256540697674418
Not better for 8
Completing Train Step at 10th epoch...
At time: 29.957338571548462 accuracy is 0.984375 and loss is 0.04082704186439514
At time: 30.135746717453003 accuracy is 0.984375 and loss is 0.04505951702594757
At time: 30.318027019500732 accuracy is 0.9765625 and loss is 0.06556454300880432
At time: 30.503645658493042 accuracy is 0.9921875 and loss is 0.025075259804725646
At time: 30.689170837402344 accuracy is 0.990625 and loss is 0.03402122557163238
At time: 30.877551794052124 accuracy is 0.996875 and loss is 0.007876785844564438
At time: 31.067991733551025 accuracy is 0.990625 and loss is 0.020839571952819824
At time: 31.25515365600586 accuracy is 0.9921875 and loss is 0.022389145195484163
At time: 31.445390701293945 accuracy is 0.990625 and loss is 0.017897950112819673
At time: 31.6389217376709 accuracy is 0.990625 and loss is 0.02469550520181656
At time: 31.834548950195312 accuracy is 0.9859375 and loss is 0.031928020715713504
At time: 32.0333731174469 accuracy is 0.9875 and loss is 0.03535243272781372
Evaluating...
Done Evaluating: Achieved accuracy of 0.720203488372093
Not better for 9
Completing Train Step at 11th epoch...
At time: 32.79205679893494 accuracy is 0.98125 and loss is 0.05588487386703491
At time: 32.971147298812866 accuracy is 0.9890625 and loss is 0.045887553691864015
At time: 33.152770042419434 accuracy is 0.9859375 and loss is 0.025856074690818787
At time: 33.3356819152832 accuracy is 0.9890625 and loss is 0.03044155240058899
At time: 33.520201444625854 accuracy is 0.990625 and loss is 0.0319800078868866
At time: 33.709006547927856 accuracy is 0.99375 and loss is 0.018487021327018738
At time: 33.89869022369385 accuracy is 0.9859375 and loss is 0.06397583484649658
At time: 34.08759880065918 accuracy is 0.978125 and loss is 0.05876632928848267
At time: 34.277815103530884 accuracy is 0.9921875 and loss is 0.022399409115314482
At time: 34.47050952911377 accuracy is 0.996875 and loss is 0.012940694391727448
At time: 34.66658926010132 accuracy is 0.9859375 and loss is 0.04078619182109833
At time: 34.86634969711304 accuracy is 0.990625 and loss is 0.03414957821369171
Evaluating...
Done Evaluating: Achieved accuracy of 0.7365552325581395
Not better for 10
Model not improving. Stopping earlyat 0.7721656976744186 epochs.
Done Training. Achieved Best Accuracy of 0.7721656976744186
Improved accuracyfrom -10000000 to 0.7721656976744186
mlpattn
SETTINGS FOR THIS RUN
{'dropout': 0.48272183782402855, 'rnn_dropout': 0.2773357192999366, 'attn_type': 'MLP', 'attention_dim': 27, 'tune_wordvecs': True, 'wordvec_source': 'google', 'lr': 0.0015536578842418245, 'batch_size': 32, 'l2': 0.06294149216131684, 'num_layers': 1, 'data': 'MPQA', 'wordvec_dim': 300}
Using CUDA!
here
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['googlenews']
Getting google news vectors
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fa7eac54ef0>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'vocab_size': 15284, 'dropout': 0.48272183782402855, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'attention_dim': 27, 'cuda': True, 'tune_attn': 'True', 'input_size': 300, 'attn_type': 'MLP', 'num_classes': 2, 'batch_size': 32, 'hidden_size': 300, 'num_layers': 1, 'rnn_dropout': 0.2773357192999366, 'train_word_vecs': True}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.20765185356140137 accuracy is 0.5609375 and loss is 0.7292485713958741
At time: 0.3932223320007324 accuracy is 0.5546875 and loss is 0.6837305545806884
At time: 0.5769350528717041 accuracy is 0.6390625 and loss is 0.6118863105773926
At time: 0.7638235092163086 accuracy is 0.6546875 and loss is 0.6281032562255859
At time: 0.9501430988311768 accuracy is 0.7390625 and loss is 0.5409605026245117
At time: 1.1407418251037598 accuracy is 0.7453125 and loss is 0.5634018898010253
At time: 1.3289697170257568 accuracy is 0.7203125 and loss is 0.5460868358612061
At time: 1.5175137519836426 accuracy is 0.778125 and loss is 0.498394775390625
At time: 1.7121007442474365 accuracy is 0.7484375 and loss is 0.507966423034668
At time: 1.9151980876922607 accuracy is 0.75625 and loss is 0.505916690826416
At time: 2.1206231117248535 accuracy is 0.775 and loss is 0.45211191177368165
At time: 2.328057050704956 accuracy is 0.74375 and loss is 0.5083865642547607
Evaluating...
Done Evaluating: Achieved accuracy of 0.668968023255814
Achieved new best!
Completing Train Step at 1th epoch...
At time: 3.1070315837860107 accuracy is 0.6515625 and loss is 0.6331517219543457
At time: 3.287663459777832 accuracy is 0.8828125 and loss is 0.358213472366333
At time: 3.4697105884552 accuracy is 0.8796875 and loss is 0.3024968385696411
At time: 3.654447555541992 accuracy is 0.81875 and loss is 0.4707180976867676
At time: 3.841933012008667 accuracy is 0.846875 and loss is 0.35588846206665037
At time: 4.028078317642212 accuracy is 0.8515625 and loss is 0.333844256401062
At time: 4.215530633926392 accuracy is 0.8875 and loss is 0.2625533103942871
At time: 4.405531406402588 accuracy is 0.871875 and loss is 0.3085516929626465
At time: 4.596903085708618 accuracy is 0.8828125 and loss is 0.2688880205154419
At time: 4.789984226226807 accuracy is 0.865625 and loss is 0.2981640577316284
At time: 4.990799903869629 accuracy is 0.946875 and loss is 0.13405964374542237
At time: 5.194226503372192 accuracy is 0.878125 and loss is 0.30374281406402587
Evaluating...
Done Evaluating: Achieved accuracy of 0.7423691860465116
Achieved new best!
Completing Train Step at 2th epoch...
At time: 5.951632738113403 accuracy is 0.8296875 and loss is 0.45451951026916504
At time: 6.1293253898620605 accuracy is 0.9296875 and loss is 0.17508469820022582
At time: 6.311083793640137 accuracy is 0.940625 and loss is 0.17470862865447997
At time: 6.495927333831787 accuracy is 0.9 and loss is 0.24806632995605468
At time: 6.682220220565796 accuracy is 0.90625 and loss is 0.23708813190460204
At time: 6.867427825927734 accuracy is 0.9234375 and loss is 0.2003718614578247
At time: 7.054966688156128 accuracy is 0.9453125 and loss is 0.13229539394378662
At time: 7.2425150871276855 accuracy is 0.9203125 and loss is 0.2013270378112793
At time: 7.433963060379028 accuracy is 0.934375 and loss is 0.17568531036376953
At time: 7.626516819000244 accuracy is 0.9203125 and loss is 0.19687509536743164
At time: 7.8239710330963135 accuracy is 0.9703125 and loss is 0.08156170248985291
At time: 8.026095151901245 accuracy is 0.978125 and loss is 0.07150457501411438
Evaluating...
Done Evaluating: Achieved accuracy of 0.7405523255813954
Not better for 1
Completing Train Step at 3th epoch...
At time: 8.778123378753662 accuracy is 0.878125 and loss is 0.32622971534729006
At time: 8.95690369606018 accuracy is 0.9671875 and loss is 0.09283036589622498
At time: 9.137722253799438 accuracy is 0.98125 and loss is 0.0597762942314148
At time: 9.322460412979126 accuracy is 0.9265625 and loss is 0.26023790836334226
At time: 9.507508754730225 accuracy is 0.928125 and loss is 0.26149280071258546
At time: 9.693235874176025 accuracy is 0.9828125 and loss is 0.06675001978874207
At time: 9.881433486938477 accuracy is 0.984375 and loss is 0.06465906500816346
At time: 10.069265127182007 accuracy is 0.9703125 and loss is 0.08642505407333374
At time: 10.260192394256592 accuracy is 0.975 and loss is 0.08159865140914917
At time: 10.453037977218628 accuracy is 0.9515625 and loss is 0.16260573863983155
At time: 10.651503086090088 accuracy is 0.9765625 and loss is 0.057220053672790525
At time: 10.839840650558472 accuracy is 0.9796875 and loss is 0.06398786902427674
Evaluating...
Done Evaluating: Achieved accuracy of 0.7292877906976745
Not better for 2
Completing Train Step at 4th epoch...
At time: 11.49530029296875 accuracy is 0.91875 and loss is 0.22546639442443847
At time: 11.65871000289917 accuracy is 0.9890625 and loss is 0.050079327821731565
At time: 11.824140071868896 accuracy is 0.978125 and loss is 0.0702024519443512
At time: 11.990392684936523 accuracy is 0.94375 and loss is 0.12647924423217774
At time: 12.158663272857666 accuracy is 0.9484375 and loss is 0.18171952962875365
At time: 12.327300310134888 accuracy is 0.978125 and loss is 0.0599206805229187
At time: 12.516283750534058 accuracy is 0.9765625 and loss is 0.07039364576339721
At time: 12.709080696105957 accuracy is 0.975 and loss is 0.08230940699577331
At time: 12.90252947807312 accuracy is 0.9765625 and loss is 0.06138654351234436
At time: 13.098313570022583 accuracy is 0.9609375 and loss is 0.14949709177017212
At time: 13.294639587402344 accuracy is 0.984375 and loss is 0.036808326840400696
At time: 13.494747400283813 accuracy is 0.9875 and loss is 0.0535146951675415
Evaluating...
Done Evaluating: Achieved accuracy of 0.7125726744186046
Not better for 3
Completing Train Step at 5th epoch...
At time: 14.250103950500488 accuracy is 0.95 and loss is 0.13625047206878663
At time: 14.42996072769165 accuracy is 0.9890625 and loss is 0.041112574934959414
At time: 14.611050605773926 accuracy is 0.9859375 and loss is 0.04059988558292389
At time: 14.794426441192627 accuracy is 0.9609375 and loss is 0.12800968885421754
At time: 14.979244232177734 accuracy is 0.9671875 and loss is 0.10046927928924561
At time: 15.1673104763031 accuracy is 0.9859375 and loss is 0.04069511890411377
At time: 15.355826139450073 accuracy is 0.95625 and loss is 0.11611464023590087
At time: 15.546065092086792 accuracy is 0.990625 and loss is 0.027213257551193238
At time: 15.736961841583252 accuracy is 0.984375 and loss is 0.04597765803337097
At time: 15.930116176605225 accuracy is 0.975 and loss is 0.09706097841262817
At time: 16.127991914749146 accuracy is 0.9609375 and loss is 0.10263500213623047
At time: 16.33052086830139 accuracy is 0.859375 and loss is 0.49277725219726565
Evaluating...
Done Evaluating: Achieved accuracy of 0.7351017441860465
Not better for 4
Completing Train Step at 6th epoch...
At time: 17.092604398727417 accuracy is 0.9734375 and loss is 0.09948062896728516
At time: 17.270651817321777 accuracy is 0.9796875 and loss is 0.046552914381027224
At time: 17.451501846313477 accuracy is 0.9890625 and loss is 0.02588987648487091
At time: 17.636634349822998 accuracy is 0.9546875 and loss is 0.11583576202392579
At time: 17.8220112323761 accuracy is 0.953125 and loss is 0.14241254329681396
At time: 18.010165691375732 accuracy is 0.9640625 and loss is 0.08183040022850037
At time: 18.19894790649414 accuracy is 0.9765625 and loss is 0.09152523279190064
At time: 18.38734793663025 accuracy is 0.9546875 and loss is 0.13238610029220582
At time: 18.577192068099976 accuracy is 0.9828125 and loss is 0.04798087179660797
At time: 18.770082712173462 accuracy is 0.9796875 and loss is 0.06875783205032349
At time: 18.965900897979736 accuracy is 0.9796875 and loss is 0.055778855085372926
At time: 19.165984630584717 accuracy is 0.9875 and loss is 0.04231424927711487
Evaluating...
Done Evaluating: Achieved accuracy of 0.7169331395348837
Not better for 5
Completing Train Step at 7th epoch...
At time: 19.922427654266357 accuracy is 0.959375 and loss is 0.13506660461425782
At time: 20.101805686950684 accuracy is 0.9796875 and loss is 0.06340668201446534
At time: 20.28296995162964 accuracy is 0.978125 and loss is 0.05839226245880127
At time: 20.4650456905365 accuracy is 0.9734375 and loss is 0.06905253529548645
At time: 20.650220155715942 accuracy is 0.9671875 and loss is 0.09589120149612426
At time: 20.837852954864502 accuracy is 0.9859375 and loss is 0.04176005721092224
At time: 21.0261549949646 accuracy is 0.971875 and loss is 0.08021205067634582
At time: 21.215229511260986 accuracy is 0.9796875 and loss is 0.0710757851600647
At time: 21.40626811981201 accuracy is 0.9875 and loss is 0.040972480177879335
At time: 21.59893035888672 accuracy is 0.96875 and loss is 0.08242726922035218
At time: 21.795660972595215 accuracy is 0.9828125 and loss is 0.05268030166625977
At time: 21.998114109039307 accuracy is 0.940625 and loss is 0.18633618354797363
Evaluating...
Done Evaluating: Achieved accuracy of 0.7441860465116279
Achieved new best!
Completing Train Step at 8th epoch...
At time: 22.74667739868164 accuracy is 0.9671875 and loss is 0.1084787368774414
At time: 22.925569772720337 accuracy is 0.9734375 and loss is 0.07211467027664184
At time: 23.10788083076477 accuracy is 0.9765625 and loss is 0.04624117612838745
At time: 23.290903329849243 accuracy is 0.9640625 and loss is 0.1223527193069458
At time: 23.475553512573242 accuracy is 0.978125 and loss is 0.07756944894790649
At time: 23.662872791290283 accuracy is 0.9703125 and loss is 0.09351164102554321
At time: 23.851349592208862 accuracy is 0.975 and loss is 0.07582226991653443
At time: 24.04039716720581 accuracy is 0.9140625 and loss is 0.2837939500808716
At time: 24.231528759002686 accuracy is 0.984375 and loss is 0.03623219132423401
At time: 24.423155069351196 accuracy is 0.9796875 and loss is 0.060510873794555664
At time: 24.619104623794556 accuracy is 0.975 and loss is 0.06911312341690064
At time: 24.82043981552124 accuracy is 0.9484375 and loss is 0.18657857179641724
Evaluating...
Done Evaluating: Achieved accuracy of 0.7449127906976745
Achieved new best!
Completing Train Step at 9th epoch...
At time: 25.57312273979187 accuracy is 0.9765625 and loss is 0.09936768412590027
At time: 25.75146985054016 accuracy is 0.984375 and loss is 0.060075944662094115
At time: 25.932563066482544 accuracy is 0.990625 and loss is 0.03343348205089569
At time: 26.11979031562805 accuracy is 0.975 and loss is 0.0650641679763794
At time: 26.30497431755066 accuracy is 0.978125 and loss is 0.0736085057258606
At time: 26.492892503738403 accuracy is 0.984375 and loss is 0.058739197254180905
At time: 26.680886268615723 accuracy is 0.9828125 and loss is 0.0480586975812912
At time: 26.869734525680542 accuracy is 0.975 and loss is 0.07394893169403076
At time: 27.061167240142822 accuracy is 0.9765625 and loss is 0.0868205964565277
At time: 27.25276780128479 accuracy is 0.9890625 and loss is 0.023629210889339447
At time: 27.448614597320557 accuracy is 0.990625 and loss is 0.027059879899024964
At time: 27.647769927978516 accuracy is 0.9796875 and loss is 0.07108869552612304
Evaluating...
Done Evaluating: Achieved accuracy of 0.7416424418604651
Not better for 1
Completing Train Step at 10th epoch...
At time: 28.40656542778015 accuracy is 0.971875 and loss is 0.10236271619796752
At time: 28.583342790603638 accuracy is 0.990625 and loss is 0.030340561270713808
At time: 28.76565146446228 accuracy is 0.9828125 and loss is 0.04699991345405578
At time: 28.947951078414917 accuracy is 0.9765625 and loss is 0.06742882132530212
At time: 29.133687734603882 accuracy is 0.9953125 and loss is 0.02186071276664734
At time: 29.319860458374023 accuracy is 0.9953125 and loss is 0.026047176122665404
At time: 29.506797075271606 accuracy is 0.9859375 and loss is 0.03601241707801819
At time: 29.695544242858887 accuracy is 0.9859375 and loss is 0.038399997353553775
At time: 29.886334657669067 accuracy is 0.9828125 and loss is 0.061683791875839236
At time: 30.078397035598755 accuracy is 0.9828125 and loss is 0.06060782670974731
At time: 30.274511575698853 accuracy is 0.9765625 and loss is 0.056110018491744997
At time: 30.474781036376953 accuracy is 0.9875 and loss is 0.033448529243469236
Evaluating...
Done Evaluating: Achieved accuracy of 0.7430959302325582
Not better for 2
Completing Train Step at 11th epoch...
At time: 31.231029748916626 accuracy is 0.9671875 and loss is 0.0907154142856598
At time: 31.40947413444519 accuracy is 0.9890625 and loss is 0.030991998314857484
At time: 31.591248035430908 accuracy is 0.9796875 and loss is 0.0611674427986145
At time: 31.774460077285767 accuracy is 0.96875 and loss is 0.07607614398002624
At time: 31.959803581237793 accuracy is 0.9796875 and loss is 0.061909472942352294
At time: 32.145421266555786 accuracy is 0.9875 and loss is 0.026269391179084778
At time: 32.33366322517395 accuracy is 0.9734375 and loss is 0.06193544864654541
At time: 32.52493357658386 accuracy is 0.9734375 and loss is 0.06189253330230713
At time: 32.715909481048584 accuracy is 0.9671875 and loss is 0.07951735258102417
At time: 32.90810465812683 accuracy is 0.984375 and loss is 0.04928855299949646
At time: 33.103166580200195 accuracy is 0.9921875 and loss is 0.015268221497535706
At time: 33.30530905723572 accuracy is 0.9890625 and loss is 0.03442488610744476
Evaluating...
Done Evaluating: Achieved accuracy of 0.7220203488372093
Not better for 3
Completing Train Step at 12th epoch...
At time: 34.06223511695862 accuracy is 0.965625 and loss is 0.07970123887062072
At time: 34.24155855178833 accuracy is 0.98125 and loss is 0.05683668851852417
At time: 34.42261624336243 accuracy is 0.984375 and loss is 0.042599660158157346
At time: 34.610435009002686 accuracy is 0.9546875 and loss is 0.12750495672225953
At time: 34.79434776306152 accuracy is 0.9828125 and loss is 0.034137049317359926
At time: 34.9782395362854 accuracy is 0.9875 and loss is 0.03999087512493134
At time: 35.164912700653076 accuracy is 0.9890625 and loss is 0.042547762393951416
At time: 35.350178480148315 accuracy is 0.990625 and loss is 0.044554075598716734
At time: 35.53872799873352 accuracy is 0.990625 and loss is 0.03233514130115509
At time: 35.72880148887634 accuracy is 0.978125 and loss is 0.04940138459205627
At time: 35.920405626297 accuracy is 0.9953125 and loss is 0.021985481679439544
At time: 36.11651825904846 accuracy is 0.9921875 and loss is 0.054600495100021365
Evaluating...
Done Evaluating: Achieved accuracy of 0.7332848837209303
Not better for 4
Completing Train Step at 13th epoch...
At time: 36.89761686325073 accuracy is 0.9875 and loss is 0.05017596483230591
At time: 37.08422327041626 accuracy is 0.9875 and loss is 0.04037072062492371
At time: 37.29047250747681 accuracy is 0.990625 and loss is 0.027787286043167114
At time: 37.49167227745056 accuracy is 0.9859375 and loss is 0.040687772631645205
At time: 37.696858167648315 accuracy is 0.996875 and loss is 0.013939307630062103
At time: 37.88896441459656 accuracy is 0.990625 and loss is 0.03792615532875061
At time: 38.088712215423584 accuracy is 0.99375 and loss is 0.024192845821380614
At time: 38.28092074394226 accuracy is 0.9734375 and loss is 0.06742362976074219
At time: 38.47140598297119 accuracy is 0.990625 and loss is 0.020729748904705046
At time: 38.66509532928467 accuracy is 0.9921875 and loss is 0.02980773150920868
At time: 38.859949350357056 accuracy is 0.990625 and loss is 0.027496609091758727
At time: 39.05893421173096 accuracy is 0.9875 and loss is 0.03351022899150848
Evaluating...
Done Evaluating: Achieved accuracy of 0.7347383720930233
Not better for 5
Completing Train Step at 14th epoch...
At time: 39.80932903289795 accuracy is 0.9828125 and loss is 0.04783454835414887
At time: 39.98657584190369 accuracy is 0.9921875 and loss is 0.029185569286346434
At time: 40.16727614402771 accuracy is 0.98125 and loss is 0.049411439895629884
At time: 40.350027561187744 accuracy is 0.9859375 and loss is 0.05008102655410766
At time: 40.53610062599182 accuracy is 0.9875 and loss is 0.04201468825340271
At time: 40.72226047515869 accuracy is 0.9875 and loss is 0.049999409914016725
At time: 40.908191442489624 accuracy is 0.984375 and loss is 0.05248040556907654
At time: 41.09721636772156 accuracy is 0.9921875 and loss is 0.035111653804779056
At time: 41.288859844207764 accuracy is 0.99375 and loss is 0.023272007703781128
At time: 41.47944641113281 accuracy is 0.996875 and loss is 0.008119481801986694
At time: 41.6748251914978 accuracy is 0.99375 and loss is 0.024427005648612977
At time: 41.873079776763916 accuracy is 0.9765625 and loss is 0.09166460037231446
Evaluating...
Done Evaluating: Achieved accuracy of 0.7423691860465116
Not better for 6
Completing Train Step at 15th epoch...
At time: 42.62596869468689 accuracy is 0.9875 and loss is 0.04658747911453247
At time: 42.804681062698364 accuracy is 0.9953125 and loss is 0.019866254925727845
At time: 42.984224796295166 accuracy is 0.9953125 and loss is 0.014019453525543213
At time: 43.16919493675232 accuracy is 0.99375 and loss is 0.016985182464122773
At time: 43.35301375389099 accuracy is 0.9890625 and loss is 0.030559587478637695
At time: 43.53774428367615 accuracy is 0.9890625 and loss is 0.05365031957626343
At time: 43.72515416145325 accuracy is 0.984375 and loss is 0.04038836061954498
At time: 43.91338062286377 accuracy is 0.9828125 and loss is 0.05710465312004089
At time: 44.10621929168701 accuracy is 0.9890625 and loss is 0.022512446343898772
At time: 44.29787015914917 accuracy is 0.9875 and loss is 0.037788611650466916
At time: 44.493802309036255 accuracy is 0.9921875 and loss is 0.022704622149467467
At time: 44.69250226020813 accuracy is 0.9890625 and loss is 0.031621497869491574
Evaluating...
Done Evaluating: Achieved accuracy of 0.7245639534883721
Not better for 7
Completing Train Step at 16th epoch...
At time: 45.440473556518555 accuracy is 0.9875 and loss is 0.0383267343044281
At time: 45.61918544769287 accuracy is 0.9859375 and loss is 0.04204017817974091
At time: 45.80252122879028 accuracy is 0.9828125 and loss is 0.04990090131759643
At time: 45.98564386367798 accuracy is 0.9921875 and loss is 0.02881898283958435
At time: 46.16946077346802 accuracy is 0.990625 and loss is 0.019962233304977418
At time: 46.355015993118286 accuracy is 0.9890625 and loss is 0.03811931610107422
At time: 46.5415620803833 accuracy is 0.9921875 and loss is 0.019937705993652344
At time: 46.72892498970032 accuracy is 0.9921875 and loss is 0.03212226033210754
At time: 46.92055869102478 accuracy is 0.9890625 and loss is 0.033743548393249514
At time: 47.113277196884155 accuracy is 0.984375 and loss is 0.04195747971534729
At time: 47.31013321876526 accuracy is 0.9875 and loss is 0.06481186747550964
At time: 47.51077723503113 accuracy is 0.98125 and loss is 0.09756559133529663
Evaluating...
Done Evaluating: Achieved accuracy of 0.7176598837209303
Not better for 8
Completing Train Step at 17th epoch...
At time: 48.275126457214355 accuracy is 0.990625 and loss is 0.039686942100524904
At time: 48.45300483703613 accuracy is 0.99375 and loss is 0.02157343178987503
At time: 48.633992195129395 accuracy is 0.9921875 and loss is 0.039135193824768065
At time: 48.81715178489685 accuracy is 0.9921875 and loss is 0.01651735007762909
At time: 49.00118350982666 accuracy is 0.99375 and loss is 0.018068546056747438
At time: 49.186612129211426 accuracy is 0.9953125 and loss is 0.023426267504692077
At time: 49.3749566078186 accuracy is 0.9984375 and loss is 0.008236011862754822
At time: 49.56994938850403 accuracy is 0.99375 and loss is 0.020504581928253173
At time: 49.76504421234131 accuracy is 0.9859375 and loss is 0.037502181529998777
At time: 49.958651542663574 accuracy is 0.9921875 and loss is 0.016578838229179382
At time: 50.154391288757324 accuracy is 0.984375 and loss is 0.09307059049606323
At time: 50.35340213775635 accuracy is 0.98125 and loss is 0.05979081988334656
Evaluating...
Done Evaluating: Achieved accuracy of 0.7274709302325582
Not better for 9
Completing Train Step at 18th epoch...
At time: 51.10367035865784 accuracy is 0.990625 and loss is 0.026474106311798095
At time: 51.282583475112915 accuracy is 0.9921875 and loss is 0.02118649482727051
At time: 51.46262001991272 accuracy is 0.9921875 and loss is 0.01845783293247223
At time: 51.6457359790802 accuracy is 0.990625 and loss is 0.04518956243991852
At time: 51.8291699886322 accuracy is 0.9890625 and loss is 0.031855246424674986
At time: 52.0149986743927 accuracy is 0.9953125 and loss is 0.01717294454574585
At time: 52.202946186065674 accuracy is 0.9921875 and loss is 0.03119230568408966
At time: 52.39125871658325 accuracy is 0.99375 and loss is 0.023777611553668976
At time: 52.582104206085205 accuracy is 0.9859375 and loss is 0.050558042526245114
At time: 52.774943828582764 accuracy is 0.9953125 and loss is 0.017977069318294524
At time: 52.971081018447876 accuracy is 0.9984375 and loss is 0.0170360267162323
At time: 53.17217946052551 accuracy is 0.9859375 and loss is 0.03804101347923279
Evaluating...
Done Evaluating: Achieved accuracy of 0.7401889534883721
Not better for 10
Model not improving. Stopping earlyat 0.7449127906976745 epochs.
Done Training. Achieved Best Accuracy of 0.7449127906976745
mlpattn
SETTINGS FOR THIS RUN
{'dropout': 0.8723363041233845, 'rnn_dropout': 0.47982211611021597, 'attn_type': 'MLP', 'attention_dim': 52, 'tune_wordvecs': True, 'wordvec_source': 'google', 'lr': 0.004262641604255246, 'batch_size': 32, 'l2': 0.9418586392421565, 'num_layers': 1, 'data': 'MPQA', 'wordvec_dim': 300}
Using CUDA!
here
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['googlenews']
Getting google news vectors
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fa7e9579978>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'vocab_size': 15284, 'dropout': 0.8723363041233845, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'attention_dim': 52, 'cuda': True, 'tune_attn': 'True', 'input_size': 300, 'attn_type': 'MLP', 'num_classes': 2, 'batch_size': 32, 'hidden_size': 300, 'num_layers': 1, 'rnn_dropout': 0.47982211611021597, 'train_word_vecs': True}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.20797109603881836 accuracy is 0.5640625 and loss is 0.7298041820526123
At time: 0.3923490047454834 accuracy is 0.459375 and loss is 1.0060333251953124
At time: 0.5758907794952393 accuracy is 0.5 and loss is 0.8791303634643555
At time: 0.7584378719329834 accuracy is 0.55625 and loss is 0.6858349323272706
At time: 0.9423761367797852 accuracy is 0.54375 and loss is 0.72305908203125
At time: 1.1277916431427002 accuracy is 0.6 and loss is 0.6658905029296875
At time: 1.3159968852996826 accuracy is 0.6390625 and loss is 0.6224266052246094
At time: 1.505730390548706 accuracy is 0.63125 and loss is 0.6369112014770508
At time: 1.697638750076294 accuracy is 0.68125 and loss is 0.6418183803558349
At time: 1.8910324573516846 accuracy is 0.6578125 and loss is 0.6030412673950195
At time: 2.0882506370544434 accuracy is 0.7109375 and loss is 0.5579195499420166
At time: 2.2927405834198 accuracy is 0.7265625 and loss is 0.547468614578247
Evaluating...
Done Evaluating: Achieved accuracy of 0.7747093023255814
Achieved new best!
Completing Train Step at 1th epoch...
At time: 3.0810189247131348 accuracy is 0.740625 and loss is 0.6299720764160156
At time: 3.264246940612793 accuracy is 0.6953125 and loss is 0.5519811153411865
At time: 3.4520554542541504 accuracy is 0.7765625 and loss is 0.4973145008087158
At time: 3.635711431503296 accuracy is 0.7609375 and loss is 0.4972228527069092
At time: 3.821655750274658 accuracy is 0.784375 and loss is 0.4735120296478271
At time: 4.007937669754028 accuracy is 0.840625 and loss is 0.38240752220153806
At time: 4.19667387008667 accuracy is 0.815625 and loss is 0.4383874416351318
At time: 4.38491415977478 accuracy is 0.8375 and loss is 0.3986448049545288
At time: 4.575640439987183 accuracy is 0.8234375 and loss is 0.403291654586792
At time: 4.767872333526611 accuracy is 0.8390625 and loss is 0.4151721954345703
At time: 4.964840888977051 accuracy is 0.8171875 and loss is 0.42608108520507815
At time: 5.165623188018799 accuracy is 0.8234375 and loss is 0.43411688804626464
Evaluating...
Done Evaluating: Achieved accuracy of 0.7162063953488372
Not better for 1
Completing Train Step at 2th epoch...
At time: 5.9197328090667725 accuracy is 0.8609375 and loss is 0.43663434982299804
At time: 6.098624229431152 accuracy is 0.91875 and loss is 0.20019710063934326
At time: 6.280881881713867 accuracy is 0.88125 and loss is 0.3712364912033081
At time: 6.464767694473267 accuracy is 0.8671875 and loss is 0.3827848434448242
At time: 6.648430109024048 accuracy is 0.846875 and loss is 0.35941314697265625
At time: 6.834585905075073 accuracy is 0.875 and loss is 0.29258003234863283
At time: 7.023170471191406 accuracy is 0.875 and loss is 0.3335575580596924
At time: 7.2126030921936035 accuracy is 0.8703125 and loss is 0.3528773784637451
At time: 7.404739618301392 accuracy is 0.8671875 and loss is 0.33788959980010985
At time: 7.597008943557739 accuracy is 0.8734375 and loss is 0.3235157489776611
At time: 7.792438983917236 accuracy is 0.8765625 and loss is 0.30902695655822754
At time: 7.9917991161346436 accuracy is 0.9140625 and loss is 0.23362884521484376
Evaluating...
Done Evaluating: Achieved accuracy of 0.7536337209302325
Not better for 2
Completing Train Step at 3th epoch...
At time: 8.744908571243286 accuracy is 0.8421875 and loss is 0.3945854663848877
At time: 8.923750877380371 accuracy is 0.9046875 and loss is 0.22401797771453857
At time: 9.106261014938354 accuracy is 0.934375 and loss is 0.17080408334732056
At time: 9.290167808532715 accuracy is 0.91875 and loss is 0.25341067314147947
At time: 9.475953817367554 accuracy is 0.8796875 and loss is 0.31362593173980713
At time: 9.664722442626953 accuracy is 0.9265625 and loss is 0.20547800064086913
At time: 9.853292465209961 accuracy is 0.9265625 and loss is 0.21086230278015136
At time: 10.042064428329468 accuracy is 0.9265625 and loss is 0.17657798528671265
At time: 10.23395562171936 accuracy is 0.93125 and loss is 0.1897689461708069
At time: 10.42699146270752 accuracy is 0.921875 and loss is 0.215256929397583
At time: 10.624014377593994 accuracy is 0.93125 and loss is 0.17738422155380248
At time: 10.823927879333496 accuracy is 0.9078125 and loss is 0.2737683534622192
Evaluating...
Done Evaluating: Achieved accuracy of 0.7296511627906976
Not better for 3
Completing Train Step at 4th epoch...
At time: 11.577767133712769 accuracy is 0.9203125 and loss is 0.25275654792785646
At time: 11.75662112236023 accuracy is 0.9515625 and loss is 0.14085726737976073
At time: 11.939306735992432 accuracy is 0.95 and loss is 0.13656892776489257
At time: 12.128652572631836 accuracy is 0.9171875 and loss is 0.2206275701522827
At time: 12.312542200088501 accuracy is 0.928125 and loss is 0.20039598941802977
At time: 12.498653411865234 accuracy is 0.9359375 and loss is 0.1522396445274353
At time: 12.687117576599121 accuracy is 0.93125 and loss is 0.19718128442764282
At time: 12.875716924667358 accuracy is 0.9515625 and loss is 0.1291130304336548
At time: 13.06639051437378 accuracy is 0.9390625 and loss is 0.1697956681251526
At time: 13.259081840515137 accuracy is 0.9234375 and loss is 0.20381560325622558
At time: 13.45460295677185 accuracy is 0.925 and loss is 0.20213072299957274
At time: 13.6532883644104 accuracy is 0.9296875 and loss is 0.17383852005004882
Evaluating...
Done Evaluating: Achieved accuracy of 0.7005813953488372
Not better for 4
Completing Train Step at 5th epoch...
At time: 14.407907009124756 accuracy is 0.909375 and loss is 0.23540167808532714
At time: 14.585915088653564 accuracy is 0.9484375 and loss is 0.1702585220336914
At time: 14.767382621765137 accuracy is 0.946875 and loss is 0.1255743145942688
At time: 14.951664209365845 accuracy is 0.9359375 and loss is 0.16351137161254883
At time: 15.136658430099487 accuracy is 0.93125 and loss is 0.19112993478775026
At time: 15.325241327285767 accuracy is 0.946875 and loss is 0.13236693143844605
At time: 15.512116193771362 accuracy is 0.9375 and loss is 0.17135720252990722
At time: 15.7005033493042 accuracy is 0.9625 and loss is 0.09611421823501587
At time: 15.892011880874634 accuracy is 0.934375 and loss is 0.17264679670333863
At time: 16.0847647190094 accuracy is 0.9390625 and loss is 0.18098174333572387
At time: 16.280143976211548 accuracy is 0.940625 and loss is 0.1841801643371582
At time: 16.47981309890747 accuracy is 0.9265625 and loss is 0.18020714521408082
Evaluating...
Done Evaluating: Achieved accuracy of 0.7263808139534884
Not better for 5
Completing Train Step at 6th epoch...
At time: 17.234055995941162 accuracy is 0.9203125 and loss is 0.2133110284805298
At time: 17.41249990463257 accuracy is 0.946875 and loss is 0.14286928176879882
At time: 17.592742443084717 accuracy is 0.9703125 and loss is 0.08538127541542054
At time: 17.775646924972534 accuracy is 0.9375 and loss is 0.1572888731956482
At time: 17.959137678146362 accuracy is 0.9546875 and loss is 0.13305974006652832
At time: 18.145800828933716 accuracy is 0.9390625 and loss is 0.12672394514083862
At time: 18.334097623825073 accuracy is 0.9484375 and loss is 0.13934195041656494
At time: 18.52271056175232 accuracy is 0.9609375 and loss is 0.10136176347732544
At time: 18.714074850082397 accuracy is 0.93125 and loss is 0.2446758270263672
At time: 18.906715631484985 accuracy is 0.9453125 and loss is 0.15831964015960692
At time: 19.103038549423218 accuracy is 0.94375 and loss is 0.14858944416046144
At time: 19.302727222442627 accuracy is 0.946875 and loss is 0.16603919267654418
Evaluating...
Done Evaluating: Achieved accuracy of 0.7042151162790697
Not better for 6
Completing Train Step at 7th epoch...
At time: 20.061216831207275 accuracy is 0.9078125 and loss is 0.24838583469390868
At time: 20.240269660949707 accuracy is 0.93125 and loss is 0.16131834983825682
At time: 20.42103886604309 accuracy is 0.946875 and loss is 0.13171924352645875
At time: 20.60314130783081 accuracy is 0.95 and loss is 0.1218879222869873
At time: 20.78638744354248 accuracy is 0.953125 and loss is 0.12374536991119385
At time: 20.97215461730957 accuracy is 0.959375 and loss is 0.09193661212921142
At time: 21.159248113632202 accuracy is 0.959375 and loss is 0.098039048910141
At time: 21.347816944122314 accuracy is 0.9578125 and loss is 0.09175684452056884
At time: 21.539845943450928 accuracy is 0.9390625 and loss is 0.1959148645401001
At time: 21.732590198516846 accuracy is 0.9546875 and loss is 0.10628029108047485
At time: 21.929359436035156 accuracy is 0.95 and loss is 0.1359858751296997
At time: 22.130043506622314 accuracy is 0.946875 and loss is 0.15789618492126464
Evaluating...
Done Evaluating: Achieved accuracy of 0.7361918604651163
Not better for 7
Completing Train Step at 8th epoch...
At time: 22.8845796585083 accuracy is 0.9203125 and loss is 0.20911495685577391
At time: 23.06409215927124 accuracy is 0.94375 and loss is 0.1391968011856079
At time: 23.245303630828857 accuracy is 0.946875 and loss is 0.12196754217147827
At time: 23.42952251434326 accuracy is 0.94375 and loss is 0.13808655738830566
At time: 23.61553692817688 accuracy is 0.95625 and loss is 0.11182830333709717
At time: 23.80094861984253 accuracy is 0.971875 and loss is 0.08181003332138062
At time: 23.98869824409485 accuracy is 0.975 and loss is 0.06901919841766357
At time: 24.177398920059204 accuracy is 0.971875 and loss is 0.08788820505142211
At time: 24.368408679962158 accuracy is 0.9515625 and loss is 0.15546470880508423
At time: 24.566739797592163 accuracy is 0.95625 and loss is 0.126333487033844
At time: 24.76242160797119 accuracy is 0.9671875 and loss is 0.0842237114906311
At time: 24.962435722351074 accuracy is 0.959375 and loss is 0.11363818645477294
Evaluating...
Done Evaluating: Achieved accuracy of 0.721656976744186
Not better for 8
Completing Train Step at 9th epoch...
At time: 25.716909408569336 accuracy is 0.940625 and loss is 0.1664653778076172
At time: 25.895363569259644 accuracy is 0.9515625 and loss is 0.0949785828590393
At time: 26.0769624710083 accuracy is 0.9640625 and loss is 0.11301920413970948
At time: 26.25977063179016 accuracy is 0.9703125 and loss is 0.07573637366294861
At time: 26.44364023208618 accuracy is 0.953125 and loss is 0.13612947463989258
At time: 26.63167452812195 accuracy is 0.9703125 and loss is 0.10577707290649414
At time: 26.81889533996582 accuracy is 0.9796875 and loss is 0.05278158187866211
At time: 27.007352352142334 accuracy is 0.9765625 and loss is 0.07070987820625305
At time: 27.203770399093628 accuracy is 0.9609375 and loss is 0.14038267135620117
At time: 27.395869255065918 accuracy is 0.975 and loss is 0.06769049763679505
At time: 27.592512369155884 accuracy is 0.95 and loss is 0.1480668306350708
At time: 27.791945934295654 accuracy is 0.95 and loss is 0.13820605278015136
Evaluating...
Done Evaluating: Achieved accuracy of 0.7307412790697675
Not better for 9
Completing Train Step at 10th epoch...
At time: 28.544974088668823 accuracy is 0.940625 and loss is 0.17578119039535522
At time: 28.723729133605957 accuracy is 0.9421875 and loss is 0.11670409440994263
At time: 28.90506863594055 accuracy is 0.946875 and loss is 0.1466930627822876
At time: 29.089051961898804 accuracy is 0.959375 and loss is 0.11763948202133179
At time: 29.274169206619263 accuracy is 0.953125 and loss is 0.10904154777526856
At time: 29.462097644805908 accuracy is 0.9546875 and loss is 0.12498968839645386
At time: 29.650762796401978 accuracy is 0.9875 and loss is 0.05036325454711914
At time: 29.839364767074585 accuracy is 0.971875 and loss is 0.0748157560825348
At time: 30.03087329864502 accuracy is 0.9609375 and loss is 0.11897866725921631
At time: 30.223341464996338 accuracy is 0.978125 and loss is 0.06992214322090148
At time: 30.418957471847534 accuracy is 0.9765625 and loss is 0.0710709273815155
At time: 30.619633674621582 accuracy is 0.953125 and loss is 0.16028716564178466
Evaluating...
Done Evaluating: Achieved accuracy of 0.7249273255813954
Not better for 10
Model not improving. Stopping earlyat 0.7747093023255814 epochs.
Done Training. Achieved Best Accuracy of 0.7747093023255814
Improved accuracyfrom 0.7721656976744186 to 0.7747093023255814
mlpattn
SETTINGS FOR THIS RUN
{'dropout': 0.44545534050587865, 'rnn_dropout': 0.659908117304293, 'attn_type': 'MLP', 'attention_dim': 59, 'tune_wordvecs': True, 'wordvec_source': 'google', 'lr': 0.0013159826367545287, 'batch_size': 32, 'l2': 0.22820801870069085, 'num_layers': 1, 'data': 'MPQA', 'wordvec_dim': 300}
Using CUDA!
here
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['googlenews']
Getting google news vectors
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fa8401ed4a8>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'vocab_size': 15284, 'dropout': 0.44545534050587865, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'attention_dim': 59, 'cuda': True, 'tune_attn': 'True', 'input_size': 300, 'attn_type': 'MLP', 'num_classes': 2, 'batch_size': 32, 'hidden_size': 300, 'num_layers': 1, 'rnn_dropout': 0.659908117304293, 'train_word_vecs': True}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.19964170455932617 accuracy is 0.5546875 and loss is 0.7295735836029053
At time: 0.3788011074066162 accuracy is 0.559375 and loss is 0.6828930377960205
At time: 0.5604043006896973 accuracy is 0.596875 and loss is 0.663687801361084
At time: 0.7440297603607178 accuracy is 0.6125 and loss is 0.6720280647277832
At time: 0.929246187210083 accuracy is 0.68125 and loss is 0.6053520679473877
At time: 1.118931770324707 accuracy is 0.734375 and loss is 0.5618327140808106
At time: 1.3083622455596924 accuracy is 0.7484375 and loss is 0.5297247409820557
At time: 1.4985520839691162 accuracy is 0.771875 and loss is 0.5149358749389649
At time: 1.690708875656128 accuracy is 0.73125 and loss is 0.5245776176452637
At time: 1.8846611976623535 accuracy is 0.75625 and loss is 0.5135577201843262
At time: 2.081408739089966 accuracy is 0.7859375 and loss is 0.49443650245666504
At time: 2.282299041748047 accuracy is 0.7625 and loss is 0.4838193416595459
Evaluating...
Done Evaluating: Achieved accuracy of 0.7332848837209303
Achieved new best!
Completing Train Step at 1th epoch...
At time: 3.056173324584961 accuracy is 0.7734375 and loss is 0.5580838203430176
At time: 3.239292621612549 accuracy is 0.828125 and loss is 0.3785531044006348
At time: 3.430704355239868 accuracy is 0.8390625 and loss is 0.3890403985977173
At time: 3.622213840484619 accuracy is 0.8265625 and loss is 0.3983548641204834
At time: 3.811182737350464 accuracy is 0.8375 and loss is 0.3303666353225708
At time: 3.999983787536621 accuracy is 0.925 and loss is 0.21741023063659667
At time: 4.187266826629639 accuracy is 0.9203125 and loss is 0.18817998170852662
At time: 4.376128673553467 accuracy is 0.8953125 and loss is 0.27227737903594973
At time: 4.567500829696655 accuracy is 0.859375 and loss is 0.3343033313751221
At time: 4.764421224594116 accuracy is 0.8578125 and loss is 0.3474344491958618
At time: 4.961284399032593 accuracy is 0.8734375 and loss is 0.28651421070098876
At time: 5.160891056060791 accuracy is 0.896875 and loss is 0.24884421825408937
Evaluating...
Done Evaluating: Achieved accuracy of 0.7768895348837209
Achieved new best!
Completing Train Step at 2th epoch...
At time: 5.915762662887573 accuracy is 0.84375 and loss is 0.44258828163146974
At time: 6.0925774574279785 accuracy is 0.909375 and loss is 0.2125472068786621
At time: 6.2718658447265625 accuracy is 0.9109375 and loss is 0.21874759197235108
At time: 6.451789140701294 accuracy is 0.9234375 and loss is 0.19401441812515258
At time: 6.630807876586914 accuracy is 0.93125 and loss is 0.16611316204071044
At time: 6.818703889846802 accuracy is 0.95625 and loss is 0.12504173517227174
At time: 7.021696329116821 accuracy is 0.9296875 and loss is 0.15685317516326905
At time: 7.211958408355713 accuracy is 0.9515625 and loss is 0.12262876033782959
At time: 7.4024882316589355 accuracy is 0.9421875 and loss is 0.15125041007995604
At time: 7.594540357589722 accuracy is 0.9125 and loss is 0.19115349054336547
At time: 7.791173219680786 accuracy is 0.9265625 and loss is 0.19250699281692504
At time: 7.992221355438232 accuracy is 0.94375 and loss is 0.15260567665100097
Evaluating...
Done Evaluating: Achieved accuracy of 0.7547238372093024
Not better for 1
Completing Train Step at 3th epoch...
At time: 8.751006841659546 accuracy is 0.890625 and loss is 0.3076687574386597
At time: 8.930244445800781 accuracy is 0.946875 and loss is 0.1298839807510376
At time: 9.112839698791504 accuracy is 0.9390625 and loss is 0.16444182395935059
At time: 9.297508955001831 accuracy is 0.9828125 and loss is 0.06167464852333069
At time: 9.48189115524292 accuracy is 0.9390625 and loss is 0.1313961148262024
At time: 9.66696310043335 accuracy is 0.975 and loss is 0.0646138310432434
At time: 9.855399370193481 accuracy is 0.9625 and loss is 0.09982678890228272
At time: 10.044669151306152 accuracy is 0.975 and loss is 0.0744429349899292
At time: 10.237515926361084 accuracy is 0.98125 and loss is 0.045080149173736574
At time: 10.431685447692871 accuracy is 0.9421875 and loss is 0.1857057809829712
At time: 10.628602266311646 accuracy is 0.921875 and loss is 0.21249516010284425
At time: 10.828977346420288 accuracy is 0.9609375 and loss is 0.1210989236831665
Evaluating...
Done Evaluating: Achieved accuracy of 0.7481831395348837
Not better for 2
Completing Train Step at 4th epoch...
At time: 11.5880868434906 accuracy is 0.934375 and loss is 0.1992543578147888
At time: 11.766639232635498 accuracy is 0.971875 and loss is 0.06365522146224975
At time: 11.949573278427124 accuracy is 0.965625 and loss is 0.11794277429580688
At time: 12.132665634155273 accuracy is 0.971875 and loss is 0.06695832014083862
At time: 12.318535566329956 accuracy is 0.946875 and loss is 0.166237473487854
At time: 12.50536823272705 accuracy is 0.98125 and loss is 0.0467466801404953
At time: 12.69258999824524 accuracy is 0.9890625 and loss is 0.037251603603363034
At time: 12.881058692932129 accuracy is 0.9890625 and loss is 0.03989761173725128
At time: 13.072816848754883 accuracy is 0.9796875 and loss is 0.06620174646377563
At time: 13.266088962554932 accuracy is 0.9734375 and loss is 0.07039127349853516
At time: 13.463158369064331 accuracy is 0.9625 and loss is 0.09762208461761475
At time: 13.662868976593018 accuracy is 0.98125 and loss is 0.05057798027992248
Evaluating...
Done Evaluating: Achieved accuracy of 0.7380087209302325
Not better for 3
Completing Train Step at 5th epoch...
At time: 14.421877145767212 accuracy is 0.9515625 and loss is 0.15496500730514526
At time: 14.59964919090271 accuracy is 0.98125 and loss is 0.0554847240447998
At time: 14.782366037368774 accuracy is 0.9765625 and loss is 0.07252423167228698
At time: 14.966614007949829 accuracy is 0.978125 and loss is 0.06060516834259033
At time: 15.151633262634277 accuracy is 0.984375 and loss is 0.05509335994720459
At time: 15.339522123336792 accuracy is 0.9875 and loss is 0.022307905554771423
At time: 15.52766728401184 accuracy is 0.990625 and loss is 0.02970802187919617
At time: 15.715829610824585 accuracy is 0.9859375 and loss is 0.02760235071182251
At time: 15.906683921813965 accuracy is 0.9828125 and loss is 0.03993028104305267
At time: 16.099159002304077 accuracy is 0.9828125 and loss is 0.04213859140872955
At time: 16.29514765739441 accuracy is 0.98125 and loss is 0.046790337562561034
At time: 16.494060277938843 accuracy is 0.9796875 and loss is 0.06247148513793945
Evaluating...
Done Evaluating: Achieved accuracy of 0.747093023255814
Not better for 4
Completing Train Step at 6th epoch...
At time: 17.249751329421997 accuracy is 0.9265625 and loss is 0.18726186752319335
At time: 17.429088830947876 accuracy is 0.9625 and loss is 0.10599619150161743
At time: 17.610646724700928 accuracy is 0.978125 and loss is 0.05576122999191284
At time: 17.795075178146362 accuracy is 0.9765625 and loss is 0.094629967212677
At time: 17.979567289352417 accuracy is 0.9734375 and loss is 0.09669463038444519
At time: 18.16645121574402 accuracy is 0.9765625 and loss is 0.06822290420532226
At time: 18.355364084243774 accuracy is 0.9796875 and loss is 0.06142925620079041
At time: 18.54523205757141 accuracy is 0.9765625 and loss is 0.06585855484008789
At time: 18.73766016960144 accuracy is 0.9796875 and loss is 0.05639651417732239
At time: 18.93116593360901 accuracy is 0.971875 and loss is 0.06193886399269104
At time: 19.128453254699707 accuracy is 0.978125 and loss is 0.05949471592903137
At time: 19.32990574836731 accuracy is 0.9734375 and loss is 0.12492282390594482
Evaluating...
Done Evaluating: Achieved accuracy of 0.7496366279069767
Not better for 5
Completing Train Step at 7th epoch...
At time: 20.08564281463623 accuracy is 0.9625 and loss is 0.11962194442749023
At time: 20.264646291732788 accuracy is 0.98125 and loss is 0.06723026633262634
At time: 20.44662594795227 accuracy is 0.984375 and loss is 0.043169078230857846
At time: 20.630922555923462 accuracy is 0.9796875 and loss is 0.047221976518630984
At time: 20.81605100631714 accuracy is 0.9765625 and loss is 0.07846610546112061
At time: 21.002191305160522 accuracy is 0.9890625 and loss is 0.034260022640228274
At time: 21.19133448600769 accuracy is 0.990625 and loss is 0.02704703211784363
At time: 21.38100290298462 accuracy is 0.978125 and loss is 0.08063524961471558
At time: 21.572394132614136 accuracy is 0.9796875 and loss is 0.059762227535247806
At time: 21.76626491546631 accuracy is 0.9734375 and loss is 0.07005639672279358
At time: 21.964043140411377 accuracy is 0.9796875 and loss is 0.06131477952003479
At time: 22.163503885269165 accuracy is 0.990625 and loss is 0.06279516816139222
Evaluating...
Done Evaluating: Achieved accuracy of 0.7510901162790697
Not better for 6
Completing Train Step at 8th epoch...
At time: 22.91837763786316 accuracy is 0.9796875 and loss is 0.07076814174652099
At time: 23.097062349319458 accuracy is 0.99375 and loss is 0.022991245985031127
At time: 23.27874732017517 accuracy is 0.99375 and loss is 0.027364853024482726
At time: 23.46208620071411 accuracy is 0.9859375 and loss is 0.05006943941116333
At time: 23.64601707458496 accuracy is 0.9828125 and loss is 0.033233228325843814
At time: 23.832889795303345 accuracy is 0.9953125 and loss is 0.017223456501960756
At time: 24.021268606185913 accuracy is 0.9890625 and loss is 0.03334952890872955
At time: 24.21131467819214 accuracy is 0.9796875 and loss is 0.0642014741897583
At time: 24.40243363380432 accuracy is 0.9828125 and loss is 0.06276527643203736
At time: 24.594411611557007 accuracy is 0.9875 and loss is 0.028862512111663817
At time: 24.790899515151978 accuracy is 0.9765625 and loss is 0.06903521418571472
At time: 24.990051984786987 accuracy is 0.9921875 and loss is 0.028703007102012634
Evaluating...
Done Evaluating: Achieved accuracy of 0.7285610465116279
Not better for 7
Completing Train Step at 9th epoch...
At time: 25.748133420944214 accuracy is 0.9703125 and loss is 0.10145000219345093
At time: 25.92817187309265 accuracy is 0.9796875 and loss is 0.07110298275947571
At time: 26.109002590179443 accuracy is 0.9859375 and loss is 0.03730314373970032
At time: 26.29342007637024 accuracy is 0.9796875 and loss is 0.06524494290351868
At time: 26.4798367023468 accuracy is 0.9828125 and loss is 0.06441102623939514
At time: 26.668803215026855 accuracy is 0.9875 and loss is 0.02744717597961426
At time: 26.85755729675293 accuracy is 0.9859375 and loss is 0.04307110011577606
At time: 27.04760241508484 accuracy is 0.9703125 and loss is 0.10064064264297486
At time: 27.238789319992065 accuracy is 0.9796875 and loss is 0.07866237163543702
At time: 27.431559324264526 accuracy is 0.99375 and loss is 0.02086057811975479
At time: 27.628246307373047 accuracy is 0.9859375 and loss is 0.056512534618377686
At time: 27.82794213294983 accuracy is 0.9921875 and loss is 0.051848596334457396
Evaluating...
Done Evaluating: Achieved accuracy of 0.7387354651162791
Not better for 8
Completing Train Step at 10th epoch...
At time: 28.58648920059204 accuracy is 0.9765625 and loss is 0.07044676542282105
At time: 28.765548944473267 accuracy is 0.984375 and loss is 0.05317874550819397
At time: 28.947197437286377 accuracy is 0.9875 and loss is 0.04643765985965729
At time: 29.129966497421265 accuracy is 0.9859375 and loss is 0.039834526181221006
At time: 29.314735651016235 accuracy is 0.9984375 and loss is 0.02236301451921463
At time: 29.504314661026 accuracy is 0.971875 and loss is 0.06534132957458497
At time: 29.69170618057251 accuracy is 0.9859375 and loss is 0.03322285115718841
At time: 29.88899827003479 accuracy is 0.9734375 and loss is 0.06415305733680725
At time: 30.096620082855225 accuracy is 0.990625 and loss is 0.024906331300735475
At time: 30.292629957199097 accuracy is 0.996875 and loss is 0.009775158762931824
At time: 30.50057601928711 accuracy is 0.9875 and loss is 0.040437906980514526
At time: 30.701369524002075 accuracy is 0.9875 and loss is 0.051197397708892825
Evaluating...
Done Evaluating: Achieved accuracy of 0.7340116279069767
Not better for 9
Completing Train Step at 11th epoch...
At time: 31.460782051086426 accuracy is 0.984375 and loss is 0.04957452714443207
At time: 31.638471126556396 accuracy is 0.99375 and loss is 0.015489917993545533
At time: 31.8197021484375 accuracy is 0.9953125 and loss is 0.021997737884521484
At time: 32.00225591659546 accuracy is 0.996875 and loss is 0.014327724277973176
At time: 32.185911893844604 accuracy is 0.9984375 and loss is 0.012264678627252579
At time: 32.37171459197998 accuracy is 0.9953125 and loss is 0.011404216289520264
At time: 32.55910015106201 accuracy is 0.990625 and loss is 0.04215286672115326
At time: 32.74966073036194 accuracy is 0.96875 and loss is 0.14879367351531983
At time: 32.941017389297485 accuracy is 0.9828125 and loss is 0.0657278060913086
At time: 33.13448691368103 accuracy is 0.98125 and loss is 0.08591594696044921
At time: 33.33077573776245 accuracy is 0.9765625 and loss is 0.08195582628250123
At time: 33.531365394592285 accuracy is 0.9875 and loss is 0.06023170351982117
Evaluating...
Done Evaluating: Achieved accuracy of 0.7307412790697675
Not better for 10
Model not improving. Stopping earlyat 0.7768895348837209 epochs.
Done Training. Achieved Best Accuracy of 0.7768895348837209
Improved accuracyfrom 0.7747093023255814 to 0.7768895348837209
mlpattn
SETTINGS FOR THIS RUN
{'dropout': 0.013091619979159641, 'rnn_dropout': 0.3375839028408244, 'attn_type': 'MLP', 'attention_dim': 56, 'tune_wordvecs': True, 'wordvec_source': 'google', 'lr': 0.004694093862594737, 'batch_size': 32, 'l2': 0.45441157610190697, 'num_layers': 1, 'data': 'MPQA', 'wordvec_dim': 300}
Using CUDA!
here
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['googlenews']
Getting google news vectors
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fa7e419d400>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'vocab_size': 15284, 'dropout': 0.013091619979159641, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'attention_dim': 56, 'cuda': True, 'tune_attn': 'True', 'input_size': 300, 'attn_type': 'MLP', 'num_classes': 2, 'batch_size': 32, 'hidden_size': 300, 'num_layers': 1, 'rnn_dropout': 0.3375839028408244, 'train_word_vecs': True}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.20884251594543457 accuracy is 0.55625 and loss is 0.7296791076660156
At time: 0.392894983291626 accuracy is 0.5125 and loss is 0.7800397396087646
At time: 0.5782091617584229 accuracy is 0.5328125 and loss is 0.744950819015503
At time: 0.7635271549224854 accuracy is 0.5640625 and loss is 0.7336028099060059
At time: 0.9493191242218018 accuracy is 0.478125 and loss is 0.7686131954193115
At time: 1.137603521347046 accuracy is 0.5359375 and loss is 0.7641308307647705
At time: 1.326908826828003 accuracy is 0.490625 and loss is 0.8236684799194336
At time: 1.5178663730621338 accuracy is 0.5453125 and loss is 0.7095306396484375
At time: 1.7111585140228271 accuracy is 0.5796875 and loss is 0.7043405532836914
At time: 1.906113624572754 accuracy is 0.5828125 and loss is 0.6745311260223389
At time: 2.1029183864593506 accuracy is 0.659375 and loss is 0.6364753723144532
At time: 2.3046419620513916 accuracy is 0.565625 and loss is 0.6934152603149414
Evaluating...
Done Evaluating: Achieved accuracy of 0.5803052325581395
Achieved new best!
Completing Train Step at 1th epoch...
At time: 3.0724596977233887 accuracy is 0.6578125 and loss is 0.6728302001953125
At time: 3.2523539066314697 accuracy is 0.6328125 and loss is 0.6630369663238526
At time: 3.4357657432556152 accuracy is 0.6328125 and loss is 0.6555641651153564
At time: 3.620567798614502 accuracy is 0.6203125 and loss is 0.6907841682434082
At time: 3.806232452392578 accuracy is 0.6796875 and loss is 0.6080513000488281
At time: 3.9958388805389404 accuracy is 0.6375 and loss is 0.696950626373291
At time: 4.185444355010986 accuracy is 0.6875 and loss is 0.6049660682678223
At time: 4.377280235290527 accuracy is 0.6828125 and loss is 0.6495945453643799
At time: 4.570334196090698 accuracy is 0.7296875 and loss is 0.5599624156951905
At time: 4.763833045959473 accuracy is 0.7578125 and loss is 0.5313670635223389
At time: 4.961500644683838 accuracy is 0.7875 and loss is 0.4692996025085449
At time: 5.163829326629639 accuracy is 0.7625 and loss is 0.4993444442749023
Evaluating...
Done Evaluating: Achieved accuracy of 0.6922238372093024
Achieved new best!
Completing Train Step at 2th epoch...
At time: 5.926839590072632 accuracy is 0.8109375 and loss is 0.46970014572143554
At time: 6.107563018798828 accuracy is 0.86875 and loss is 0.3170534610748291
At time: 6.3006837368011475 accuracy is 0.8265625 and loss is 0.3837554693222046
At time: 6.485466003417969 accuracy is 0.73125 and loss is 0.5981675624847412
At time: 6.67077374458313 accuracy is 0.734375 and loss is 0.5997490406036377
At time: 6.858223915100098 accuracy is 0.7609375 and loss is 0.5015408039093018
At time: 7.047425270080566 accuracy is 0.7984375 and loss is 0.43265571594238283
At time: 7.238126754760742 accuracy is 0.8 and loss is 0.47745723724365235
At time: 7.43064284324646 accuracy is 0.825 and loss is 0.3786442279815674
At time: 7.624929904937744 accuracy is 0.84375 and loss is 0.40236053466796873
At time: 7.823258399963379 accuracy is 0.86875 and loss is 0.2929912805557251
At time: 8.025206327438354 accuracy is 0.834375 and loss is 0.4494650840759277
Evaluating...
Done Evaluating: Achieved accuracy of 0.7452761627906976
Achieved new best!
Completing Train Step at 3th epoch...
At time: 8.789455652236938 accuracy is 0.8828125 and loss is 0.39288017749786375
At time: 8.96940279006958 accuracy is 0.9265625 and loss is 0.19108139276504515
At time: 9.150553226470947 accuracy is 0.9109375 and loss is 0.22378120422363282
At time: 9.334662675857544 accuracy is 0.821875 and loss is 0.5336972236633301
At time: 9.524005889892578 accuracy is 0.8375 and loss is 0.34951019287109375
At time: 9.712554693222046 accuracy is 0.8140625 and loss is 0.40385589599609373
At time: 9.902727127075195 accuracy is 0.8734375 and loss is 0.3308634042739868
At time: 10.094478130340576 accuracy is 0.871875 and loss is 0.3315866708755493
At time: 10.288073062896729 accuracy is 0.86875 and loss is 0.3185060739517212
At time: 10.48209810256958 accuracy is 0.8578125 and loss is 0.3639049053192139
At time: 10.679899454116821 accuracy is 0.9140625 and loss is 0.2202293872833252
At time: 10.88190484046936 accuracy is 0.8890625 and loss is 0.26813199520111086
Evaluating...
Done Evaluating: Achieved accuracy of 0.7398255813953488
Not better for 1
Completing Train Step at 4th epoch...
At time: 11.64755916595459 accuracy is 0.853125 and loss is 0.31508052349090576
At time: 11.82753038406372 accuracy is 0.9546875 and loss is 0.13462657928466798
At time: 12.010153532028198 accuracy is 0.921875 and loss is 0.1921892762184143
At time: 12.194986820220947 accuracy is 0.9453125 and loss is 0.13855292797088622
At time: 12.380287885665894 accuracy is 0.8984375 and loss is 0.28505027294158936
At time: 12.56760573387146 accuracy is 0.875 and loss is 0.2958427667617798
At time: 12.757637977600098 accuracy is 0.8859375 and loss is 0.2651442766189575
At time: 12.94894003868103 accuracy is 0.909375 and loss is 0.24456329345703126
At time: 13.141449928283691 accuracy is 0.9234375 and loss is 0.21244261264801026
At time: 13.33512830734253 accuracy is 0.9203125 and loss is 0.20247442722320558
At time: 13.5380859375 accuracy is 0.946875 and loss is 0.15135660171508789
At time: 13.73978304862976 accuracy is 0.8796875 and loss is 0.3632097005844116
Evaluating...
Done Evaluating: Achieved accuracy of 0.7103924418604651
Not better for 2
Completing Train Step at 5th epoch...
At time: 14.498806238174438 accuracy is 0.91875 and loss is 0.24253199100494385
At time: 14.677683591842651 accuracy is 0.96875 and loss is 0.07574655413627625
At time: 14.860446691513062 accuracy is 0.975 and loss is 0.0733509361743927
At time: 15.044548988342285 accuracy is 0.9453125 and loss is 0.2014674425125122
At time: 15.231396436691284 accuracy is 0.921875 and loss is 0.22330753803253173
At time: 15.418148756027222 accuracy is 0.909375 and loss is 0.2699302911758423
At time: 15.60718059539795 accuracy is 0.9109375 and loss is 0.26138012409210204
At time: 15.798128843307495 accuracy is 0.90625 and loss is 0.2593675136566162
At time: 15.99046540260315 accuracy is 0.9484375 and loss is 0.14633482694625854
At time: 16.184752464294434 accuracy is 0.9546875 and loss is 0.12241616249084472
At time: 16.382556915283203 accuracy is 0.9578125 and loss is 0.1078460693359375
At time: 16.583656787872314 accuracy is 0.903125 and loss is 0.3520509719848633
Evaluating...
Done Evaluating: Achieved accuracy of 0.6813226744186046
Not better for 3
Completing Train Step at 6th epoch...
At time: 17.34565496444702 accuracy is 0.9265625 and loss is 0.18631839752197266
At time: 17.525172472000122 accuracy is 0.9453125 and loss is 0.15218050479888917
At time: 17.710445642471313 accuracy is 0.9765625 and loss is 0.07094216346740723
At time: 17.89547562599182 accuracy is 0.9625 and loss is 0.11809964179992676
At time: 18.080779552459717 accuracy is 0.9234375 and loss is 0.20055713653564453
At time: 18.268324851989746 accuracy is 0.9359375 and loss is 0.2051941156387329
At time: 18.458292484283447 accuracy is 0.9203125 and loss is 0.1932842254638672
At time: 18.64805841445923 accuracy is 0.9296875 and loss is 0.19017585515975952
At time: 18.841114044189453 accuracy is 0.9203125 and loss is 0.2057203769683838
At time: 19.03446340560913 accuracy is 0.95 and loss is 0.11310335397720336
At time: 19.232357025146484 accuracy is 0.9640625 and loss is 0.07822128534317016
At time: 19.43419647216797 accuracy is 0.9484375 and loss is 0.14063773155212403
Evaluating...
Done Evaluating: Achieved accuracy of 0.7140261627906976
Not better for 4
Completing Train Step at 7th epoch...
At time: 20.193277597427368 accuracy is 0.9328125 and loss is 0.20706734657287598
At time: 20.372853994369507 accuracy is 0.95625 and loss is 0.12678918838500977
At time: 20.555444717407227 accuracy is 0.9671875 and loss is 0.10187703371047974
At time: 20.740295886993408 accuracy is 0.9265625 and loss is 0.22172014713287352
At time: 20.925278186798096 accuracy is 0.9046875 and loss is 0.22199466228485107
At time: 21.112749099731445 accuracy is 0.9296875 and loss is 0.18039270639419555
At time: 21.301655769348145 accuracy is 0.946875 and loss is 0.15561189651489257
At time: 21.49114990234375 accuracy is 0.9421875 and loss is 0.14620664119720458
At time: 21.684117078781128 accuracy is 0.94375 and loss is 0.14849631786346434
At time: 21.87746238708496 accuracy is 0.9375 and loss is 0.13445345163345337
At time: 22.074389219284058 accuracy is 0.9296875 and loss is 0.19489330053329468
At time: 22.275259017944336 accuracy is 0.9375 and loss is 0.17213146686553954
Evaluating...
Done Evaluating: Achieved accuracy of 0.7263808139534884
Not better for 5
Completing Train Step at 8th epoch...
At time: 23.03703761100769 accuracy is 0.8984375 and loss is 0.2653354644775391
At time: 23.216797828674316 accuracy is 0.9421875 and loss is 0.17380863428115845
At time: 23.40165138244629 accuracy is 0.9546875 and loss is 0.13756493330001832
At time: 23.58637285232544 accuracy is 0.953125 and loss is 0.11938517093658448
At time: 23.77188491821289 accuracy is 0.928125 and loss is 0.17565789222717285
At time: 23.959811210632324 accuracy is 0.95 and loss is 0.12089759111404419
At time: 24.14900541305542 accuracy is 0.965625 and loss is 0.11619648933410645
At time: 24.33919668197632 accuracy is 0.9609375 and loss is 0.10603654384613037
At time: 24.53242540359497 accuracy is 0.95625 and loss is 0.14112635850906372
At time: 24.726115703582764 accuracy is 0.95625 and loss is 0.11818255186080932
At time: 24.924265384674072 accuracy is 0.965625 and loss is 0.08170579075813293
At time: 25.12614154815674 accuracy is 0.9546875 and loss is 0.1266043782234192
Evaluating...
Done Evaluating: Achieved accuracy of 0.7245639534883721
Not better for 6
Completing Train Step at 9th epoch...
At time: 25.887404441833496 accuracy is 0.9171875 and loss is 0.19320900440216066
At time: 26.06779456138611 accuracy is 0.9484375 and loss is 0.13971776962280275
At time: 26.25181531906128 accuracy is 0.9484375 and loss is 0.1632169008255005
At time: 26.435401678085327 accuracy is 0.9640625 and loss is 0.08991584777832032
At time: 26.62070369720459 accuracy is 0.94375 and loss is 0.1428816318511963
At time: 26.808046579360962 accuracy is 0.925 and loss is 0.19137004613876343
At time: 26.996784925460815 accuracy is 0.965625 and loss is 0.07227275371551514
At time: 27.185922384262085 accuracy is 0.975 and loss is 0.07631178498268128
At time: 27.3778338432312 accuracy is 0.959375 and loss is 0.11265907287597657
At time: 27.56767439842224 accuracy is 0.965625 and loss is 0.10227299928665161
At time: 27.770907640457153 accuracy is 0.9640625 and loss is 0.10527193546295166
At time: 27.976544857025146 accuracy is 0.9484375 and loss is 0.13676918745040895
Evaluating...
Done Evaluating: Achieved accuracy of 0.6998546511627907
Not better for 7
Completing Train Step at 10th epoch...
At time: 28.725690603256226 accuracy is 0.9375 and loss is 0.15718039274215698
At time: 28.90331745147705 accuracy is 0.95625 and loss is 0.12862051725387574
At time: 29.082833766937256 accuracy is 0.9734375 and loss is 0.07825801968574524
At time: 29.263667583465576 accuracy is 0.946875 and loss is 0.14637303352355957
At time: 29.446006774902344 accuracy is 0.9328125 and loss is 0.1591268301010132
At time: 29.62934923171997 accuracy is 0.95625 and loss is 0.08794777989387512
At time: 29.81429934501648 accuracy is 0.965625 and loss is 0.08319237232208251
At time: 30.00068688392639 accuracy is 0.9703125 and loss is 0.06609634757041931
At time: 30.189674377441406 accuracy is 0.9578125 and loss is 0.13691310882568358
At time: 30.380188465118408 accuracy is 0.965625 and loss is 0.09367092847824096
At time: 30.573350191116333 accuracy is 0.9671875 and loss is 0.12496480941772461
At time: 30.770424604415894 accuracy is 0.9328125 and loss is 0.23350086212158203
Evaluating...
Done Evaluating: Achieved accuracy of 0.7176598837209303
Not better for 8
Completing Train Step at 11th epoch...
At time: 31.510252952575684 accuracy is 0.953125 and loss is 0.12264403104782104
At time: 31.687712907791138 accuracy is 0.946875 and loss is 0.15643010139465333
At time: 31.87854504585266 accuracy is 0.95625 and loss is 0.12007116079330445
At time: 32.07739567756653 accuracy is 0.9671875 and loss is 0.08440731167793274
At time: 32.273855209350586 accuracy is 0.965625 and loss is 0.0834408938884735
At time: 32.47420597076416 accuracy is 0.9609375 and loss is 0.09593376517295837
At time: 32.678855419158936 accuracy is 0.9640625 and loss is 0.10436294078826905
At time: 32.888771533966064 accuracy is 0.975 and loss is 0.07469812631607056
At time: 33.09644150733948 accuracy is 0.9578125 and loss is 0.10518478155136109
At time: 33.29807090759277 accuracy is 0.965625 and loss is 0.09288379549980164
At time: 33.50762128829956 accuracy is 0.9734375 and loss is 0.058053594827651975
At time: 33.71103835105896 accuracy is 0.9609375 and loss is 0.11238654851913452
Evaluating...
Done Evaluating: Achieved accuracy of 0.7165697674418605
Not better for 9
Completing Train Step at 12th epoch...
At time: 34.46951866149902 accuracy is 0.9484375 and loss is 0.14206962585449218
At time: 34.65134334564209 accuracy is 0.9578125 and loss is 0.11707292795181275
At time: 34.8470196723938 accuracy is 0.978125 and loss is 0.06865702867507935
At time: 35.044100284576416 accuracy is 0.9734375 and loss is 0.09689746499061584
At time: 35.231961727142334 accuracy is 0.953125 and loss is 0.12653270959854127
At time: 35.42618775367737 accuracy is 0.95625 and loss is 0.09559983015060425
At time: 35.62108755111694 accuracy is 0.9734375 and loss is 0.10369565486907958
At time: 35.811805963516235 accuracy is 0.9734375 and loss is 0.06950058341026306
At time: 36.00436568260193 accuracy is 0.965625 and loss is 0.10677901506423951
At time: 36.19730472564697 accuracy is 0.96875 and loss is 0.07854527235031128
At time: 36.39420247077942 accuracy is 0.9734375 and loss is 0.06725828647613526
At time: 36.59514880180359 accuracy is 0.9578125 and loss is 0.14423786401748656
Evaluating...
Done Evaluating: Achieved accuracy of 0.7231104651162791
Not better for 10
Model not improving. Stopping earlyat 0.7452761627906976 epochs.
Done Training. Achieved Best Accuracy of 0.7452761627906976
mlpattn



RESULTS:
[{'best_accuracy': 0.7721656976744186, 'params': {'dropout': 0.5376350632534027, 'rnn_dropout': 0.008176655799947308, 'attn_type': 'MLP', 'attention_dim': 97, 'tune_wordvecs': True, 'wordvec_source': 'google', 'lr': 0.0006325079919326121, 'batch_size': 32, 'l2': 0.5897964839902454, 'num_layers': 1, 'data': 'MPQA', 'wordvec_dim': 300}}, {'best_accuracy': 0.7449127906976745, 'params': {'dropout': 0.48272183782402855, 'rnn_dropout': 0.2773357192999366, 'attn_type': 'MLP', 'attention_dim': 27, 'tune_wordvecs': True, 'wordvec_source': 'google', 'lr': 0.0015536578842418245, 'batch_size': 32, 'l2': 0.06294149216131684, 'num_layers': 1, 'data': 'MPQA', 'wordvec_dim': 300}}, {'best_accuracy': 0.7747093023255814, 'params': {'dropout': 0.8723363041233845, 'rnn_dropout': 0.47982211611021597, 'attn_type': 'MLP', 'attention_dim': 52, 'tune_wordvecs': True, 'wordvec_source': 'google', 'lr': 0.004262641604255246, 'batch_size': 32, 'l2': 0.9418586392421565, 'num_layers': 1, 'data': 'MPQA', 'wordvec_dim': 300}}, {'best_accuracy': 0.7768895348837209, 'params': {'dropout': 0.44545534050587865, 'rnn_dropout': 0.659908117304293, 'attn_type': 'MLP', 'attention_dim': 59, 'tune_wordvecs': True, 'wordvec_source': 'google', 'lr': 0.0013159826367545287, 'batch_size': 32, 'l2': 0.22820801870069085, 'num_layers': 1, 'data': 'MPQA', 'wordvec_dim': 300}}, {'best_accuracy': 0.7452761627906976, 'params': {'dropout': 0.013091619979159641, 'rnn_dropout': 0.3375839028408244, 'attn_type': 'MLP', 'attention_dim': 56, 'tune_wordvecs': True, 'wordvec_source': 'google', 'lr': 0.004694093862594737, 'batch_size': 32, 'l2': 0.45441157610190697, 'num_layers': 1, 'data': 'MPQA', 'wordvec_dim': 300}}]
