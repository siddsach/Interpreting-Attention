/home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/classifier/attention_rnn/model.py:206: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  A = torch.squeeze(nn.functional.softmax(s2))
/home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/classifier/attention_rnn/model.py:223: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  decoded = self.normalize(self.decoder(M))
ROOT_PATH: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language
ROOT_PATH: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language
Using CUDA!
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['gigavec']
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7f06676409e8>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'input_size': 300, 'num_layers': 2, 'cuda': True, 'hidden_size': 300, 'rnn_dropout': 0.0, 'num_classes': 2, 'dropout': 0.5, 'attention_dim': 300, 'vocab_size': 15284, 'tune_attn': False, 'train_word_vecs': False, 'batch_size': 32, 'attn_type': 'MLP', 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
}
Not Tuning Word Vectors!
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.41441965103149414 accuracy is 0.5125 and loss is 0.7357454299926758
At time: 0.5776143074035645 accuracy is 0.559375 and loss is 0.6879043579101562
At time: 0.7435441017150879 accuracy is 0.54375 and loss is 0.6910362720489502
At time: 0.9141690731048584 accuracy is 0.5109375 and loss is 0.6920291900634765
At time: 1.0972723960876465 accuracy is 0.7 and loss is 0.5774194240570069
At time: 1.2963502407073975 accuracy is 0.66875 and loss is 0.6269851684570312
At time: 1.5030295848846436 accuracy is 0.6625 and loss is 0.635654067993164
At time: 1.717628002166748 accuracy is 0.709375 and loss is 0.6064426898956299
At time: 1.9452776908874512 accuracy is 0.7265625 and loss is 0.5708626747131348
At time: 2.1817829608917236 accuracy is 0.7609375 and loss is 0.5103657722473145
At time: 2.4409730434417725 accuracy is 0.7875 and loss is 0.48755340576171874
At time: 2.719386577606201 accuracy is 0.740625 and loss is 0.5276888847351074
Evaluating...
Done Evaluating: Achieved accuracy of 0.7292877906976745
Achieved new best!
Completing Train Step at 1th epoch...
At time: 3.6479079723358154 accuracy is 0.5609375 and loss is 0.7274612426757813
At time: 3.8072831630706787 accuracy is 0.715625 and loss is 0.6264993667602539
At time: 3.976330041885376 accuracy is 0.7640625 and loss is 0.5744462966918945
At time: 4.148743391036987 accuracy is 0.74375 and loss is 0.5657758712768555
At time: 4.329280376434326 accuracy is 0.7609375 and loss is 0.5292087078094483
At time: 4.518884658813477 accuracy is 0.728125 and loss is 0.5755632877349853
At time: 4.719722270965576 accuracy is 0.7640625 and loss is 0.5391696453094482
At time: 4.927499771118164 accuracy is 0.8078125 and loss is 0.47765116691589354
At time: 5.1504480838775635 accuracy is 0.771875 and loss is 0.5333065986633301
At time: 5.381027936935425 accuracy is 0.79375 and loss is 0.4813699245452881
At time: 5.62548565864563 accuracy is 0.76875 and loss is 0.4947561264038086
At time: 5.902342319488525 accuracy is 0.7625 and loss is 0.5186666965484619
Evaluating...
Done Evaluating: Achieved accuracy of 0.7630813953488372
Achieved new best!
Completing Train Step at 2th epoch...
At time: 6.802393674850464 accuracy is 0.690625 and loss is 0.6120121479034424
At time: 6.961332321166992 accuracy is 0.765625 and loss is 0.5881187915802002
At time: 7.129907131195068 accuracy is 0.7765625 and loss is 0.456508207321167
At time: 7.299152374267578 accuracy is 0.7484375 and loss is 0.506169319152832
At time: 7.47830605506897 accuracy is 0.7734375 and loss is 0.5020373344421387
At time: 7.665495157241821 accuracy is 0.79375 and loss is 0.4760594844818115
At time: 7.86352276802063 accuracy is 0.7828125 and loss is 0.46837806701660156
At time: 8.070075273513794 accuracy is 0.8171875 and loss is 0.41222991943359377
At time: 8.29407262802124 accuracy is 0.7734375 and loss is 0.485540771484375
At time: 8.52596402168274 accuracy is 0.7828125 and loss is 0.46508126258850097
At time: 8.772010326385498 accuracy is 0.8109375 and loss is 0.4290292263031006
At time: 9.038288116455078 accuracy is 0.759375 and loss is 0.5061108589172363
Evaluating...
Done Evaluating: Achieved accuracy of 0.7707122093023255
Achieved new best!
Completing Train Step at 3th epoch...
At time: 9.921369552612305 accuracy is 0.7125 and loss is 0.5923882961273194
At time: 10.091604709625244 accuracy is 0.7828125 and loss is 0.49168834686279295
At time: 10.259233474731445 accuracy is 0.8203125 and loss is 0.40021543502807616
At time: 10.431720972061157 accuracy is 0.75625 and loss is 0.5333850383758545
At time: 10.61183762550354 accuracy is 0.7859375 and loss is 0.43477163314819334
At time: 10.804530143737793 accuracy is 0.7921875 and loss is 0.46472892761230467
At time: 11.008632898330688 accuracy is 0.753125 and loss is 0.4977700710296631
At time: 11.21542501449585 accuracy is 0.8140625 and loss is 0.4084021091461182
At time: 11.433210611343384 accuracy is 0.796875 and loss is 0.45932469367980955
At time: 11.661640167236328 accuracy is 0.8203125 and loss is 0.4301427364349365
At time: 11.906665086746216 accuracy is 0.815625 and loss is 0.4114748477935791
At time: 12.171376466751099 accuracy is 0.771875 and loss is 0.496738862991333
Evaluating...
Done Evaluating: Achieved accuracy of 0.7143895348837209
Not better for 1
Completing Train Step at 4th epoch...
At time: 13.054230690002441 accuracy is 0.703125 and loss is 0.5993899345397949
At time: 13.211759805679321 accuracy is 0.8265625 and loss is 0.4631784439086914
At time: 13.377825021743774 accuracy is 0.8296875 and loss is 0.3857510805130005
At time: 13.551404476165771 accuracy is 0.7546875 and loss is 0.49175610542297366
At time: 13.730846405029297 accuracy is 0.7734375 and loss is 0.44955716133117674
At time: 13.919187068939209 accuracy is 0.8078125 and loss is 0.43167738914489745
At time: 14.119473934173584 accuracy is 0.778125 and loss is 0.45309858322143554
At time: 14.327903270721436 accuracy is 0.8359375 and loss is 0.3709104061126709
At time: 14.547196388244629 accuracy is 0.8109375 and loss is 0.42240076065063475
At time: 14.780166387557983 accuracy is 0.8140625 and loss is 0.40587406158447265
At time: 15.02603006362915 accuracy is 0.825 and loss is 0.3793576002120972
At time: 15.289970397949219 accuracy is 0.790625 and loss is 0.49432740211486814
Evaluating...
Done Evaluating: Achieved accuracy of 0.6925872093023255
Not better for 2
Completing Train Step at 5th epoch...
At time: 16.17075824737549 accuracy is 0.6609375 and loss is 0.6482264518737793
At time: 16.330231189727783 accuracy is 0.8046875 and loss is 0.42212467193603515
At time: 16.49703311920166 accuracy is 0.8484375 and loss is 0.3691807746887207
At time: 16.67024278640747 accuracy is 0.7703125 and loss is 0.470443868637085
At time: 16.849743127822876 accuracy is 0.8046875 and loss is 0.4347508907318115
At time: 17.038406372070312 accuracy is 0.8140625 and loss is 0.4114523410797119
At time: 17.237298250198364 accuracy is 0.809375 and loss is 0.4449155807495117
At time: 17.444822072982788 accuracy is 0.85625 and loss is 0.33520779609680174
At time: 17.66379451751709 accuracy is 0.8390625 and loss is 0.37813706398010255
At time: 17.89435052871704 accuracy is 0.8328125 and loss is 0.38885500431060793
At time: 18.139064073562622 accuracy is 0.8359375 and loss is 0.3855733394622803
At time: 18.40436363220215 accuracy is 0.8140625 and loss is 0.43439326286315916
Evaluating...
Done Evaluating: Achieved accuracy of 0.7369186046511628
Not better for 3
Completing Train Step at 6th epoch...
At time: 19.280821323394775 accuracy is 0.6875 and loss is 0.6223098278045655
At time: 19.436663150787354 accuracy is 0.8515625 and loss is 0.3693256855010986
At time: 19.601062536239624 accuracy is 0.890625 and loss is 0.289355206489563
At time: 19.774643659591675 accuracy is 0.8015625 and loss is 0.4790631294250488
At time: 19.953613758087158 accuracy is 0.83125 and loss is 0.39425270557403563
At time: 20.142668962478638 accuracy is 0.825 and loss is 0.3879390239715576
At time: 20.3403582572937 accuracy is 0.8375 and loss is 0.4004605770111084
At time: 20.551059007644653 accuracy is 0.875 and loss is 0.2918276071548462
At time: 20.770949125289917 accuracy is 0.85 and loss is 0.35040218830108644
At time: 21.001570224761963 accuracy is 0.8390625 and loss is 0.43382554054260253
At time: 21.248055934906006 accuracy is 0.8515625 and loss is 0.31196587085723876
At time: 21.51268696784973 accuracy is 0.8140625 and loss is 0.42176141738891604
Evaluating...
Done Evaluating: Achieved accuracy of 0.7572674418604651
Not better for 4
Completing Train Step at 7th epoch...
At time: 22.388185739517212 accuracy is 0.709375 and loss is 0.5946952342987061
At time: 22.538299322128296 accuracy is 0.859375 and loss is 0.3434771537780762
At time: 22.69892430305481 accuracy is 0.8984375 and loss is 0.2731268644332886
At time: 22.868982553482056 accuracy is 0.8296875 and loss is 0.3945204019546509
At time: 23.046781063079834 accuracy is 0.8515625 and loss is 0.3471282243728638
At time: 23.234363794326782 accuracy is 0.825 and loss is 0.3719151258468628
At time: 23.429580688476562 accuracy is 0.8234375 and loss is 0.39041283130645754
At time: 23.63557267189026 accuracy is 0.884375 and loss is 0.26726384162902833
At time: 23.857556581497192 accuracy is 0.8390625 and loss is 0.3629300117492676
At time: 24.087924480438232 accuracy is 0.84375 and loss is 0.3399885892868042
At time: 24.3324556350708 accuracy is 0.8796875 and loss is 0.2772706985473633
At time: 24.59761357307434 accuracy is 0.8265625 and loss is 0.3891944169998169
Evaluating...
Done Evaluating: Achieved accuracy of 0.7234738372093024
Not better for 5
Completing Train Step at 8th epoch...
At time: 25.48161005973816 accuracy is 0.6640625 and loss is 0.6354515075683593
At time: 25.638141870498657 accuracy is 0.8734375 and loss is 0.3678272247314453
At time: 25.802555084228516 accuracy is 0.9171875 and loss is 0.2769278049468994
At time: 25.973716974258423 accuracy is 0.8359375 and loss is 0.3454787492752075
At time: 26.15250539779663 accuracy is 0.8953125 and loss is 0.26415703296661375
At time: 26.34095072746277 accuracy is 0.85 and loss is 0.31498496532440184
At time: 26.540414094924927 accuracy is 0.8546875 and loss is 0.33823678493499754
At time: 26.74975347518921 accuracy is 0.9296875 and loss is 0.20068445205688476
At time: 26.968168020248413 accuracy is 0.878125 and loss is 0.30189054012298583
At time: 27.19840145111084 accuracy is 0.903125 and loss is 0.2386150360107422
At time: 27.44225263595581 accuracy is 0.8984375 and loss is 0.25025861263275145
At time: 27.70516037940979 accuracy is 0.8640625 and loss is 0.30628790855407717
Evaluating...
Done Evaluating: Achieved accuracy of 0.7692587209302325
Not better for 6
Completing Train Step at 9th epoch...
At time: 28.57503867149353 accuracy is 0.6984375 and loss is 0.6230762004852295
At time: 28.724030256271362 accuracy is 0.8796875 and loss is 0.3126901388168335
At time: 28.88510489463806 accuracy is 0.9359375 and loss is 0.21379234790802001
At time: 29.067086458206177 accuracy is 0.8609375 and loss is 0.33383009433746336
At time: 29.266347408294678 accuracy is 0.8859375 and loss is 0.3028346300125122
At time: 29.467630624771118 accuracy is 0.871875 and loss is 0.28765528202056884
At time: 29.679417610168457 accuracy is 0.903125 and loss is 0.24312329292297363
At time: 29.893927097320557 accuracy is 0.909375 and loss is 0.2153886079788208
At time: 30.120550870895386 accuracy is 0.8796875 and loss is 0.298749041557312
At time: 30.35943603515625 accuracy is 0.9125 and loss is 0.1998248815536499
At time: 30.61275839805603 accuracy is 0.896875 and loss is 0.2457855224609375
At time: 30.890705108642578 accuracy is 0.8578125 and loss is 0.3432031154632568
Evaluating...
Done Evaluating: Achieved accuracy of 0.7303779069767442
Not better for 7
Completing Train Step at 10th epoch...
At time: 31.832172870635986 accuracy is 0.7203125 and loss is 0.6122345447540283
At time: 31.985263109207153 accuracy is 0.9265625 and loss is 0.2554628849029541
At time: 32.15036606788635 accuracy is 0.9671875 and loss is 0.15932698249816896
At time: 32.32439589500427 accuracy is 0.890625 and loss is 0.2852902412414551
At time: 32.50668263435364 accuracy is 0.8890625 and loss is 0.2660145044326782
At time: 32.69945979118347 accuracy is 0.9140625 and loss is 0.23259165287017822
At time: 32.901554346084595 accuracy is 0.9359375 and loss is 0.1869717001914978
At time: 33.11422872543335 accuracy is 0.9296875 and loss is 0.16990306377410888
At time: 33.33969521522522 accuracy is 0.9140625 and loss is 0.22877414226531984
At time: 33.575894594192505 accuracy is 0.9078125 and loss is 0.21294307708740234
At time: 33.82668995857239 accuracy is 0.921875 and loss is 0.20271921157836914
At time: 34.0997257232666 accuracy is 0.8734375 and loss is 0.30094108581542967
Evaluating...
Done Evaluating: Achieved accuracy of 0.7420058139534884
Not better for 8
Completing Train Step at 11th epoch...
At time: 35.016457080841064 accuracy is 0.7515625 and loss is 0.5729877948760986
At time: 35.17613244056702 accuracy is 0.9359375 and loss is 0.20006275177001953
At time: 35.35372972488403 accuracy is 0.965625 and loss is 0.16482298374176024
At time: 35.555580615997314 accuracy is 0.878125 and loss is 0.27922821044921875
At time: 35.7514488697052 accuracy is 0.9125 and loss is 0.24764869213104249
At time: 35.95833134651184 accuracy is 0.8984375 and loss is 0.2598564624786377
At time: 36.16569423675537 accuracy is 0.9171875 and loss is 0.21912744045257568
At time: 36.38101530075073 accuracy is 0.95625 and loss is 0.14363621473312377
At time: 36.60743951797485 accuracy is 0.915625 and loss is 0.23486108779907228
At time: 36.84536576271057 accuracy is 0.946875 and loss is 0.1442407488822937
At time: 37.098490953445435 accuracy is 0.934375 and loss is 0.15498119592666626
At time: 37.373297452926636 accuracy is 0.9046875 and loss is 0.2239670991897583
Evaluating...
Done Evaluating: Achieved accuracy of 0.7394622093023255
Not better for 9
Completing Train Step at 12th epoch...
At time: 38.28699827194214 accuracy is 0.784375 and loss is 0.5206348896026611
At time: 38.44745111465454 accuracy is 0.95625 and loss is 0.15804119110107423
At time: 38.61757206916809 accuracy is 0.9671875 and loss is 0.1137353539466858
At time: 38.7935574054718 accuracy is 0.9359375 and loss is 0.17721327543258666
At time: 38.97635078430176 accuracy is 0.9328125 and loss is 0.1837058663368225
At time: 39.1703999042511 accuracy is 0.9203125 and loss is 0.21173641681671143
At time: 39.374228954315186 accuracy is 0.9296875 and loss is 0.18745181560516358
At time: 39.593316316604614 accuracy is 0.9578125 and loss is 0.10928531885147094
At time: 39.81830143928528 accuracy is 0.9453125 and loss is 0.15620678663253784
At time: 40.05374455451965 accuracy is 0.9421875 and loss is 0.137327241897583
At time: 40.30409097671509 accuracy is 0.9234375 and loss is 0.21803882122039794
At time: 40.575345516204834 accuracy is 0.934375 and loss is 0.16514576673507692
Evaluating...
Done Evaluating: Achieved accuracy of 0.7681686046511628
Not better for 10
Model not improving. Stopping earlyat 0.7707122093023255 epochs.
Done Training. Achieved Best Accuracy of 0.7707122093023255
