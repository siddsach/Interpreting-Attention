/home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/classifier/attention_rnn/model.py:206: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  A = torch.squeeze(nn.functional.softmax(s2))
/home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/classifier/attention_rnn/model.py:223: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  decoded = self.normalize(self.decoder(M))
ROOT_PATH: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language
ROOT_PATH: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language
Using CUDA!
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Not using pretrained wordvectors
Building Vocab...
[]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'num_layers': 2, 'rnn_dropout': 0.0, 'attn_type': 'MLP', 'attention_dim': 300, 'vocab_size': 15284, 'hidden_size': 300, 'dropout': 0.5, 'vectors': None, 'tune_attn': False, 'cuda': True, 'batch_size': 32, 'input_size': 300, 'num_classes': 2, 'train_word_vecs': True}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.4949061870574951 accuracy is 0.5203125 and loss is 0.7369140625
At time: 0.7458605766296387 accuracy is 0.55625 and loss is 0.6880584716796875
At time: 0.9936783313751221 accuracy is 0.6140625 and loss is 0.6990357875823975
At time: 1.2413337230682373 accuracy is 0.60625 and loss is 0.6615631103515625
At time: 1.497610330581665 accuracy is 0.571875 and loss is 0.6742158889770508
At time: 1.7623169422149658 accuracy is 0.6515625 and loss is 0.6338925838470459
At time: 2.034316062927246 accuracy is 0.625 and loss is 0.6611193656921387
At time: 2.310960054397583 accuracy is 0.7234375 and loss is 0.5781757831573486
At time: 2.596771001815796 accuracy is 0.7 and loss is 0.5715104579925537
At time: 2.8932576179504395 accuracy is 0.7171875 and loss is 0.5686307430267334
At time: 3.205197811126709 accuracy is 0.696875 and loss is 0.6122287750244141
At time: 3.542185068130493 accuracy is 0.728125 and loss is 0.5523184776306153
Evaluating...
Done Evaluating: Achieved accuracy of 0.6642441860465116
Achieved new best!
Completing Train Step at 1th epoch...
At time: 4.5530335903167725 accuracy is 0.590625 and loss is 0.6883650302886963
At time: 4.780694961547852 accuracy is 0.6 and loss is 0.6619538307189942
At time: 5.019134759902954 accuracy is 0.7578125 and loss is 0.5114600181579589
At time: 5.26630711555481 accuracy is 0.7890625 and loss is 0.5166623592376709
At time: 5.51898455619812 accuracy is 0.7171875 and loss is 0.5459694862365723
At time: 5.780790090560913 accuracy is 0.78125 and loss is 0.4822238922119141
At time: 6.049066066741943 accuracy is 0.7890625 and loss is 0.48031272888183596
At time: 6.326099395751953 accuracy is 0.840625 and loss is 0.3781240224838257
At time: 6.612902641296387 accuracy is 0.821875 and loss is 0.3876869440078735
At time: 6.9098961353302 accuracy is 0.8171875 and loss is 0.47292308807373046
At time: 7.219489574432373 accuracy is 0.7484375 and loss is 0.5170049667358398
At time: 7.544758081436157 accuracy is 0.8484375 and loss is 0.33584182262420653
Evaluating...
Done Evaluating: Achieved accuracy of 0.700218023255814
Achieved new best!
Completing Train Step at 2th epoch...
At time: 8.536189079284668 accuracy is 0.7609375 and loss is 0.5329699993133545
At time: 8.76354455947876 accuracy is 0.7984375 and loss is 0.41324357986450194
At time: 9.000527143478394 accuracy is 0.8859375 and loss is 0.298112678527832
At time: 9.246273517608643 accuracy is 0.88125 and loss is 0.3196674585342407
At time: 9.499958038330078 accuracy is 0.8421875 and loss is 0.3581451177597046
At time: 9.761366844177246 accuracy is 0.8421875 and loss is 0.3464040994644165
At time: 10.031262874603271 accuracy is 0.9234375 and loss is 0.2045154094696045
At time: 10.31386685371399 accuracy is 0.89375 and loss is 0.3032963275909424
At time: 10.60071849822998 accuracy is 0.8921875 and loss is 0.25418457984924314
At time: 10.89814281463623 accuracy is 0.8421875 and loss is 0.40990138053894043
At time: 11.207172155380249 accuracy is 0.8296875 and loss is 0.3976853370666504
At time: 11.555447101593018 accuracy is 0.8734375 and loss is 0.29871084690093996
Evaluating...
Done Evaluating: Achieved accuracy of 0.764171511627907
Achieved new best!
Completing Train Step at 3th epoch...
At time: 12.62953233718872 accuracy is 0.8609375 and loss is 0.374172568321228
At time: 12.858750343322754 accuracy is 0.9375 and loss is 0.16620175838470458
At time: 13.09694528579712 accuracy is 0.9171875 and loss is 0.22131187915802003
At time: 13.341315031051636 accuracy is 0.9296875 and loss is 0.18565219640731812
At time: 13.59603476524353 accuracy is 0.9484375 and loss is 0.15959670543670654
At time: 13.858131647109985 accuracy is 0.8953125 and loss is 0.2891045570373535
At time: 14.128095865249634 accuracy is 0.95 and loss is 0.1349613070487976
At time: 14.40526032447815 accuracy is 0.8953125 and loss is 0.2842409133911133
At time: 14.692734479904175 accuracy is 0.8953125 and loss is 0.30885066986083987
At time: 14.990357875823975 accuracy is 0.9171875 and loss is 0.2601292610168457
At time: 15.299798727035522 accuracy is 0.8984375 and loss is 0.25151524543762205
At time: 15.625200033187866 accuracy is 0.9078125 and loss is 0.25098309516906736
Evaluating...
Done Evaluating: Achieved accuracy of 0.7638081395348837
Not better for 1
Completing Train Step at 4th epoch...
At time: 16.618093967437744 accuracy is 0.9421875 and loss is 0.25258560180664064
At time: 16.8469398021698 accuracy is 0.975 and loss is 0.10291922092437744
At time: 17.083711862564087 accuracy is 0.984375 and loss is 0.05363892912864685
At time: 17.330216884613037 accuracy is 0.8703125 and loss is 0.39865550994873045
At time: 17.584045886993408 accuracy is 0.9109375 and loss is 0.24978482723236084
At time: 17.84626603126526 accuracy is 0.940625 and loss is 0.226953125
At time: 18.117287635803223 accuracy is 0.9125 and loss is 0.2606895923614502
At time: 18.393980026245117 accuracy is 0.91875 and loss is 0.23263733386993407
At time: 18.679669857025146 accuracy is 0.9578125 and loss is 0.10628299713134766
At time: 18.97520613670349 accuracy is 0.95 and loss is 0.147409987449646
At time: 19.284882307052612 accuracy is 0.9671875 and loss is 0.10801994800567627
At time: 19.610936641693115 accuracy is 0.9515625 and loss is 0.11579878330230713
Evaluating...
Done Evaluating: Achieved accuracy of 0.7518168604651163
Not better for 2
Completing Train Step at 5th epoch...
At time: 20.618945837020874 accuracy is 0.9734375 and loss is 0.1449107527732849
At time: 20.857095956802368 accuracy is 0.984375 and loss is 0.05326792001724243
At time: 21.123005867004395 accuracy is 0.95625 and loss is 0.15546977519989014
At time: 21.38304567337036 accuracy is 0.9640625 and loss is 0.09013360738754272
At time: 21.64390254020691 accuracy is 0.9546875 and loss is 0.11054860353469849
At time: 21.906126260757446 accuracy is 0.9703125 and loss is 0.08006308674812317
At time: 22.176381826400757 accuracy is 0.978125 and loss is 0.07183731198310853
At time: 22.455008506774902 accuracy is 0.9609375 and loss is 0.11350426673889161
At time: 22.742866277694702 accuracy is 0.9359375 and loss is 0.19941128492355348
At time: 23.04058527946472 accuracy is 0.9640625 and loss is 0.0964119017124176
At time: 23.350544691085815 accuracy is 0.965625 and loss is 0.09940520524978638
At time: 23.677283763885498 accuracy is 0.9640625 and loss is 0.13346307277679442
Evaluating...
Done Evaluating: Achieved accuracy of 0.7281976744186046
Not better for 3
Completing Train Step at 6th epoch...
At time: 24.697880506515503 accuracy is 0.9765625 and loss is 0.09561456441879272
At time: 24.94395637512207 accuracy is 0.971875 and loss is 0.08468583822250367
At time: 25.197674989700317 accuracy is 0.9921875 and loss is 0.03008446991443634
At time: 25.446893453598022 accuracy is 0.984375 and loss is 0.04763380885124206
At time: 25.709372520446777 accuracy is 0.9828125 and loss is 0.05201685428619385
At time: 25.97707724571228 accuracy is 0.984375 and loss is 0.03294751644134521
At time: 26.249080181121826 accuracy is 0.9859375 and loss is 0.04790856540203094
At time: 26.527070999145508 accuracy is 0.971875 and loss is 0.07383552193641663
At time: 26.814783334732056 accuracy is 0.98125 and loss is 0.076809161901474
At time: 27.119237422943115 accuracy is 0.971875 and loss is 0.08428654670715333
At time: 27.437637090682983 accuracy is 0.9375 and loss is 0.19170993566513062
At time: 27.764371156692505 accuracy is 0.95 and loss is 0.21596264839172363
Evaluating...
Done Evaluating: Achieved accuracy of 0.7409156976744186
Not better for 4
Completing Train Step at 7th epoch...
At time: 28.772050142288208 accuracy is 0.990625 and loss is 0.04857698380947113
At time: 29.00897455215454 accuracy is 0.9796875 and loss is 0.060679423809051516
At time: 29.251311540603638 accuracy is 0.990625 and loss is 0.04677890539169312
At time: 29.499173164367676 accuracy is 0.9515625 and loss is 0.18237590789794922
At time: 29.752507209777832 accuracy is 0.9828125 and loss is 0.04923087954521179
At time: 30.016011953353882 accuracy is 0.965625 and loss is 0.15055564641952515
At time: 30.28520369529724 accuracy is 0.975 and loss is 0.07596943378448487
At time: 30.561931848526 accuracy is 0.94375 and loss is 0.16613168716430665
At time: 30.846819639205933 accuracy is 0.9640625 and loss is 0.12167894840240479
At time: 31.142590522766113 accuracy is 0.978125 and loss is 0.061634916067123416
At time: 31.451499700546265 accuracy is 0.965625 and loss is 0.0982857346534729
At time: 31.77570867538452 accuracy is 0.975 and loss is 0.07306089997291565
Evaluating...
Done Evaluating: Achieved accuracy of 0.7547238372093024
Not better for 5
Completing Train Step at 8th epoch...
At time: 32.781923055648804 accuracy is 0.9890625 and loss is 0.05869868993759155
At time: 33.0189163684845 accuracy is 0.9859375 and loss is 0.03055969476699829
At time: 33.26215314865112 accuracy is 0.9953125 and loss is 0.012483944743871688
At time: 33.507588386535645 accuracy is 0.984375 and loss is 0.03092687726020813
At time: 33.75828981399536 accuracy is 0.9859375 and loss is 0.030813828110694885
At time: 34.0171103477478 accuracy is 0.9890625 and loss is 0.03425624966621399
At time: 34.28481459617615 accuracy is 0.98125 and loss is 0.05993064641952515
At time: 34.559627056121826 accuracy is 0.9890625 and loss is 0.027881512045860292
At time: 34.84536600112915 accuracy is 0.975 and loss is 0.09336864352226257
At time: 35.13944172859192 accuracy is 0.990625 and loss is 0.025652593374252318
At time: 35.44548153877258 accuracy is 0.9796875 and loss is 0.057625305652618405
At time: 35.769240856170654 accuracy is 0.9796875 and loss is 0.09794598221778869
Evaluating...
Done Evaluating: Achieved accuracy of 0.7456395348837209
Not better for 6
Completing Train Step at 9th epoch...
At time: 36.76410102844238 accuracy is 0.990625 and loss is 0.04767836630344391
At time: 37.00199246406555 accuracy is 0.99375 and loss is 0.026672321557998657
At time: 37.243104219436646 accuracy is 0.9921875 and loss is 0.017311590909957885
At time: 37.487990856170654 accuracy is 0.9828125 and loss is 0.04049040377140045
At time: 37.740174531936646 accuracy is 0.9859375 and loss is 0.036985179781913756
At time: 38.000431537628174 accuracy is 0.9984375 and loss is 0.01165710762143135
At time: 38.26792764663696 accuracy is 0.9984375 and loss is 0.00865575224161148
At time: 38.54484415054321 accuracy is 0.99375 and loss is 0.020749787986278533
At time: 38.83097505569458 accuracy is 0.9921875 and loss is 0.020555189251899718
At time: 39.1269428730011 accuracy is 0.99375 and loss is 0.02117854505777359
At time: 39.43418216705322 accuracy is 0.99375 and loss is 0.013373947143554688
At time: 39.75829076766968 accuracy is 0.984375 and loss is 0.05347472429275513
Evaluating...
Done Evaluating: Achieved accuracy of 0.7496366279069767
Not better for 7
Completing Train Step at 10th epoch...
At time: 40.75643014907837 accuracy is 0.9859375 and loss is 0.05276497602462769
At time: 40.99193596839905 accuracy is 0.99375 and loss is 0.01641051024198532
At time: 41.23310995101929 accuracy is 0.9796875 and loss is 0.052741986513137815
At time: 41.47685360908508 accuracy is 0.996875 and loss is 0.012143153697252274
At time: 41.72838091850281 accuracy is 0.959375 and loss is 0.10997251272201539
At time: 41.988595724105835 accuracy is 0.98125 and loss is 0.0461988240480423
At time: 42.25808763504028 accuracy is 0.98125 and loss is 0.08529024124145508
At time: 42.555155515670776 accuracy is 0.98125 and loss is 0.0714022159576416
At time: 42.85318875312805 accuracy is 0.9890625 and loss is 0.032861894369125365
At time: 43.1570885181427 accuracy is 0.9875 and loss is 0.027560275793075562
At time: 43.46406078338623 accuracy is 0.9828125 and loss is 0.03792180120944977
At time: 43.790576457977295 accuracy is 0.98125 and loss is 0.07289309501647949
Evaluating...
Done Evaluating: Achieved accuracy of 0.7220203488372093
Not better for 8
Completing Train Step at 11th epoch...
At time: 44.901957750320435 accuracy is 0.9953125 and loss is 0.035897675156593326
At time: 45.13626527786255 accuracy is 0.990625 and loss is 0.024869486689567566
At time: 45.391496658325195 accuracy is 0.99375 and loss is 0.019013498723506928
At time: 45.6456253528595 accuracy is 0.9953125 and loss is 0.01919555515050888
At time: 45.90475273132324 accuracy is 0.990625 and loss is 0.02549922466278076
At time: 46.17121696472168 accuracy is 0.9859375 and loss is 0.0648160994052887
At time: 46.44174861907959 accuracy is 0.975 and loss is 0.06189539432525635
At time: 46.719085693359375 accuracy is 0.9921875 and loss is 0.018131496012210847
At time: 47.00736403465271 accuracy is 0.99375 and loss is 0.027827712893486022
At time: 47.30686283111572 accuracy is 0.9796875 and loss is 0.08627268075942993
At time: 47.61523962020874 accuracy is 0.9859375 and loss is 0.0502846360206604
At time: 47.941601514816284 accuracy is 0.9734375 and loss is 0.10646476745605468
Evaluating...
Done Evaluating: Achieved accuracy of 0.747093023255814
Not better for 9
Completing Train Step at 12th epoch...
At time: 48.935423374176025 accuracy is 0.9921875 and loss is 0.024219802021980284
At time: 49.166176557540894 accuracy is 0.9765625 and loss is 0.08577859997749329
At time: 49.40606474876404 accuracy is 0.965625 and loss is 0.10698536634445191
At time: 49.654242277145386 accuracy is 0.990625 and loss is 0.026705017685890196
At time: 49.92124009132385 accuracy is 0.9875 and loss is 0.027576833963394165
At time: 50.19784617424011 accuracy is 0.95625 and loss is 0.1071700096130371
At time: 50.47870683670044 accuracy is 0.996875 and loss is 0.012021082639694213
At time: 50.76138925552368 accuracy is 0.9765625 and loss is 0.06845959424972534
At time: 51.05236554145813 accuracy is 0.9953125 and loss is 0.018454688787460326
At time: 51.35110926628113 accuracy is 0.99375 and loss is 0.019345638155937196
At time: 51.66253733634949 accuracy is 0.996875 and loss is 0.009169691056013108
At time: 51.98941493034363 accuracy is 0.9921875 and loss is 0.03990808427333832
Evaluating...
Done Evaluating: Achieved accuracy of 0.7503633720930233
Not better for 10
Model not improving. Stopping earlyat 0.764171511627907 epochs.
Done Training. Achieved Best Accuracy of 0.764171511627907
