ROOT_PATH: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language
Building Bayesian Optimizer for 
 data:MPQA 
 choices:[{'name': 'lr', 'domain': [5e-05, 0.005], 'type': 'continuous'}, {'name': 'rnn_dropout', 'domain': [0, 1], 'type': 'continuous'}, {'name': 'dropout', 'domain': [0, 1], 'type': 'continuous'}, {'name': 'l2', 'domain': [0, 1], 'type': 'continuous'}, {'name': 'attention_dim', 'domain': [5, 100], 'type': 'continuous'}]
SETTINGS FOR THIS RUN
{'tune_wordvecs': True, 'data': 'MPQA', 'wordvec_dim': 300, 'batch_size': 32, 'attn_type': 'MLP', 'lr': 0.0032841481931933057, 'num_layers': 2, 'rnn_dropout': 0.6108291237364665, 'dropout': 0.6935883145489438, 'wordvec_source': 'gigavec', 'attention_dim': 51, 'l2': 0.2706927771405857}
Using CUDA!
here
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['gigavec']
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fb4f7c16048>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'hidden_size': 300, 'input_size': 300, 'batch_size': 32, 'num_layers': 2, 'tune_attn': 'True', 'train_word_vecs': True, 'rnn_dropout': 0.6108291237364665, 'vocab_size': 15284, 'dropout': 0.6935883145489438, 'attention_dim': 51, 'cuda': True, 'attn_type': 'MLP', 'num_classes': 2}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.5319864749908447 accuracy is 0.5703125 and loss is 0.7312112331390381
At time: 0.7864053249359131 accuracy is 0.4796875 and loss is 0.7434416770935058
At time: 1.0532536506652832 accuracy is 0.6125 and loss is 0.6515871047973633
At time: 1.335014820098877 accuracy is 0.6703125 and loss is 0.6774878025054931
At time: 1.6280546188354492 accuracy is 0.6640625 and loss is 0.6049141407012939
At time: 1.934818983078003 accuracy is 0.659375 and loss is 0.638310432434082
At time: 2.2480628490448 accuracy is 0.628125 and loss is 0.6548019409179687
At time: 2.573477268218994 accuracy is 0.7171875 and loss is 0.5874000072479248
At time: 2.911153554916382 accuracy is 0.7125 and loss is 0.57008957862854
At time: 3.2581536769866943 accuracy is 0.746875 and loss is 0.5541516304016113
At time: 3.628329277038574 accuracy is 0.7421875 and loss is 0.5580573081970215
At time: 4.036393404006958 accuracy is 0.728125 and loss is 0.5803112030029297
Evaluating...
Done Evaluating: Achieved accuracy of 0.7659883720930233
Achieved new best!
Completing Train Step at 1th epoch...
At time: 5.142807960510254 accuracy is 0.7546875 and loss is 0.6528384685516357
At time: 5.370624542236328 accuracy is 0.775 and loss is 0.4515418529510498
At time: 5.6080005168914795 accuracy is 0.821875 and loss is 0.42856597900390625
At time: 5.853541374206543 accuracy is 0.7890625 and loss is 0.427549409866333
At time: 6.106379747390747 accuracy is 0.775 and loss is 0.4831822872161865
At time: 6.366180419921875 accuracy is 0.7828125 and loss is 0.4872805118560791
At time: 6.634976625442505 accuracy is 0.7953125 and loss is 0.4530763626098633
At time: 6.908936977386475 accuracy is 0.846875 and loss is 0.37607598304748535
At time: 7.194936990737915 accuracy is 0.846875 and loss is 0.37896018028259276
At time: 7.491505146026611 accuracy is 0.85 and loss is 0.35297245979309083
At time: 7.796637296676636 accuracy is 0.8515625 and loss is 0.34616403579711913
At time: 8.12035846710205 accuracy is 0.8625 and loss is 0.34561972618103026
Evaluating...
Done Evaluating: Achieved accuracy of 0.7438226744186046
Not better for 1
Completing Train Step at 2th epoch...
At time: 9.11707854270935 accuracy is 0.7265625 and loss is 0.6196434497833252
At time: 9.34852647781372 accuracy is 0.83125 and loss is 0.3918084859848022
At time: 9.584940433502197 accuracy is 0.8734375 and loss is 0.26955256462097166
At time: 9.82813549041748 accuracy is 0.9125 and loss is 0.23373329639434814
At time: 10.078164339065552 accuracy is 0.8625 and loss is 0.3350257158279419
At time: 10.337008953094482 accuracy is 0.884375 and loss is 0.338242244720459
At time: 10.603203296661377 accuracy is 0.8640625 and loss is 0.34292495250701904
At time: 10.877075910568237 accuracy is 0.9046875 and loss is 0.2597655773162842
At time: 11.16252589225769 accuracy is 0.8890625 and loss is 0.26481659412384034
At time: 11.458592414855957 accuracy is 0.871875 and loss is 0.29858582019805907
At time: 11.767342329025269 accuracy is 0.8953125 and loss is 0.25371322631835935
At time: 12.092721223831177 accuracy is 0.865625 and loss is 0.3652172088623047
Evaluating...
Done Evaluating: Achieved accuracy of 0.6776889534883721
Not better for 2
Completing Train Step at 3th epoch...
At time: 13.088387250900269 accuracy is 0.7515625 and loss is 0.5060441970825196
At time: 13.325199365615845 accuracy is 0.890625 and loss is 0.28599116802215574
At time: 13.565253257751465 accuracy is 0.925 and loss is 0.19456732273101807
At time: 13.809360265731812 accuracy is 0.9078125 and loss is 0.2679804563522339
At time: 14.06220531463623 accuracy is 0.9328125 and loss is 0.1521818995475769
At time: 14.324991226196289 accuracy is 0.921875 and loss is 0.19169609546661376
At time: 14.594955205917358 accuracy is 0.9125 and loss is 0.19010831117630006
At time: 14.871250867843628 accuracy is 0.9234375 and loss is 0.19102877378463745
At time: 15.15684986114502 accuracy is 0.934375 and loss is 0.1494462251663208
At time: 15.453348636627197 accuracy is 0.90625 and loss is 0.21837050914764405
At time: 15.75977897644043 accuracy is 0.9390625 and loss is 0.17931792736053467
At time: 16.08214569091797 accuracy is 0.921875 and loss is 0.21973156929016113
Evaluating...
Done Evaluating: Achieved accuracy of 0.7481831395348837
Not better for 3
Completing Train Step at 4th epoch...
At time: 17.067225456237793 accuracy is 0.8390625 and loss is 0.39673333168029784
At time: 17.30929660797119 accuracy is 0.91875 and loss is 0.1940920829772949
At time: 17.55486011505127 accuracy is 0.9734375 and loss is 0.08936217427253723
At time: 17.801253080368042 accuracy is 0.9578125 and loss is 0.1267844557762146
At time: 18.053064107894897 accuracy is 0.946875 and loss is 0.16606186628341674
At time: 18.315752267837524 accuracy is 0.9171875 and loss is 0.23122901916503907
At time: 18.58983850479126 accuracy is 0.93125 and loss is 0.17168657779693602
At time: 18.869566202163696 accuracy is 0.95625 and loss is 0.12859512567520143
At time: 19.159598350524902 accuracy is 0.9625 and loss is 0.09934720993041993
At time: 19.454527616500854 accuracy is 0.94375 and loss is 0.10777719020843506
At time: 19.762532711029053 accuracy is 0.9515625 and loss is 0.11261533498764038
At time: 20.086791038513184 accuracy is 0.9515625 and loss is 0.13409889936447145
Evaluating...
Done Evaluating: Achieved accuracy of 0.7449127906976745
Not better for 4
Completing Train Step at 5th epoch...
At time: 21.085294723510742 accuracy is 0.8765625 and loss is 0.33502156734466554
At time: 21.32404613494873 accuracy is 0.9375 and loss is 0.14511168003082275
At time: 21.559886932373047 accuracy is 0.965625 and loss is 0.09389423131942749
At time: 21.80429983139038 accuracy is 0.946875 and loss is 0.12225549221038819
At time: 22.055540084838867 accuracy is 0.9625 and loss is 0.08243666887283325
At time: 22.313426733016968 accuracy is 0.940625 and loss is 0.15838079452514647
At time: 22.581725120544434 accuracy is 0.91875 and loss is 0.2151125431060791
At time: 22.861369609832764 accuracy is 0.946875 and loss is 0.1701408863067627
At time: 23.153974294662476 accuracy is 0.95625 and loss is 0.10593575239181519
At time: 23.4711971282959 accuracy is 0.965625 and loss is 0.10911229848861695
At time: 23.788527250289917 accuracy is 0.9640625 and loss is 0.08544678092002869
At time: 24.11774206161499 accuracy is 0.93125 and loss is 0.15464106798171998
Evaluating...
Done Evaluating: Achieved accuracy of 0.7300145348837209
Not better for 5
Completing Train Step at 6th epoch...
At time: 25.119178295135498 accuracy is 0.9015625 and loss is 0.2896700143814087
At time: 25.364084243774414 accuracy is 0.9546875 and loss is 0.13629027605056762
At time: 25.614434003829956 accuracy is 0.971875 and loss is 0.08691250085830689
At time: 25.86666750907898 accuracy is 0.9625 and loss is 0.10239483118057251
At time: 26.12381386756897 accuracy is 0.9734375 and loss is 0.07191119194030762
At time: 26.385024070739746 accuracy is 0.946875 and loss is 0.1435064435005188
At time: 26.654519081115723 accuracy is 0.9359375 and loss is 0.1731931447982788
At time: 26.933902263641357 accuracy is 0.9359375 and loss is 0.1715586543083191
At time: 27.22057819366455 accuracy is 0.946875 and loss is 0.11578910350799561
At time: 27.515220642089844 accuracy is 0.9296875 and loss is 0.19758130311965943
At time: 27.817546606063843 accuracy is 0.95625 and loss is 0.15356314182281494
At time: 28.138671875 accuracy is 0.9515625 and loss is 0.15250976085662843
Evaluating...
Done Evaluating: Achieved accuracy of 0.7296511627906976
Not better for 6
Completing Train Step at 7th epoch...
At time: 29.10048508644104 accuracy is 0.8796875 and loss is 0.2780466556549072
At time: 29.32863163948059 accuracy is 0.9703125 and loss is 0.11660532951354981
At time: 29.56522846221924 accuracy is 0.96875 and loss is 0.07151833176612854
At time: 29.820191860198975 accuracy is 0.9703125 and loss is 0.06931145787239075
At time: 30.078717708587646 accuracy is 0.975 and loss is 0.07512499690055847
At time: 30.345752477645874 accuracy is 0.928125 and loss is 0.20606985092163085
At time: 30.621350526809692 accuracy is 0.9140625 and loss is 0.28401527404785154
At time: 30.89861559867859 accuracy is 0.940625 and loss is 0.17193440198898316
At time: 31.184602975845337 accuracy is 0.928125 and loss is 0.186747145652771
At time: 31.479292154312134 accuracy is 0.9375 and loss is 0.25489532947540283
At time: 31.783187866210938 accuracy is 0.9421875 and loss is 0.1829892873764038
At time: 32.103827476501465 accuracy is 0.946875 and loss is 0.1506901741027832
Evaluating...
Done Evaluating: Achieved accuracy of 0.721656976744186
Not better for 7
Completing Train Step at 8th epoch...
At time: 33.077348947525024 accuracy is 0.9125 and loss is 0.23740112781524658
At time: 33.30815577507019 accuracy is 0.9609375 and loss is 0.09892807006835938
At time: 33.54803395271301 accuracy is 0.96875 and loss is 0.06788553595542908
At time: 33.796565771102905 accuracy is 0.9296875 and loss is 0.19558537006378174
At time: 34.050894021987915 accuracy is 0.959375 and loss is 0.1528005361557007
At time: 34.31407856941223 accuracy is 0.9296875 and loss is 0.2229994297027588
At time: 34.58439254760742 accuracy is 0.9453125 and loss is 0.18520536422729492
At time: 34.860966205596924 accuracy is 0.9640625 and loss is 0.10813274383544921
At time: 35.14530396461487 accuracy is 0.9703125 and loss is 0.07403459548950195
At time: 35.43738770484924 accuracy is 0.9765625 and loss is 0.07193226814270019
At time: 35.74434566497803 accuracy is 0.9640625 and loss is 0.07883349061012268
At time: 36.078511238098145 accuracy is 0.9703125 and loss is 0.09027929902076721
Evaluating...
Done Evaluating: Achieved accuracy of 0.71875
Not better for 8
Completing Train Step at 9th epoch...
At time: 37.09980487823486 accuracy is 0.9171875 and loss is 0.24340598583221434
At time: 37.330361127853394 accuracy is 0.9796875 and loss is 0.08114423155784607
At time: 37.56891322135925 accuracy is 0.9796875 and loss is 0.05403686761856079
At time: 37.8124303817749 accuracy is 0.9828125 and loss is 0.04155393540859222
At time: 38.067174196243286 accuracy is 0.96875 and loss is 0.07485811710357666
At time: 38.33010411262512 accuracy is 0.9640625 and loss is 0.12219740152359009
At time: 38.603957653045654 accuracy is 0.953125 and loss is 0.13724496364593505
At time: 38.880929708480835 accuracy is 0.96875 and loss is 0.07665123343467713
At time: 39.16766119003296 accuracy is 0.9703125 and loss is 0.08072584271430969
At time: 39.463910818099976 accuracy is 0.9578125 and loss is 0.10845828056335449
At time: 39.773404121398926 accuracy is 0.9671875 and loss is 0.10650053024291992
At time: 40.10031008720398 accuracy is 0.9578125 and loss is 0.1364022135734558
Evaluating...
Done Evaluating: Achieved accuracy of 0.7089389534883721
Not better for 9
Completing Train Step at 10th epoch...
At time: 41.090718507766724 accuracy is 0.9109375 and loss is 0.226890230178833
At time: 41.318538665771484 accuracy is 0.9578125 and loss is 0.11579233407974243
At time: 41.557393312454224 accuracy is 0.9828125 and loss is 0.05530566573143005
At time: 41.803014039993286 accuracy is 0.978125 and loss is 0.0712675392627716
At time: 42.05558371543884 accuracy is 0.95625 and loss is 0.11833646297454833
At time: 42.322691679000854 accuracy is 0.946875 and loss is 0.13285056352615357
At time: 42.60460638999939 accuracy is 0.94375 and loss is 0.14755648374557495
At time: 42.89217948913574 accuracy is 0.9625 and loss is 0.11947040557861328
At time: 43.1841607093811 accuracy is 0.940625 and loss is 0.16292181015014648
At time: 43.48102283477783 accuracy is 0.9421875 and loss is 0.17753839492797852
At time: 43.78934574127197 accuracy is 0.9578125 and loss is 0.12761462926864625
At time: 44.115498065948486 accuracy is 0.94375 and loss is 0.19556511640548707
Evaluating...
Done Evaluating: Achieved accuracy of 0.704578488372093
Not better for 10
Model not improving. Stopping earlyat 0.7659883720930233 epochs.
Done Training. Achieved Best Accuracy of 0.7659883720930233
Improved accuracyfrom -10000000 to 0.7659883720930233
mlpattn
SETTINGS FOR THIS RUN
{'tune_wordvecs': True, 'data': 'MPQA', 'wordvec_dim': 300, 'batch_size': 32, 'attn_type': 'MLP', 'lr': 0.002899477338041026, 'num_layers': 2, 'rnn_dropout': 0.04977555262234046, 'dropout': 0.9713428067963789, 'wordvec_source': 'gigavec', 'attention_dim': 68, 'l2': 0.20087889736130604}
Using CUDA!
here
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['gigavec']
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fb4edd5ce10>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'hidden_size': 300, 'input_size': 300, 'batch_size': 32, 'num_layers': 2, 'tune_attn': 'True', 'train_word_vecs': True, 'rnn_dropout': 0.04977555262234046, 'vocab_size': 15284, 'dropout': 0.9713428067963789, 'attention_dim': 68, 'cuda': True, 'attn_type': 'MLP', 'num_classes': 2}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.28987932205200195 accuracy is 0.5734375 and loss is 0.7285807609558106
At time: 0.5479731559753418 accuracy is 0.4921875 and loss is 0.7269824028015137
At time: 0.8129956722259521 accuracy is 0.5609375 and loss is 0.6925368785858155
At time: 1.1008012294769287 accuracy is 0.5859375 and loss is 0.6828069686889648
At time: 1.3969438076019287 accuracy is 0.6328125 and loss is 0.6976145267486572
At time: 1.702209234237671 accuracy is 0.6484375 and loss is 0.6710153579711914
At time: 2.0132100582122803 accuracy is 0.6875 and loss is 0.5965413093566895
At time: 2.3338327407836914 accuracy is 0.6734375 and loss is 0.6364504814147949
At time: 2.669534206390381 accuracy is 0.6640625 and loss is 0.654910945892334
At time: 3.019603967666626 accuracy is 0.6828125 and loss is 0.5937896728515625
At time: 3.388423204421997 accuracy is 0.721875 and loss is 0.5807202816009521
At time: 3.7809431552886963 accuracy is 0.7421875 and loss is 0.5399019241333007
Evaluating...
Done Evaluating: Achieved accuracy of 0.7412790697674418
Achieved new best!
Completing Train Step at 1th epoch...
At time: 4.8681113719940186 accuracy is 0.6921875 and loss is 0.6490727424621582
At time: 5.101635694503784 accuracy is 0.7484375 and loss is 0.5060930728912354
At time: 5.343102693557739 accuracy is 0.8203125 and loss is 0.42252960205078127
At time: 5.593003749847412 accuracy is 0.7703125 and loss is 0.4871990203857422
At time: 5.850235223770142 accuracy is 0.8171875 and loss is 0.38713228702545166
At time: 6.113778352737427 accuracy is 0.7828125 and loss is 0.4805278778076172
At time: 6.382993936538696 accuracy is 0.8546875 and loss is 0.33484041690826416
At time: 6.661905527114868 accuracy is 0.8484375 and loss is 0.35289385318756106
At time: 6.949068784713745 accuracy is 0.8375 and loss is 0.3890900850296021
At time: 7.249013423919678 accuracy is 0.815625 and loss is 0.38694052696228026
At time: 7.560388088226318 accuracy is 0.79375 and loss is 0.4385961055755615
At time: 7.888120889663696 accuracy is 0.8375 and loss is 0.3609680414199829
Evaluating...
Done Evaluating: Achieved accuracy of 0.734375
Not better for 1
Completing Train Step at 2th epoch...
At time: 8.904896974563599 accuracy is 0.7828125 and loss is 0.54897141456604
At time: 9.144072771072388 accuracy is 0.8890625 and loss is 0.30728223323822024
At time: 9.388610363006592 accuracy is 0.9125 and loss is 0.23674421310424804
At time: 9.636413812637329 accuracy is 0.85 and loss is 0.3757264852523804
At time: 9.89123272895813 accuracy is 0.8671875 and loss is 0.29127047061920164
At time: 10.152847051620483 accuracy is 0.86875 and loss is 0.2999890804290771
At time: 10.424267292022705 accuracy is 0.909375 and loss is 0.22479524612426757
At time: 10.705515623092651 accuracy is 0.925 and loss is 0.2036952257156372
At time: 10.995234966278076 accuracy is 0.8890625 and loss is 0.27382264137268064
At time: 11.293571710586548 accuracy is 0.865625 and loss is 0.33588621616363523
At time: 11.621312379837036 accuracy is 0.875 and loss is 0.29264006614685056
At time: 11.9569411277771 accuracy is 0.90625 and loss is 0.23856046199798583
Evaluating...
Done Evaluating: Achieved accuracy of 0.7547238372093024
Achieved new best!
Completing Train Step at 3th epoch...
At time: 12.972801208496094 accuracy is 0.81875 and loss is 0.4106241226196289
At time: 13.209276676177979 accuracy is 0.9296875 and loss is 0.20003819465637207
At time: 13.452968120574951 accuracy is 0.9 and loss is 0.262898588180542
At time: 13.701014041900635 accuracy is 0.9 and loss is 0.3619529247283936
At time: 13.956849098205566 accuracy is 0.9 and loss is 0.29207849502563477
At time: 14.216044187545776 accuracy is 0.9015625 and loss is 0.27382597923278806
At time: 14.482361078262329 accuracy is 0.915625 and loss is 0.2003305435180664
At time: 14.75605320930481 accuracy is 0.915625 and loss is 0.23426032066345215
At time: 15.060869932174683 accuracy is 0.915625 and loss is 0.22774930000305177
At time: 15.366509199142456 accuracy is 0.8828125 and loss is 0.29303784370422364
At time: 15.67614483833313 accuracy is 0.9140625 and loss is 0.21466500759124757
At time: 16.00637459754944 accuracy is 0.9046875 and loss is 0.24196791648864746
Evaluating...
Done Evaluating: Achieved accuracy of 0.747093023255814
Not better for 1
Completing Train Step at 4th epoch...
At time: 17.006635189056396 accuracy is 0.8921875 and loss is 0.3272838115692139
At time: 17.243237257003784 accuracy is 0.9328125 and loss is 0.18427824974060059
At time: 17.482602834701538 accuracy is 0.9453125 and loss is 0.1504654049873352
At time: 17.72704029083252 accuracy is 0.903125 and loss is 0.24433085918426514
At time: 17.97906732559204 accuracy is 0.90625 and loss is 0.26142642498016355
At time: 18.238944053649902 accuracy is 0.890625 and loss is 0.2457796096801758
At time: 18.505266666412354 accuracy is 0.95 and loss is 0.14316354990005492
At time: 18.78128933906555 accuracy is 0.9390625 and loss is 0.1818282723426819
At time: 19.06537103652954 accuracy is 0.9375 and loss is 0.18727487325668335
At time: 19.358874797821045 accuracy is 0.91875 and loss is 0.20712013244628907
At time: 19.662687301635742 accuracy is 0.9328125 and loss is 0.1792331099510193
At time: 19.984128952026367 accuracy is 0.9390625 and loss is 0.14954594373703003
Evaluating...
Done Evaluating: Achieved accuracy of 0.7274709302325582
Not better for 2
Completing Train Step at 5th epoch...
At time: 20.973031044006348 accuracy is 0.9 and loss is 0.2867520809173584
At time: 21.20701789855957 accuracy is 0.95 and loss is 0.13564234972000122
At time: 21.4521005153656 accuracy is 0.9453125 and loss is 0.1686460018157959
At time: 21.697757720947266 accuracy is 0.8921875 and loss is 0.2615558624267578
At time: 21.948922395706177 accuracy is 0.91875 and loss is 0.19679223299026488
At time: 22.20878005027771 accuracy is 0.921875 and loss is 0.19369229078292846
At time: 22.47819471359253 accuracy is 0.953125 and loss is 0.10875391960144043
At time: 22.75452995300293 accuracy is 0.921875 and loss is 0.20380306243896484
At time: 23.038501262664795 accuracy is 0.9265625 and loss is 0.20235652923583985
At time: 23.333134651184082 accuracy is 0.9265625 and loss is 0.20651707649230958
At time: 23.639888048171997 accuracy is 0.953125 and loss is 0.14063454866409303
At time: 23.96310043334961 accuracy is 0.9328125 and loss is 0.16575804948806763
Evaluating...
Done Evaluating: Achieved accuracy of 0.7223837209302325
Not better for 3
Completing Train Step at 6th epoch...
At time: 24.960514307022095 accuracy is 0.8921875 and loss is 0.3155739068984985
At time: 25.196993350982666 accuracy is 0.9421875 and loss is 0.15787895917892455
At time: 25.4365451335907 accuracy is 0.9625 and loss is 0.11256413459777832
At time: 25.67888903617859 accuracy is 0.953125 and loss is 0.12013885974884034
At time: 25.93090534210205 accuracy is 0.9484375 and loss is 0.12194377183914185
At time: 26.190410375595093 accuracy is 0.940625 and loss is 0.1526970624923706
At time: 26.456921100616455 accuracy is 0.95625 and loss is 0.14457352161407472
At time: 26.732826232910156 accuracy is 0.9296875 and loss is 0.19782402515411376
At time: 27.016491413116455 accuracy is 0.9421875 and loss is 0.17200133800506592
At time: 27.309918642044067 accuracy is 0.9359375 and loss is 0.15980370044708253
At time: 27.616904973983765 accuracy is 0.9421875 and loss is 0.1390238046646118
At time: 27.942331552505493 accuracy is 0.9328125 and loss is 0.18261600732803346
Evaluating...
Done Evaluating: Achieved accuracy of 0.721656976744186
Not better for 4
Completing Train Step at 7th epoch...
At time: 28.940930604934692 accuracy is 0.8953125 and loss is 0.2839460611343384
At time: 29.17120933532715 accuracy is 0.91875 and loss is 0.23064713478088378
At time: 29.407063484191895 accuracy is 0.9546875 and loss is 0.12315714359283447
At time: 29.653918504714966 accuracy is 0.9578125 and loss is 0.09698755145072938
At time: 29.925883293151855 accuracy is 0.9609375 and loss is 0.0875612199306488
At time: 30.192888021469116 accuracy is 0.94375 and loss is 0.14840632677078247
At time: 30.46464776992798 accuracy is 0.94375 and loss is 0.14967094659805297
At time: 30.75454092025757 accuracy is 0.9265625 and loss is 0.20935277938842772
At time: 31.051897764205933 accuracy is 0.928125 and loss is 0.1793328642845154
At time: 31.3491849899292 accuracy is 0.9375 and loss is 0.19096603393554687
At time: 31.656105279922485 accuracy is 0.95 and loss is 0.12628453969955444
At time: 31.98158288002014 accuracy is 0.9296875 and loss is 0.17036641836166383
Evaluating...
Done Evaluating: Achieved accuracy of 0.7369186046511628
Not better for 5
Completing Train Step at 8th epoch...
At time: 32.96397280693054 accuracy is 0.9109375 and loss is 0.23501222133636473
At time: 33.193076610565186 accuracy is 0.94375 and loss is 0.15158733129501342
At time: 33.42790460586548 accuracy is 0.9625 and loss is 0.11153002977371215
At time: 33.669471740722656 accuracy is 0.95625 and loss is 0.11234055757522583
At time: 33.92348313331604 accuracy is 0.9265625 and loss is 0.18603930473327637
At time: 34.185144662857056 accuracy is 0.934375 and loss is 0.1878456711769104
At time: 34.453717947006226 accuracy is 0.9375 and loss is 0.15346466302871703
At time: 34.73054885864258 accuracy is 0.934375 and loss is 0.18828485012054444
At time: 35.01615118980408 accuracy is 0.925 and loss is 0.19386507272720338
At time: 35.31141138076782 accuracy is 0.9234375 and loss is 0.19442238807678222
At time: 35.62895059585571 accuracy is 0.9578125 and loss is 0.12461048364639282
At time: 35.95489692687988 accuracy is 0.9484375 and loss is 0.13303263187408448
Evaluating...
Done Evaluating: Achieved accuracy of 0.7307412790697675
Not better for 6
Completing Train Step at 9th epoch...
At time: 37.01737976074219 accuracy is 0.9125 and loss is 0.2348780870437622
At time: 37.25011420249939 accuracy is 0.9078125 and loss is 0.23138844966888428
At time: 37.4890034198761 accuracy is 0.9625 and loss is 0.12328066825866699
At time: 37.73492741584778 accuracy is 0.9640625 and loss is 0.09953148365020752
At time: 38.001503467559814 accuracy is 0.953125 and loss is 0.11455990076065063
At time: 38.26585078239441 accuracy is 0.959375 and loss is 0.10624258518218994
At time: 38.533674240112305 accuracy is 0.9609375 and loss is 0.10568468570709229
At time: 38.80964779853821 accuracy is 0.940625 and loss is 0.19857394695281982
At time: 39.09359860420227 accuracy is 0.9421875 and loss is 0.1704576015472412
At time: 39.389620780944824 accuracy is 0.9515625 and loss is 0.12250839471817017
At time: 39.69762206077576 accuracy is 0.9296875 and loss is 0.18989918231964112
At time: 40.02113962173462 accuracy is 0.95 and loss is 0.10684384107589721
Evaluating...
Done Evaluating: Achieved accuracy of 0.7318313953488372
Not better for 7
Completing Train Step at 10th epoch...
At time: 41.01423621177673 accuracy is 0.8984375 and loss is 0.24358854293823243
At time: 41.26254606246948 accuracy is 0.940625 and loss is 0.12799453735351562
At time: 41.50464344024658 accuracy is 0.978125 and loss is 0.06414356827735901
At time: 41.75357961654663 accuracy is 0.9640625 and loss is 0.10145456790924072
At time: 42.01558828353882 accuracy is 0.946875 and loss is 0.13314056396484375
At time: 42.27688002586365 accuracy is 0.9546875 and loss is 0.09545915126800537
At time: 42.54350566864014 accuracy is 0.9640625 and loss is 0.11479071378707886
At time: 42.81825113296509 accuracy is 0.95 and loss is 0.16675961017608643
At time: 43.101542711257935 accuracy is 0.9484375 and loss is 0.12569727897644042
At time: 43.39493179321289 accuracy is 0.9421875 and loss is 0.18809151649475098
At time: 43.69831466674805 accuracy is 0.9484375 and loss is 0.14763853549957276
At time: 44.021044969558716 accuracy is 0.934375 and loss is 0.1874428629875183
Evaluating...
Done Evaluating: Achieved accuracy of 0.717296511627907
Not better for 8
Completing Train Step at 11th epoch...
At time: 45.03952884674072 accuracy is 0.915625 and loss is 0.249160099029541
At time: 45.27482867240906 accuracy is 0.95625 and loss is 0.12137084007263184
At time: 45.51382899284363 accuracy is 0.975 and loss is 0.0746515929698944
At time: 45.76237368583679 accuracy is 0.959375 and loss is 0.10182479619979859
At time: 46.01861786842346 accuracy is 0.965625 and loss is 0.13288731575012208
At time: 46.27915644645691 accuracy is 0.9578125 and loss is 0.10765382051467895
At time: 46.54924011230469 accuracy is 0.9421875 and loss is 0.13528794050216675
At time: 46.82523989677429 accuracy is 0.940625 and loss is 0.18771142959594728
At time: 47.10891604423523 accuracy is 0.95625 and loss is 0.11409863233566284
At time: 47.40541172027588 accuracy is 0.9359375 and loss is 0.19776562452316285
At time: 47.7117657661438 accuracy is 0.95625 and loss is 0.15558831691741942
At time: 48.03709578514099 accuracy is 0.9703125 and loss is 0.08511375188827515
Evaluating...
Done Evaluating: Achieved accuracy of 0.7220203488372093
Not better for 9
Completing Train Step at 12th epoch...
At time: 49.062516927719116 accuracy is 0.9375 and loss is 0.19140762090682983
At time: 49.32105326652527 accuracy is 0.91875 and loss is 0.18777191638946533
At time: 49.57765865325928 accuracy is 0.94375 and loss is 0.13326195478439332
At time: 49.83479166030884 accuracy is 0.959375 and loss is 0.08703222870826721
At time: 50.090376138687134 accuracy is 0.9703125 and loss is 0.07620854377746582
At time: 50.350000619888306 accuracy is 0.953125 and loss is 0.10377159118652343
At time: 50.62062454223633 accuracy is 0.959375 and loss is 0.0773780345916748
At time: 50.90002632141113 accuracy is 0.95625 and loss is 0.13294190168380737
At time: 51.18579125404358 accuracy is 0.9625 and loss is 0.10080395936965943
At time: 51.48464894294739 accuracy is 0.95625 and loss is 0.11568200588226318
At time: 51.80960774421692 accuracy is 0.95625 and loss is 0.11951152086257935
At time: 52.13628339767456 accuracy is 0.9578125 and loss is 0.123909330368042
Evaluating...
Done Evaluating: Achieved accuracy of 0.7289244186046512
Not better for 10
Model not improving. Stopping earlyat 0.7547238372093024 epochs.
Done Training. Achieved Best Accuracy of 0.7547238372093024
mlpattn
SETTINGS FOR THIS RUN
{'tune_wordvecs': True, 'data': 'MPQA', 'wordvec_dim': 300, 'batch_size': 32, 'attn_type': 'MLP', 'lr': 0.004571058420384092, 'num_layers': 2, 'rnn_dropout': 0.1968480025158339, 'dropout': 0.22346295315353715, 'wordvec_source': 'gigavec', 'attention_dim': 82, 'l2': 0.49363907169406007}
Using CUDA!
here
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['gigavec']
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fb4eecc92b0>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'hidden_size': 300, 'input_size': 300, 'batch_size': 32, 'num_layers': 2, 'tune_attn': 'True', 'train_word_vecs': True, 'rnn_dropout': 0.1968480025158339, 'vocab_size': 15284, 'dropout': 0.22346295315353715, 'attention_dim': 82, 'cuda': True, 'attn_type': 'MLP', 'num_classes': 2}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.29777097702026367 accuracy is 0.571875 and loss is 0.7347372531890869
At time: 0.5746126174926758 accuracy is 0.559375 and loss is 0.7152692794799804
At time: 0.8545126914978027 accuracy is 0.6015625 and loss is 0.6972508430480957
At time: 1.138533115386963 accuracy is 0.5328125 and loss is 0.7256899833679199
At time: 1.4321231842041016 accuracy is 0.653125 and loss is 0.6302550792694092
At time: 1.7399675846099854 accuracy is 0.6859375 and loss is 0.6664749145507812
At time: 2.05426025390625 accuracy is 0.68125 and loss is 0.605484914779663
At time: 2.3803460597991943 accuracy is 0.6984375 and loss is 0.5885446071624756
At time: 2.71624493598938 accuracy is 0.728125 and loss is 0.5537898063659668
At time: 3.063403367996216 accuracy is 0.7234375 and loss is 0.5489192962646484
At time: 3.429701089859009 accuracy is 0.746875 and loss is 0.5704558372497559
At time: 3.8246710300445557 accuracy is 0.7234375 and loss is 0.6082152366638184
Evaluating...
Done Evaluating: Achieved accuracy of 0.7111191860465116
Achieved new best!
Completing Train Step at 1th epoch...
At time: 4.923869371414185 accuracy is 0.596875 and loss is 0.7076259136199952
At time: 5.162015914916992 accuracy is 0.73125 and loss is 0.5102457046508789
At time: 5.406387805938721 accuracy is 0.790625 and loss is 0.4715087890625
At time: 5.6738951206207275 accuracy is 0.759375 and loss is 0.4955445289611816
At time: 5.940027475357056 accuracy is 0.84375 and loss is 0.3945340633392334
At time: 6.21084451675415 accuracy is 0.8140625 and loss is 0.4543888092041016
At time: 6.484485864639282 accuracy is 0.83125 and loss is 0.3791704893112183
At time: 6.769824981689453 accuracy is 0.8078125 and loss is 0.44813952445983884
At time: 7.059577226638794 accuracy is 0.840625 and loss is 0.36479721069335935
At time: 7.359253406524658 accuracy is 0.8484375 and loss is 0.3539119243621826
At time: 7.66986083984375 accuracy is 0.8484375 and loss is 0.36142141819000245
At time: 7.99713921546936 accuracy is 0.8125 and loss is 0.4158607482910156
Evaluating...
Done Evaluating: Achieved accuracy of 0.65625
Not better for 1
Completing Train Step at 2th epoch...
At time: 9.024421691894531 accuracy is 0.6671875 and loss is 0.6388593673706054
At time: 9.265970706939697 accuracy is 0.86875 and loss is 0.3415844440460205
At time: 9.511514902114868 accuracy is 0.8453125 and loss is 0.35265839099884033
At time: 9.760001182556152 accuracy is 0.8671875 and loss is 0.33818821907043456
At time: 10.024023294448853 accuracy is 0.909375 and loss is 0.2523274183273315
At time: 10.29004192352295 accuracy is 0.878125 and loss is 0.32507336139678955
At time: 10.562129259109497 accuracy is 0.871875 and loss is 0.30016460418701174
At time: 10.840094566345215 accuracy is 0.853125 and loss is 0.34012727737426757
At time: 11.126415729522705 accuracy is 0.86875 and loss is 0.27276561260223386
At time: 11.42172122001648 accuracy is 0.9 and loss is 0.24329681396484376
At time: 11.728812456130981 accuracy is 0.9046875 and loss is 0.2722438097000122
At time: 12.05297327041626 accuracy is 0.8421875 and loss is 0.37858991622924804
Evaluating...
Done Evaluating: Achieved accuracy of 0.7318313953488372
Achieved new best!
Completing Train Step at 3th epoch...
At time: 13.061038970947266 accuracy is 0.671875 and loss is 0.5853196620941162
At time: 13.294724941253662 accuracy is 0.9078125 and loss is 0.2586063385009766
At time: 13.537442922592163 accuracy is 0.90625 and loss is 0.25463042259216306
At time: 13.788492918014526 accuracy is 0.8375 and loss is 0.4494283676147461
At time: 14.046337604522705 accuracy is 0.8921875 and loss is 0.2894745349884033
At time: 14.312062978744507 accuracy is 0.9109375 and loss is 0.23945949077606202
At time: 14.587610006332397 accuracy is 0.8875 and loss is 0.28419134616851804
At time: 14.868485689163208 accuracy is 0.8921875 and loss is 0.2557896852493286
At time: 15.158026695251465 accuracy is 0.9078125 and loss is 0.20567646026611328
At time: 15.457799673080444 accuracy is 0.90625 and loss is 0.21389811038970946
At time: 15.770288467407227 accuracy is 0.9171875 and loss is 0.22065505981445313
At time: 16.100979804992676 accuracy is 0.8828125 and loss is 0.3349161148071289
Evaluating...
Done Evaluating: Achieved accuracy of 0.731468023255814
Not better for 1
Completing Train Step at 4th epoch...
At time: 17.115803956985474 accuracy is 0.8859375 and loss is 0.3865553140640259
At time: 17.350290536880493 accuracy is 0.9515625 and loss is 0.16842467784881593
At time: 17.592895984649658 accuracy is 0.9171875 and loss is 0.3328902006149292
At time: 17.842960834503174 accuracy is 0.9125 and loss is 0.19246536493301392
At time: 18.095377445220947 accuracy is 0.925 and loss is 0.19450443983078003
At time: 18.35486125946045 accuracy is 0.9359375 and loss is 0.17495441436767578
At time: 18.623474597930908 accuracy is 0.928125 and loss is 0.20146288871765136
At time: 18.899422883987427 accuracy is 0.9109375 and loss is 0.22406926155090331
At time: 19.18370509147644 accuracy is 0.9359375 and loss is 0.1625737428665161
At time: 19.4792697429657 accuracy is 0.940625 and loss is 0.15877901315689086
At time: 19.78957962989807 accuracy is 0.9171875 and loss is 0.20184471607208251
At time: 20.114001750946045 accuracy is 0.9078125 and loss is 0.2679098129272461
Evaluating...
Done Evaluating: Achieved accuracy of 0.7111191860465116
Not better for 2
Completing Train Step at 5th epoch...
At time: 21.097424507141113 accuracy is 0.853125 and loss is 0.43708086013793945
At time: 21.32557249069214 accuracy is 0.9359375 and loss is 0.1975316047668457
At time: 21.564391136169434 accuracy is 0.9359375 and loss is 0.17001389265060424
At time: 21.810248374938965 accuracy is 0.9203125 and loss is 0.2662393808364868
At time: 22.06376552581787 accuracy is 0.925 and loss is 0.20931901931762695
At time: 22.324568510055542 accuracy is 0.95 and loss is 0.15725748538970946
At time: 22.59260582923889 accuracy is 0.946875 and loss is 0.12798826694488524
At time: 22.869547605514526 accuracy is 0.921875 and loss is 0.22516274452209473
At time: 23.15497064590454 accuracy is 0.940625 and loss is 0.1446157932281494
At time: 23.450321197509766 accuracy is 0.953125 and loss is 0.12069668769836425
At time: 23.7572078704834 accuracy is 0.9515625 and loss is 0.1265313982963562
At time: 24.080354690551758 accuracy is 0.9203125 and loss is 0.23815383911132812
Evaluating...
Done Evaluating: Achieved accuracy of 0.7336482558139535
Achieved new best!
Completing Train Step at 6th epoch...
At time: 25.061015367507935 accuracy is 0.909375 and loss is 0.3062382698059082
At time: 25.29059147834778 accuracy is 0.9421875 and loss is 0.17264052629470825
At time: 25.528819799423218 accuracy is 0.9203125 and loss is 0.24481403827667236
At time: 25.77399230003357 accuracy is 0.9453125 and loss is 0.14475349187850953
At time: 26.023412227630615 accuracy is 0.934375 and loss is 0.16767033338546752
At time: 26.28133988380432 accuracy is 0.9359375 and loss is 0.16613703966140747
At time: 26.54804491996765 accuracy is 0.9453125 and loss is 0.15382853746414185
At time: 26.821313619613647 accuracy is 0.940625 and loss is 0.15537374019622802
At time: 27.102389097213745 accuracy is 0.959375 and loss is 0.10543240308761596
At time: 27.394484758377075 accuracy is 0.946875 and loss is 0.13837770223617554
At time: 27.702287673950195 accuracy is 0.91875 and loss is 0.1928577184677124
At time: 28.02570152282715 accuracy is 0.9328125 and loss is 0.1985352158546448
Evaluating...
Done Evaluating: Achieved accuracy of 0.7111191860465116
Not better for 1
Completing Train Step at 7th epoch...
At time: 29.00999355316162 accuracy is 0.896875 and loss is 0.31739580631256104
At time: 29.23943328857422 accuracy is 0.9234375 and loss is 0.1969449281692505
At time: 29.477696657180786 accuracy is 0.9359375 and loss is 0.17440489530563355
At time: 29.72252321243286 accuracy is 0.953125 and loss is 0.13055516481399537
At time: 29.97686243057251 accuracy is 0.94375 and loss is 0.14510551691055298
At time: 30.23856210708618 accuracy is 0.946875 and loss is 0.1505555033683777
At time: 30.50709557533264 accuracy is 0.9421875 and loss is 0.1387626051902771
At time: 30.782960414886475 accuracy is 0.940625 and loss is 0.1325026273727417
At time: 31.070098638534546 accuracy is 0.94375 and loss is 0.15529435873031616
At time: 31.36695909500122 accuracy is 0.9546875 and loss is 0.09345396161079407
At time: 31.67628788948059 accuracy is 0.9671875 and loss is 0.08362473249435425
At time: 32.001123666763306 accuracy is 0.946875 and loss is 0.1608515739440918
Evaluating...
Done Evaluating: Achieved accuracy of 0.7136627906976745
Not better for 2
Completing Train Step at 8th epoch...
At time: 32.97833585739136 accuracy is 0.8984375 and loss is 0.24050867557525635
At time: 33.20421648025513 accuracy is 0.93125 and loss is 0.19550191164016723
At time: 33.440576791763306 accuracy is 0.9296875 and loss is 0.161362624168396
At time: 33.69770002365112 accuracy is 0.9421875 and loss is 0.13864146471023558
At time: 33.96603512763977 accuracy is 0.953125 and loss is 0.12337278127670288
At time: 34.23081827163696 accuracy is 0.9609375 and loss is 0.10020635128021241
At time: 34.50126552581787 accuracy is 0.953125 and loss is 0.14447041749954223
At time: 34.777677059173584 accuracy is 0.959375 and loss is 0.10551679134368896
At time: 35.06130075454712 accuracy is 0.965625 and loss is 0.09329153895378113
At time: 35.354729890823364 accuracy is 0.9640625 and loss is 0.09548233151435852
At time: 35.66101384162903 accuracy is 0.953125 and loss is 0.12514739036560057
At time: 35.98458480834961 accuracy is 0.9484375 and loss is 0.1619622826576233
Evaluating...
Done Evaluating: Achieved accuracy of 0.7242005813953488
Not better for 3
Completing Train Step at 9th epoch...
At time: 36.98324513435364 accuracy is 0.940625 and loss is 0.18859878778457642
At time: 37.21937298774719 accuracy is 0.9453125 and loss is 0.15845739841461182
At time: 37.4612238407135 accuracy is 0.9390625 and loss is 0.15605447292327881
At time: 37.707700967788696 accuracy is 0.9421875 and loss is 0.14010310173034668
At time: 37.96136736869812 accuracy is 0.9296875 and loss is 0.16729387044906616
At time: 38.22382211685181 accuracy is 0.9203125 and loss is 0.228728985786438
At time: 38.49266529083252 accuracy is 0.9078125 and loss is 0.2596359014511108
At time: 38.77036190032959 accuracy is 0.934375 and loss is 0.16587440967559813
At time: 39.05637454986572 accuracy is 0.95 and loss is 0.114955472946167
At time: 39.3555052280426 accuracy is 0.9328125 and loss is 0.22725343704223633
At time: 39.666489362716675 accuracy is 0.896875 and loss is 0.2859741449356079
At time: 39.99028301239014 accuracy is 0.9453125 and loss is 0.18370966911315917
Evaluating...
Done Evaluating: Achieved accuracy of 0.7274709302325582
Not better for 4
Completing Train Step at 10th epoch...
At time: 40.979575395584106 accuracy is 0.9390625 and loss is 0.19321335554122926
At time: 41.21062684059143 accuracy is 0.9296875 and loss is 0.1720552086830139
At time: 41.45387005805969 accuracy is 0.9375 and loss is 0.14786866903305054
At time: 41.704108238220215 accuracy is 0.953125 and loss is 0.10421525239944458
At time: 41.96223974227905 accuracy is 0.953125 and loss is 0.10368431806564331
At time: 42.22644114494324 accuracy is 0.9453125 and loss is 0.12110432386398315
At time: 42.50043320655823 accuracy is 0.9375 and loss is 0.19136735200881957
At time: 42.781763792037964 accuracy is 0.9515625 and loss is 0.11275376081466675
At time: 43.07490849494934 accuracy is 0.959375 and loss is 0.10233657360076905
At time: 43.37311005592346 accuracy is 0.9375 and loss is 0.1587339997291565
At time: 43.69908690452576 accuracy is 0.94375 and loss is 0.15278589725494385
At time: 44.03720211982727 accuracy is 0.9203125 and loss is 0.18003525733947753
Evaluating...
Done Evaluating: Achieved accuracy of 0.7089389534883721
Not better for 5
Completing Train Step at 11th epoch...
At time: 45.04731202125549 accuracy is 0.9203125 and loss is 0.21440646648406983
At time: 45.28056263923645 accuracy is 0.940625 and loss is 0.15500279664993286
At time: 45.521798610687256 accuracy is 0.9484375 and loss is 0.13123761415481566
At time: 45.77367854118347 accuracy is 0.953125 and loss is 0.11467770338058472
At time: 46.04537487030029 accuracy is 0.9390625 and loss is 0.126861047744751
At time: 46.31881093978882 accuracy is 0.93125 and loss is 0.18907589912414552
At time: 46.59697508811951 accuracy is 0.93125 and loss is 0.23338394165039061
At time: 46.875529766082764 accuracy is 0.9125 and loss is 0.2220902681350708
At time: 47.162776947021484 accuracy is 0.9546875 and loss is 0.11515226364135742
At time: 47.459959268569946 accuracy is 0.9484375 and loss is 0.14434586763381957
At time: 47.768765926361084 accuracy is 0.95625 and loss is 0.11512811183929443
At time: 48.09709978103638 accuracy is 0.928125 and loss is 0.18652065992355346
Evaluating...
Done Evaluating: Achieved accuracy of 0.7223837209302325
Not better for 6
Completing Train Step at 12th epoch...
At time: 49.08758616447449 accuracy is 0.9359375 and loss is 0.17871532440185547
At time: 49.3217887878418 accuracy is 0.9375 and loss is 0.16790916919708251
At time: 49.564608573913574 accuracy is 0.9265625 and loss is 0.1730656862258911
At time: 49.81452178955078 accuracy is 0.8796875 and loss is 0.3636746644973755
At time: 50.07075643539429 accuracy is 0.9015625 and loss is 0.20874605178833008
At time: 50.3323175907135 accuracy is 0.9484375 and loss is 0.1265109658241272
At time: 50.60076904296875 accuracy is 0.94375 and loss is 0.1479400396347046
At time: 50.882105350494385 accuracy is 0.96875 and loss is 0.10084621906280518
At time: 51.180535554885864 accuracy is 0.9578125 and loss is 0.10736116170883178
At time: 51.48176908493042 accuracy is 0.93125 and loss is 0.18219650983810426
At time: 51.791762351989746 accuracy is 0.9671875 and loss is 0.08449015617370606
At time: 52.115556955337524 accuracy is 0.940625 and loss is 0.16638331413269042
Evaluating...
Done Evaluating: Achieved accuracy of 0.7067587209302325
Not better for 7
Completing Train Step at 13th epoch...
At time: 53.104453802108765 accuracy is 0.9375 and loss is 0.15009931325912476
At time: 53.33433270454407 accuracy is 0.915625 and loss is 0.3044654130935669
At time: 53.57290697097778 accuracy is 0.9515625 and loss is 0.15487184524536132
At time: 53.81594634056091 accuracy is 0.934375 and loss is 0.16693947315216065
At time: 54.06987762451172 accuracy is 0.9640625 and loss is 0.09215129017829896
At time: 54.33726477622986 accuracy is 0.934375 and loss is 0.16556525230407715
At time: 54.6107075214386 accuracy is 0.9234375 and loss is 0.22524685859680177
At time: 54.88952159881592 accuracy is 0.9515625 and loss is 0.14266047477722169
At time: 55.17627263069153 accuracy is 0.965625 and loss is 0.09569355845451355
At time: 55.471678733825684 accuracy is 0.9734375 and loss is 0.08518936038017273
At time: 55.77933406829834 accuracy is 0.9703125 and loss is 0.07366551756858826
At time: 56.1041259765625 accuracy is 0.940625 and loss is 0.1642412066459656
Evaluating...
Done Evaluating: Achieved accuracy of 0.6853197674418605
Not better for 8
Completing Train Step at 14th epoch...
At time: 57.10704684257507 accuracy is 0.9109375 and loss is 0.20185472965240478
At time: 57.34317111968994 accuracy is 0.9125 and loss is 0.2603283405303955
At time: 57.58527898788452 accuracy is 0.94375 and loss is 0.1305173873901367
At time: 57.83696174621582 accuracy is 0.915625 and loss is 0.22143325805664063
At time: 58.095415353775024 accuracy is 0.9421875 and loss is 0.12918912172317504
At time: 58.362872838974 accuracy is 0.95625 and loss is 0.11955628395080567
At time: 58.63900828361511 accuracy is 0.9234375 and loss is 0.2235325813293457
At time: 58.91840887069702 accuracy is 0.9484375 and loss is 0.16330829858779908
At time: 59.20718955993652 accuracy is 0.953125 and loss is 0.12167813777923583
At time: 59.50597524642944 accuracy is 0.959375 and loss is 0.12530192136764526
At time: 59.81705093383789 accuracy is 0.9609375 and loss is 0.10797241926193238
At time: 60.145395040512085 accuracy is 0.940625 and loss is 0.2259746789932251
Evaluating...
Done Evaluating: Achieved accuracy of 0.7227470930232558
Not better for 9
Completing Train Step at 15th epoch...
At time: 61.13980412483215 accuracy is 0.946875 and loss is 0.15001986026763917
At time: 61.36700797080994 accuracy is 0.9390625 and loss is 0.15387518405914308
At time: 61.60498785972595 accuracy is 0.940625 and loss is 0.18766298294067382
At time: 61.85436272621155 accuracy is 0.9515625 and loss is 0.142905330657959
At time: 62.110657691955566 accuracy is 0.9453125 and loss is 0.12604657411575318
At time: 62.37506818771362 accuracy is 0.8859375 and loss is 0.2975499391555786
At time: 62.64831566810608 accuracy is 0.9375 and loss is 0.17298586368560792
At time: 62.92906999588013 accuracy is 0.940625 and loss is 0.1625601530075073
At time: 63.217347860336304 accuracy is 0.9359375 and loss is 0.16087366342544557
At time: 63.51746940612793 accuracy is 0.89375 and loss is 0.3283488035202026
At time: 63.829516887664795 accuracy is 0.94375 and loss is 0.14341355562210084
At time: 64.1586263179779 accuracy is 0.9421875 and loss is 0.23269102573394776
Evaluating...
Done Evaluating: Achieved accuracy of 0.7005813953488372
Not better for 10
Model not improving. Stopping earlyat 0.7336482558139535 epochs.
Done Training. Achieved Best Accuracy of 0.7336482558139535
mlpattn
SETTINGS FOR THIS RUN
{'tune_wordvecs': True, 'data': 'MPQA', 'wordvec_dim': 300, 'batch_size': 32, 'attn_type': 'MLP', 'lr': 0.0021344946467176506, 'num_layers': 2, 'rnn_dropout': 0.07719192028439226, 'dropout': 0.7859828176049005, 'wordvec_source': 'gigavec', 'attention_dim': 10, 'l2': 0.6885667575901503}
Using CUDA!
here
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['gigavec']
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fb4e77ab4a8>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'hidden_size': 300, 'input_size': 300, 'batch_size': 32, 'num_layers': 2, 'tune_attn': 'True', 'train_word_vecs': True, 'rnn_dropout': 0.07719192028439226, 'vocab_size': 15284, 'dropout': 0.7859828176049005, 'attention_dim': 10, 'cuda': True, 'attn_type': 'MLP', 'num_classes': 2}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.28029656410217285 accuracy is 0.546875 and loss is 0.7314311027526855
At time: 0.5389506816864014 accuracy is 0.496875 and loss is 0.707437801361084
At time: 0.8091440200805664 accuracy is 0.515625 and loss is 0.6983073234558106
At time: 1.0899882316589355 accuracy is 0.5109375 and loss is 0.746150016784668
At time: 1.3807148933410645 accuracy is 0.48125 and loss is 0.7015593528747559
At time: 1.68446946144104 accuracy is 0.528125 and loss is 0.7110496997833252
At time: 2.0001258850097656 accuracy is 0.5671875 and loss is 0.7034337043762207
At time: 2.3258543014526367 accuracy is 0.5375 and loss is 0.7151251316070557
At time: 2.6663882732391357 accuracy is 0.575 and loss is 0.7088762283325195
At time: 3.0193302631378174 accuracy is 0.6 and loss is 0.6818035125732422
At time: 3.3931844234466553 accuracy is 0.646875 and loss is 0.6548248767852783
At time: 3.789485216140747 accuracy is 0.6109375 and loss is 0.6821214199066162
Evaluating...
Done Evaluating: Achieved accuracy of 0.5683139534883721
Achieved new best!
Completing Train Step at 1th epoch...
At time: 4.883122205734253 accuracy is 0.5171875 and loss is 0.7298174381256104
At time: 5.11907696723938 accuracy is 0.5578125 and loss is 0.7016186714172363
At time: 5.357529401779175 accuracy is 0.5375 and loss is 0.6899728298187255
At time: 5.603141784667969 accuracy is 0.478125 and loss is 0.7033302307128906
At time: 5.857882976531982 accuracy is 0.4921875 and loss is 0.6998612403869628
At time: 6.117368936538696 accuracy is 0.509375 and loss is 0.6972074031829834
At time: 6.400557279586792 accuracy is 0.5359375 and loss is 0.6888869285583497
At time: 6.690277099609375 accuracy is 0.534375 and loss is 0.7013851642608643
At time: 6.981255769729614 accuracy is 0.540625 and loss is 0.6934276103973389
At time: 7.283114671707153 accuracy is 0.6078125 and loss is 0.6489142894744873
At time: 7.593459844589233 accuracy is 0.6671875 and loss is 0.5986306190490722
At time: 7.921104192733765 accuracy is 0.6296875 and loss is 0.6319431781768798
Evaluating...
Done Evaluating: Achieved accuracy of 0.6929505813953488
Achieved new best!
Completing Train Step at 2th epoch...
At time: 8.9318368434906 accuracy is 0.7 and loss is 0.6654262065887451
At time: 9.165576219558716 accuracy is 0.659375 and loss is 0.6327358245849609
At time: 9.409433126449585 accuracy is 0.6375 and loss is 0.6393930435180664
At time: 9.66024398803711 accuracy is 0.75 and loss is 0.5379447937011719
At time: 9.917730808258057 accuracy is 0.75 and loss is 0.5084059715270997
At time: 10.184261798858643 accuracy is 0.7453125 and loss is 0.5068300724029541
At time: 10.45784068107605 accuracy is 0.7890625 and loss is 0.4547792911529541
At time: 10.738581657409668 accuracy is 0.7640625 and loss is 0.5414012432098388
At time: 11.026981592178345 accuracy is 0.796875 and loss is 0.4575219631195068
At time: 11.325707197189331 accuracy is 0.828125 and loss is 0.4020537376403809
At time: 11.636539220809937 accuracy is 0.7921875 and loss is 0.4658939838409424
At time: 11.959133625030518 accuracy is 0.8015625 and loss is 0.47597203254699705
Evaluating...
Done Evaluating: Achieved accuracy of 0.7561773255813954
Achieved new best!
Completing Train Step at 3th epoch...
At time: 12.945470809936523 accuracy is 0.7515625 and loss is 0.5773031711578369
At time: 13.181568384170532 accuracy is 0.7625 and loss is 0.48758387565612793
At time: 13.42579174041748 accuracy is 0.8359375 and loss is 0.40660910606384276
At time: 13.675569295883179 accuracy is 0.853125 and loss is 0.3894852876663208
At time: 13.933121919631958 accuracy is 0.8640625 and loss is 0.2976506233215332
At time: 14.197196960449219 accuracy is 0.928125 and loss is 0.2384488821029663
At time: 14.466054439544678 accuracy is 0.89375 and loss is 0.2538166046142578
At time: 14.74417233467102 accuracy is 0.825 and loss is 0.3867033958435059
At time: 15.030495643615723 accuracy is 0.8625 and loss is 0.31948294639587405
At time: 15.328089475631714 accuracy is 0.8984375 and loss is 0.24549610614776612
At time: 15.63638710975647 accuracy is 0.8921875 and loss is 0.25689425468444826
At time: 15.960811138153076 accuracy is 0.909375 and loss is 0.23564321994781495
Evaluating...
Done Evaluating: Achieved accuracy of 0.7467296511627907
Not better for 1
Completing Train Step at 4th epoch...
At time: 16.964292287826538 accuracy is 0.7609375 and loss is 0.4778605937957764
At time: 17.201829433441162 accuracy is 0.8578125 and loss is 0.3434810400009155
At time: 17.444743394851685 accuracy is 0.9 and loss is 0.25962276458740235
At time: 17.690715074539185 accuracy is 0.9 and loss is 0.2567648649215698
At time: 17.941401958465576 accuracy is 0.9203125 and loss is 0.19274909496307374
At time: 18.198829889297485 accuracy is 0.9 and loss is 0.23700213432312012
At time: 18.464550733566284 accuracy is 0.9484375 and loss is 0.1439430832862854
At time: 18.7370765209198 accuracy is 0.9078125 and loss is 0.21798648834228515
At time: 19.02007293701172 accuracy is 0.928125 and loss is 0.18735957145690918
At time: 19.312333583831787 accuracy is 0.95 and loss is 0.14832022190093994
At time: 19.618988752365112 accuracy is 0.93125 and loss is 0.15663483142852783
At time: 19.94233250617981 accuracy is 0.95625 and loss is 0.126286780834198
Evaluating...
Done Evaluating: Achieved accuracy of 0.7550872093023255
Not better for 2
Completing Train Step at 5th epoch...
At time: 20.925360679626465 accuracy is 0.8671875 and loss is 0.3730812072753906
At time: 21.155380487442017 accuracy is 0.915625 and loss is 0.22138640880584717
At time: 21.39164447784424 accuracy is 0.946875 and loss is 0.1672226071357727
At time: 21.63564896583557 accuracy is 0.9390625 and loss is 0.1799466133117676
At time: 21.887651920318604 accuracy is 0.953125 and loss is 0.11062625646591187
At time: 22.146158933639526 accuracy is 0.946875 and loss is 0.12911287546157837
At time: 22.416275024414062 accuracy is 0.9515625 and loss is 0.13194539546966552
At time: 22.693658590316772 accuracy is 0.925 and loss is 0.18634802103042603
At time: 22.977795362472534 accuracy is 0.93125 and loss is 0.19443564414978026
At time: 23.27268409729004 accuracy is 0.9328125 and loss is 0.177124285697937
At time: 23.58093523979187 accuracy is 0.940625 and loss is 0.16619691848754883
At time: 23.910199880599976 accuracy is 0.9265625 and loss is 0.18766672611236573
Evaluating...
Done Evaluating: Achieved accuracy of 0.7467296511627907
Not better for 3
Completing Train Step at 6th epoch...
At time: 24.92994785308838 accuracy is 0.90625 and loss is 0.27799763679504397
At time: 25.18068766593933 accuracy is 0.9421875 and loss is 0.15111663341522216
At time: 25.444703578948975 accuracy is 0.965625 and loss is 0.09469660520553588
At time: 25.711402893066406 accuracy is 0.9515625 and loss is 0.1340363383293152
At time: 25.972550868988037 accuracy is 0.9671875 and loss is 0.10796928405761719
At time: 26.236653089523315 accuracy is 0.91875 and loss is 0.24458439350128175
At time: 26.509891748428345 accuracy is 0.965625 and loss is 0.109578537940979
At time: 26.81413507461548 accuracy is 0.9625 and loss is 0.10590114593505859
At time: 27.11038064956665 accuracy is 0.94375 and loss is 0.14650291204452515
At time: 27.414223194122314 accuracy is 0.9625 and loss is 0.09792528152465821
At time: 27.72095823287964 accuracy is 0.9609375 and loss is 0.09447622299194336
At time: 28.043154001235962 accuracy is 0.959375 and loss is 0.11391509771347046
Evaluating...
Done Evaluating: Achieved accuracy of 0.7085755813953488
Not better for 4
Completing Train Step at 7th epoch...
At time: 29.030351877212524 accuracy is 0.8953125 and loss is 0.3023397207260132
At time: 29.268391132354736 accuracy is 0.95625 and loss is 0.1501323938369751
At time: 29.510017156600952 accuracy is 0.9703125 and loss is 0.08899915218353271
At time: 29.75288200378418 accuracy is 0.9828125 and loss is 0.052538609504699706
At time: 30.00364589691162 accuracy is 0.9765625 and loss is 0.055938971042633054
At time: 30.26215171813965 accuracy is 0.9390625 and loss is 0.21834843158721923
At time: 30.52772617340088 accuracy is 0.975 and loss is 0.08862358927726746
At time: 30.802827835083008 accuracy is 0.946875 and loss is 0.17847127914428712
At time: 31.08800435066223 accuracy is 0.9671875 and loss is 0.12325079441070556
At time: 31.383479833602905 accuracy is 0.959375 and loss is 0.09046289920806885
At time: 31.690971851348877 accuracy is 0.98125 and loss is 0.04163022637367249
At time: 32.01598024368286 accuracy is 0.9796875 and loss is 0.059140217304229734
Evaluating...
Done Evaluating: Achieved accuracy of 0.7176598837209303
Not better for 5
Completing Train Step at 8th epoch...
At time: 32.98385787010193 accuracy is 0.9125 and loss is 0.2543981075286865
At time: 33.21117186546326 accuracy is 0.971875 and loss is 0.09460596442222595
At time: 33.44555687904358 accuracy is 0.978125 and loss is 0.07365784645080567
At time: 33.69064164161682 accuracy is 0.98125 and loss is 0.06293463110923767
At time: 33.94402289390564 accuracy is 0.971875 and loss is 0.082377690076828
At time: 34.20507740974426 accuracy is 0.9515625 and loss is 0.1396886944770813
At time: 34.47272515296936 accuracy is 0.9765625 and loss is 0.05398119688034057
At time: 34.74908638000488 accuracy is 0.9671875 and loss is 0.1251336455345154
At time: 35.03383278846741 accuracy is 0.98125 and loss is 0.06497902870178222
At time: 35.328015089035034 accuracy is 0.98125 and loss is 0.05357057452201843
At time: 35.63201403617859 accuracy is 0.9953125 and loss is 0.01339845359325409
At time: 35.9551203250885 accuracy is 0.98125 and loss is 0.05110164284706116
Evaluating...
Done Evaluating: Achieved accuracy of 0.7245639534883721
Not better for 6
Completing Train Step at 9th epoch...
At time: 36.970299243927 accuracy is 0.9359375 and loss is 0.17485427856445312
At time: 37.20970869064331 accuracy is 0.96875 and loss is 0.08897857069969177
At time: 37.45349407196045 accuracy is 0.9859375 and loss is 0.047134879231452945
At time: 37.69844317436218 accuracy is 0.946875 and loss is 0.12719237804412842
At time: 37.94816446304321 accuracy is 0.98125 and loss is 0.05787164568901062
At time: 38.20863461494446 accuracy is 0.95625 and loss is 0.12312115430831909
At time: 38.47823214530945 accuracy is 0.9796875 and loss is 0.05512472987174988
At time: 38.75606560707092 accuracy is 0.971875 and loss is 0.07351707816123962
At time: 39.04504466056824 accuracy is 0.975 and loss is 0.07525835037231446
At time: 39.34184193611145 accuracy is 0.9828125 and loss is 0.04085860252380371
At time: 39.65070867538452 accuracy is 0.9890625 and loss is 0.03508858382701874
At time: 39.97574520111084 accuracy is 0.9796875 and loss is 0.05362415313720703
Evaluating...
Done Evaluating: Achieved accuracy of 0.7325581395348837
Not better for 7
Completing Train Step at 10th epoch...
At time: 40.95911455154419 accuracy is 0.9625 and loss is 0.10475418567657471
At time: 41.188791036605835 accuracy is 0.9765625 and loss is 0.05558182001113891
At time: 41.43253827095032 accuracy is 0.96875 and loss is 0.08010450005531311
At time: 41.67919874191284 accuracy is 0.9921875 and loss is 0.030012568831443785
At time: 41.9323844909668 accuracy is 0.984375 and loss is 0.03940039873123169
At time: 42.1928653717041 accuracy is 0.9875 and loss is 0.0386931985616684
At time: 42.470362424850464 accuracy is 0.975 and loss is 0.06681401133537293
At time: 42.75076866149902 accuracy is 0.9828125 and loss is 0.054200029373168944
At time: 43.03913450241089 accuracy is 0.9828125 and loss is 0.04940022528171539
At time: 43.34991717338562 accuracy is 0.9796875 and loss is 0.052861225605010984
At time: 43.66728687286377 accuracy is 0.9953125 and loss is 0.010726864635944366
At time: 44.015889167785645 accuracy is 0.9703125 and loss is 0.09266049265861512
Evaluating...
Done Evaluating: Achieved accuracy of 0.7383720930232558
Not better for 8
Completing Train Step at 11th epoch...
At time: 45.012831687927246 accuracy is 0.975 and loss is 0.09554463624954224
At time: 45.24067687988281 accuracy is 0.990625 and loss is 0.029012298583984374
At time: 45.477261543273926 accuracy is 0.9890625 and loss is 0.030271461606025694
At time: 45.72382736206055 accuracy is 0.9828125 and loss is 0.047142916917800905
At time: 45.97819209098816 accuracy is 0.98125 and loss is 0.047150784730911256
At time: 46.24058437347412 accuracy is 0.984375 and loss is 0.07318325638771057
At time: 46.519378662109375 accuracy is 0.9828125 and loss is 0.06762489080429077
At time: 46.80815815925598 accuracy is 0.9859375 and loss is 0.055861860513687134
At time: 47.09594750404358 accuracy is 0.9765625 and loss is 0.061587578058242796
At time: 47.39128279685974 accuracy is 0.990625 and loss is 0.026090943813323976
At time: 47.700007915496826 accuracy is 0.99375 and loss is 0.013746963441371917
At time: 48.02415323257446 accuracy is 0.978125 and loss is 0.07867920398712158
Evaluating...
Done Evaluating: Achieved accuracy of 0.7292877906976745
Not better for 9
Completing Train Step at 12th epoch...
At time: 49.030200481414795 accuracy is 0.959375 and loss is 0.11883780956268311
At time: 49.260990858078 accuracy is 0.9859375 and loss is 0.042421537637710574
At time: 49.501182079315186 accuracy is 0.9875 and loss is 0.02960531711578369
At time: 49.770283460617065 accuracy is 0.9828125 and loss is 0.04158623814582825
At time: 50.03683161735535 accuracy is 0.98125 and loss is 0.08385474681854248
At time: 50.30592393875122 accuracy is 0.9765625 and loss is 0.06875019073486328
At time: 50.57583236694336 accuracy is 0.9875 and loss is 0.04157717525959015
At time: 50.85220146179199 accuracy is 0.9796875 and loss is 0.054167717695236206
At time: 51.132789850234985 accuracy is 0.9765625 and loss is 0.0718260645866394
At time: 51.42403602600098 accuracy is 0.9890625 and loss is 0.024048687517642976
At time: 51.72704815864563 accuracy is 0.9859375 and loss is 0.05360528826713562
At time: 52.06491708755493 accuracy is 0.984375 and loss is 0.03966951668262482
Evaluating...
Done Evaluating: Achieved accuracy of 0.7354651162790697
Not better for 10
Model not improving. Stopping earlyat 0.7561773255813954 epochs.
Done Training. Achieved Best Accuracy of 0.7561773255813954
mlpattn
SETTINGS FOR THIS RUN
{'tune_wordvecs': True, 'data': 'MPQA', 'wordvec_dim': 300, 'batch_size': 32, 'attn_type': 'MLP', 'lr': 0.002890395723961183, 'num_layers': 2, 'rnn_dropout': 0.5415737247491599, 'dropout': 0.8477311618721647, 'wordvec_source': 'gigavec', 'attention_dim': 23, 'l2': 0.6143962452461504}
Using CUDA!
here
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['gigavec']
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7fb4ee1d9b70>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'hidden_size': 300, 'input_size': 300, 'batch_size': 32, 'num_layers': 2, 'tune_attn': 'True', 'train_word_vecs': True, 'rnn_dropout': 0.5415737247491599, 'vocab_size': 15284, 'dropout': 0.8477311618721647, 'attention_dim': 23, 'cuda': True, 'attn_type': 'MLP', 'num_classes': 2}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.2836008071899414 accuracy is 0.571875 and loss is 0.7339065551757813
At time: 0.540158748626709 accuracy is 0.4734375 and loss is 0.7113194465637207
At time: 0.8110198974609375 accuracy is 0.5921875 and loss is 0.6728841304779053
At time: 1.0895299911499023 accuracy is 0.5234375 and loss is 0.7216890335083008
At time: 1.3791899681091309 accuracy is 0.5515625 and loss is 0.6967301845550538
At time: 1.6801066398620605 accuracy is 0.58125 and loss is 0.6631256103515625
At time: 1.990157127380371 accuracy is 0.646875 and loss is 0.6652863025665283
At time: 2.3140413761138916 accuracy is 0.671875 and loss is 0.6491305828094482
At time: 2.651519298553467 accuracy is 0.7171875 and loss is 0.5656913757324219
At time: 3.004218101501465 accuracy is 0.7203125 and loss is 0.564528226852417
At time: 3.3737447261810303 accuracy is 0.76875 and loss is 0.5130884170532226
At time: 3.767347812652588 accuracy is 0.7171875 and loss is 0.5759733200073243
Evaluating...
Done Evaluating: Achieved accuracy of 0.7645348837209303
Achieved new best!
Completing Train Step at 1th epoch...
At time: 4.882931470870972 accuracy is 0.5953125 and loss is 0.7283644676208496
At time: 5.1252288818359375 accuracy is 0.7015625 and loss is 0.5826842308044433
At time: 5.37208890914917 accuracy is 0.7328125 and loss is 0.5242002487182618
At time: 5.621551990509033 accuracy is 0.7875 and loss is 0.4878856182098389
At time: 5.878527402877808 accuracy is 0.821875 and loss is 0.4109048366546631
At time: 6.139184951782227 accuracy is 0.8078125 and loss is 0.42160305976867674
At time: 6.4096550941467285 accuracy is 0.8171875 and loss is 0.4103396892547607
At time: 6.689459323883057 accuracy is 0.8359375 and loss is 0.3861271858215332
At time: 6.9785475730896 accuracy is 0.84375 and loss is 0.34483768939971926
At time: 7.276835918426514 accuracy is 0.8625 and loss is 0.3427009344100952
At time: 7.58698582649231 accuracy is 0.8734375 and loss is 0.29021449089050294
At time: 7.915629863739014 accuracy is 0.85 and loss is 0.35785694122314454
Evaluating...
Done Evaluating: Achieved accuracy of 0.7590843023255814
Not better for 1
Completing Train Step at 2th epoch...
At time: 8.927963018417358 accuracy is 0.734375 and loss is 0.5685617923736572
At time: 9.171109676361084 accuracy is 0.84375 and loss is 0.3613702058792114
At time: 9.417534112930298 accuracy is 0.8578125 and loss is 0.34513230323791505
At time: 9.663290739059448 accuracy is 0.878125 and loss is 0.2956629991531372
At time: 9.916867971420288 accuracy is 0.9140625 and loss is 0.2291111707687378
At time: 10.180383205413818 accuracy is 0.8671875 and loss is 0.3024128913879395
At time: 10.453944206237793 accuracy is 0.890625 and loss is 0.2783597230911255
At time: 10.73624587059021 accuracy is 0.8625 and loss is 0.31016130447387696
At time: 11.025115966796875 accuracy is 0.875 and loss is 0.29100499153137205
At time: 11.324418306350708 accuracy is 0.8828125 and loss is 0.3135660171508789
At time: 11.635262250900269 accuracy is 0.871875 and loss is 0.28169424533843995
At time: 11.963785648345947 accuracy is 0.8265625 and loss is 0.38159043788909913
Evaluating...
Done Evaluating: Achieved accuracy of 0.7347383720930233
Not better for 2
Completing Train Step at 3th epoch...
At time: 12.99820852279663 accuracy is 0.8140625 and loss is 0.4610148906707764
At time: 13.246454000473022 accuracy is 0.8875 and loss is 0.27716522216796874
At time: 13.495148420333862 accuracy is 0.878125 and loss is 0.29330875873565676
At time: 13.746920108795166 accuracy is 0.89375 and loss is 0.3046929359436035
At time: 14.005092144012451 accuracy is 0.9375 and loss is 0.16501747369766234
At time: 14.26889181137085 accuracy is 0.9203125 and loss is 0.19938890933990477
At time: 14.542437076568604 accuracy is 0.91875 and loss is 0.21547219753265381
At time: 14.824382066726685 accuracy is 0.9 and loss is 0.23312594890594482
At time: 15.114153146743774 accuracy is 0.928125 and loss is 0.1896523118019104
At time: 15.411670684814453 accuracy is 0.91875 and loss is 0.2215658903121948
At time: 15.722958326339722 accuracy is 0.8859375 and loss is 0.2408250093460083
At time: 16.050438404083252 accuracy is 0.890625 and loss is 0.2579624176025391
Evaluating...
Done Evaluating: Achieved accuracy of 0.7296511627906976
Not better for 3
Completing Train Step at 4th epoch...
At time: 17.05534338951111 accuracy is 0.7625 and loss is 0.523053503036499
At time: 17.284358978271484 accuracy is 0.878125 and loss is 0.2928274631500244
At time: 17.5209481716156 accuracy is 0.8921875 and loss is 0.2500772476196289
At time: 17.765868425369263 accuracy is 0.9140625 and loss is 0.20296897888183593
At time: 18.017693519592285 accuracy is 0.9421875 and loss is 0.14123427867889404
At time: 18.276716232299805 accuracy is 0.8671875 and loss is 0.34263651371002196
At time: 18.540874242782593 accuracy is 0.91875 and loss is 0.21324050426483154
At time: 18.812994956970215 accuracy is 0.9140625 and loss is 0.20616343021392822
At time: 19.100383520126343 accuracy is 0.9390625 and loss is 0.14121633768081665
At time: 19.407686233520508 accuracy is 0.94375 and loss is 0.15109047889709473
At time: 19.727088928222656 accuracy is 0.9125 and loss is 0.22092156410217284
At time: 20.054256677627563 accuracy is 0.8828125 and loss is 0.2656982898712158
Evaluating...
Done Evaluating: Achieved accuracy of 0.7096656976744186
Not better for 4
Completing Train Step at 5th epoch...
At time: 21.059640884399414 accuracy is 0.8484375 and loss is 0.405161190032959
At time: 21.29469585418701 accuracy is 0.9046875 and loss is 0.23325073719024658
At time: 21.544132471084595 accuracy is 0.9171875 and loss is 0.18224345445632933
At time: 21.825456857681274 accuracy is 0.95625 and loss is 0.1290966749191284
At time: 22.10600209236145 accuracy is 0.9359375 and loss is 0.2168489933013916
At time: 22.37757706642151 accuracy is 0.8703125 and loss is 0.34594159126281737
At time: 22.649689197540283 accuracy is 0.9171875 and loss is 0.20619382858276367
At time: 22.92790913581848 accuracy is 0.9328125 and loss is 0.1761839747428894
At time: 23.221933841705322 accuracy is 0.9328125 and loss is 0.16652133464813232
At time: 23.518811225891113 accuracy is 0.940625 and loss is 0.16671404838562012
At time: 23.827277421951294 accuracy is 0.946875 and loss is 0.1330217480659485
At time: 24.15433955192566 accuracy is 0.8796875 and loss is 0.33473660945892336
Evaluating...
Done Evaluating: Achieved accuracy of 0.7351017441860465
Not better for 5
Completing Train Step at 6th epoch...
At time: 25.161844491958618 accuracy is 0.8359375 and loss is 0.39260544776916506
At time: 25.39467144012451 accuracy is 0.909375 and loss is 0.23118443489074708
At time: 25.633695125579834 accuracy is 0.9375 and loss is 0.16400591135025025
At time: 25.879968881607056 accuracy is 0.9546875 and loss is 0.12897979021072387
At time: 26.13589882850647 accuracy is 0.9390625 and loss is 0.1872294545173645
At time: 26.400057792663574 accuracy is 0.9046875 and loss is 0.2670660257339478
At time: 26.672608613967896 accuracy is 0.9 and loss is 0.2689188003540039
At time: 26.949721097946167 accuracy is 0.928125 and loss is 0.23170058727264403
At time: 27.238062858581543 accuracy is 0.940625 and loss is 0.14460102319717408
At time: 27.539249897003174 accuracy is 0.909375 and loss is 0.24259583950042723
At time: 27.850796937942505 accuracy is 0.925 and loss is 0.17715898752212525
At time: 28.180549144744873 accuracy is 0.925 and loss is 0.24509496688842775
Evaluating...
Done Evaluating: Achieved accuracy of 0.7249273255813954
Not better for 6
Completing Train Step at 7th epoch...
At time: 29.1950740814209 accuracy is 0.875 and loss is 0.31983323097229005
At time: 29.429938077926636 accuracy is 0.884375 and loss is 0.28100316524505614
At time: 29.672235250473022 accuracy is 0.9265625 and loss is 0.17901551723480225
At time: 29.919336318969727 accuracy is 0.946875 and loss is 0.13427181243896485
At time: 30.176198720932007 accuracy is 0.9421875 and loss is 0.1395557165145874
At time: 30.434233903884888 accuracy is 0.946875 and loss is 0.13917597532272338
At time: 30.70439314842224 accuracy is 0.95625 and loss is 0.1142474889755249
At time: 30.98453688621521 accuracy is 0.925 and loss is 0.20401451587677003
At time: 31.276930570602417 accuracy is 0.934375 and loss is 0.19461952447891234
At time: 31.5734121799469 accuracy is 0.9546875 and loss is 0.10866848230361939
At time: 31.88406276702881 accuracy is 0.94375 and loss is 0.15321727991104125
At time: 32.21369695663452 accuracy is 0.9375 and loss is 0.1828294038772583
Evaluating...
Done Evaluating: Achieved accuracy of 0.7049418604651163
Not better for 7
Completing Train Step at 8th epoch...
At time: 33.225533962249756 accuracy is 0.878125 and loss is 0.291055703163147
At time: 33.46157956123352 accuracy is 0.9125 and loss is 0.20175743103027344
At time: 33.70416212081909 accuracy is 0.9515625 and loss is 0.13200045824050904
At time: 33.94753050804138 accuracy is 0.953125 and loss is 0.10475579500198365
At time: 34.22072196006775 accuracy is 0.9546875 and loss is 0.10977754592895508
At time: 34.506014585494995 accuracy is 0.9546875 and loss is 0.1143033742904663
At time: 34.77398896217346 accuracy is 0.953125 and loss is 0.13745930194854736
At time: 35.05111265182495 accuracy is 0.953125 and loss is 0.12869406938552858
At time: 35.341721057891846 accuracy is 0.9546875 and loss is 0.14401642084121705
At time: 35.63985347747803 accuracy is 0.965625 and loss is 0.09875025153160095
At time: 35.948745012283325 accuracy is 0.915625 and loss is 0.2318350076675415
At time: 36.27371263504028 accuracy is 0.934375 and loss is 0.17954699993133544
Evaluating...
Done Evaluating: Achieved accuracy of 0.7321947674418605
Not better for 8
Completing Train Step at 9th epoch...
At time: 37.25788974761963 accuracy is 0.8671875 and loss is 0.30484418869018554
At time: 37.488548278808594 accuracy is 0.9 and loss is 0.23517539501190185
At time: 37.72693657875061 accuracy is 0.959375 and loss is 0.10224319696426391
At time: 37.97761797904968 accuracy is 0.95 and loss is 0.13684080839157103
At time: 38.23953437805176 accuracy is 0.9546875 and loss is 0.11645383834838867
At time: 38.505138635635376 accuracy is 0.91875 and loss is 0.23757314682006836
At time: 38.787094593048096 accuracy is 0.94375 and loss is 0.16245815753936768
At time: 39.07331585884094 accuracy is 0.94375 and loss is 0.1728478789329529
At time: 39.364824295043945 accuracy is 0.9640625 and loss is 0.095536208152771
At time: 39.663453578948975 accuracy is 0.9578125 and loss is 0.0940315842628479
At time: 39.972572326660156 accuracy is 0.9546875 and loss is 0.10008817911148071
At time: 40.3008291721344 accuracy is 0.9671875 and loss is 0.09267814755439759
Evaluating...
Done Evaluating: Achieved accuracy of 0.7281976744186046
Not better for 9
Completing Train Step at 10th epoch...
At time: 41.31008815765381 accuracy is 0.9015625 and loss is 0.2592945575714111
At time: 41.54831004142761 accuracy is 0.921875 and loss is 0.2044797420501709
At time: 41.793155670166016 accuracy is 0.953125 and loss is 0.11572872400283814
At time: 42.04177761077881 accuracy is 0.953125 and loss is 0.10909311771392823
At time: 42.296438455581665 accuracy is 0.9609375 and loss is 0.10224999189376831
At time: 42.55838394165039 accuracy is 0.95625 and loss is 0.12771435976028442
At time: 42.829846143722534 accuracy is 0.94375 and loss is 0.14383925199508668
At time: 43.11015319824219 accuracy is 0.9703125 and loss is 0.09763522148132324
At time: 43.399811029434204 accuracy is 0.96875 and loss is 0.10731207132339478
At time: 43.698238134384155 accuracy is 0.9734375 and loss is 0.08207124471664429
At time: 44.00790619850159 accuracy is 0.9546875 and loss is 0.10685913562774658
At time: 44.332335233688354 accuracy is 0.9328125 and loss is 0.19499157667160033
Evaluating...
Done Evaluating: Achieved accuracy of 0.7311046511627907
Not better for 10
Model not improving. Stopping earlyat 0.7645348837209303 epochs.
Done Training. Achieved Best Accuracy of 0.7645348837209303
mlpattn



RESULTS:
[{'best_accuracy': 0.7659883720930233, 'params': {'tune_wordvecs': True, 'data': 'MPQA', 'wordvec_dim': 300, 'batch_size': 32, 'attn_type': 'MLP', 'lr': 0.0032841481931933057, 'num_layers': 2, 'rnn_dropout': 0.6108291237364665, 'dropout': 0.6935883145489438, 'wordvec_source': 'gigavec', 'attention_dim': 51, 'l2': 0.2706927771405857}}, {'best_accuracy': 0.7547238372093024, 'params': {'tune_wordvecs': True, 'data': 'MPQA', 'wordvec_dim': 300, 'batch_size': 32, 'attn_type': 'MLP', 'lr': 0.002899477338041026, 'num_layers': 2, 'rnn_dropout': 0.04977555262234046, 'dropout': 0.9713428067963789, 'wordvec_source': 'gigavec', 'attention_dim': 68, 'l2': 0.20087889736130604}}, {'best_accuracy': 0.7336482558139535, 'params': {'tune_wordvecs': True, 'data': 'MPQA', 'wordvec_dim': 300, 'batch_size': 32, 'attn_type': 'MLP', 'lr': 0.004571058420384092, 'num_layers': 2, 'rnn_dropout': 0.1968480025158339, 'dropout': 0.22346295315353715, 'wordvec_source': 'gigavec', 'attention_dim': 82, 'l2': 0.49363907169406007}}, {'best_accuracy': 0.7561773255813954, 'params': {'tune_wordvecs': True, 'data': 'MPQA', 'wordvec_dim': 300, 'batch_size': 32, 'attn_type': 'MLP', 'lr': 0.0021344946467176506, 'num_layers': 2, 'rnn_dropout': 0.07719192028439226, 'dropout': 0.7859828176049005, 'wordvec_source': 'gigavec', 'attention_dim': 10, 'l2': 0.6885667575901503}}, {'best_accuracy': 0.7645348837209303, 'params': {'tune_wordvecs': True, 'data': 'MPQA', 'wordvec_dim': 300, 'batch_size': 32, 'attn_type': 'MLP', 'lr': 0.002890395723961183, 'num_layers': 2, 'rnn_dropout': 0.5415737247491599, 'dropout': 0.8477311618721647, 'wordvec_source': 'gigavec', 'attention_dim': 23, 'l2': 0.6143962452461504}}]
