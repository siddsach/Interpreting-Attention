ROOT_PATH: /home-nfs/siddsach/ml/Interpreting-Attention
Building Bayesian Optimizer for 
 data:MPQA 
 choices:[{'domain': [5e-05, 0.005], 'name': 'lr', 'type': 'continuous'}, {'domain': [0, 1], 'name': 'rnn_dropout', 'type': 'continuous'}, {'domain': [0, 1], 'name': 'dropout', 'type': 'continuous'}, {'domain': [0, 1], 'name': 'l2', 'type': 'continuous'}, {'domain': [5, 100], 'name': 'attention_dim', 'type': 'continuous'}]
SETTINGS FOR THIS RUN
{'wordvec_dim': 300, 'attention_dim': 49, 'num_layers': 1, 'hidden_size': 300, 'wordvec_source': 'None', 'batch_size': 64, 'lr': 0.0020792530633072207, 'pretrained': None, 'fix_pretrained': None, 'attn_type': 'MLP', 'l2': 0.8390095297425773, 'tune_wordvecs': True, 'rnn_dropout': 0.9828107957486674, 'dropout': 0.18048291831925622}
Using CUDA!
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Not using pretrained wordvectors
Building Vocab...
[]
Getting Batches...
Created Iterator with 140 batches
Getting Batches...
Created Iterator with 47 batches
Building model...
MLP
Using Attention model with following args:
{'attn_type': 'MLP', 'tune_attn': 'True', 'num_classes': 2, 'attention_dim': 49, 'num_layers': 1, 'cuda': True, 'hidden_size': 300, 'batch_size': 64, 'train_word_vecs': True, 'vectors': None, 'rnn_dropout': 0.9828107957486674, 'dropout': 0.18048291831925622, 'vocab_size': 16598, 'input_size': 300}
Begin Training...
Completing Train Step at 0th epoch...
At time: 1.267622470855713 accuracy is 0.5859375 and loss is 0.7125931739807129
At time: 1.570814609527588 accuracy is 0.58359375 and loss is 0.6544425964355469
At time: 1.8764655590057373 accuracy is 0.71484375 and loss is 0.563479995727539
At time: 2.181872606277466 accuracy is 0.765625 and loss is 0.5458193778991699
At time: 2.500145435333252 accuracy is 0.8015625 and loss is 0.4452526092529297
At time: 2.8400626182556152 accuracy is 0.80859375 and loss is 0.43085408210754395
Evaluating...
Done Evaluating: Achieved accuracy of 0.45584239130434784
Achieved new best!
Completing Train Step at 1th epoch...
At time: 3.776824712753296 accuracy is 0.846875 and loss is 0.5002390384674072
At time: 4.061951637268066 accuracy is 0.878125 and loss is 0.3130537748336792
At time: 4.355676889419556 accuracy is 0.8828125 and loss is 0.2852856397628784
At time: 4.66736102104187 accuracy is 0.85 and loss is 0.3139012813568115
At time: 4.994067907333374 accuracy is 0.88984375 and loss is 0.25803380012512206
At time: 5.336271524429321 accuracy is 0.8921875 and loss is 0.28850712776184084
Evaluating...
Done Evaluating: Achieved accuracy of 0.6304347826086957
Achieved new best!
Completing Train Step at 2th epoch...
At time: 6.255884170532227 accuracy is 0.8421875 and loss is 0.4021869659423828
At time: 6.540455341339111 accuracy is 0.925 and loss is 0.2074605941772461
At time: 6.837914943695068 accuracy is 0.96875 and loss is 0.11184519529342651
At time: 7.1450746059417725 accuracy is 0.95859375 and loss is 0.13664838075637817
At time: 7.466060400009155 accuracy is 0.92578125 and loss is 0.2817914247512817
At time: 7.800010919570923 accuracy is 0.91328125 and loss is 0.2602827787399292
Evaluating...
Done Evaluating: Achieved accuracy of 0.5679347826086957
Not better for 1
Completing Train Step at 3th epoch...
At time: 8.714768648147583 accuracy is 0.9265625 and loss is 0.2024308204650879
At time: 8.998636960983276 accuracy is 0.9796875 and loss is 0.060803782939910886
At time: 9.290780782699585 accuracy is 0.97734375 and loss is 0.05575141906738281
At time: 9.597598314285278 accuracy is 0.95703125 and loss is 0.10715820789337158
At time: 9.91843032836914 accuracy is 0.9609375 and loss is 0.11761131286621093
At time: 10.258136987686157 accuracy is 0.96328125 and loss is 0.10285128355026245
Evaluating...
Done Evaluating: Achieved accuracy of 0.6389266304347826
Achieved new best!
Completing Train Step at 4th epoch...
At time: 11.171099662780762 accuracy is 0.9671875 and loss is 0.1295116662979126
At time: 11.455036401748657 accuracy is 0.97890625 and loss is 0.06911648511886596
At time: 11.747585535049438 accuracy is 0.9828125 and loss is 0.04810606837272644
At time: 12.051347970962524 accuracy is 0.96875 and loss is 0.08568482398986817
At time: 12.369295597076416 accuracy is 0.99296875 and loss is 0.02564174830913544
At time: 12.706700563430786 accuracy is 0.98203125 and loss is 0.05178971886634827
Evaluating...
Done Evaluating: Achieved accuracy of 0.6222826086956522
Not better for 1
Completing Train Step at 5th epoch...
At time: 13.615720987319946 accuracy is 0.98046875 and loss is 0.06601437330245971
At time: 13.900730848312378 accuracy is 0.99453125 and loss is 0.017530840635299683
At time: 14.195400476455688 accuracy is 0.98046875 and loss is 0.05498831868171692
At time: 14.501881122589111 accuracy is 0.98203125 and loss is 0.03684089183807373
At time: 14.846112966537476 accuracy is 0.95 and loss is 0.13504873514175414
At time: 15.198954343795776 accuracy is 0.9734375 and loss is 0.07369237542152404
Evaluating...
Done Evaluating: Achieved accuracy of 0.546875
Not better for 2
Completing Train Step at 6th epoch...
At time: 16.09752058982849 accuracy is 0.9890625 and loss is 0.04236366152763367
At time: 16.375673532485962 accuracy is 0.9671875 and loss is 0.07069316506385803
At time: 16.665735483169556 accuracy is 0.97265625 and loss is 0.07293693423271179
At time: 16.970365524291992 accuracy is 0.9875 and loss is 0.03189286887645722
At time: 17.287923336029053 accuracy is 0.99296875 and loss is 0.022402547299861908
At time: 17.62391424179077 accuracy is 0.9921875 and loss is 0.019957537949085235
Evaluating...
Done Evaluating: Achieved accuracy of 0.5917119565217391
Not better for 3
Completing Train Step at 7th epoch...
At time: 18.52402687072754 accuracy is 0.978125 and loss is 0.05890718698501587
At time: 18.801342248916626 accuracy is 0.99296875 and loss is 0.02043331563472748
At time: 19.088819980621338 accuracy is 0.9890625 and loss is 0.032432422041893005
At time: 19.39021635055542 accuracy is 0.9875 and loss is 0.026742354035377502
At time: 19.70385432243347 accuracy is 0.9953125 and loss is 0.011631180346012116
At time: 20.036583423614502 accuracy is 0.98828125 and loss is 0.0246849000453949
Evaluating...
Done Evaluating: Achieved accuracy of 0.6117527173913043
Not better for 4
Completing Train Step at 8th epoch...
At time: 20.916752576828003 accuracy is 0.99296875 and loss is 0.03349933624267578
At time: 21.19098162651062 accuracy is 0.9984375 and loss is 0.011230949312448502
At time: 21.47819232940674 accuracy is 0.9921875 and loss is 0.02216212749481201
At time: 21.77953028678894 accuracy is 0.99296875 and loss is 0.021503283083438872
At time: 22.095396041870117 accuracy is 0.98828125 and loss is 0.025867378711700438
At time: 22.427321195602417 accuracy is 0.99609375 and loss is 0.016514429450035097
Evaluating...
Done Evaluating: Achieved accuracy of 0.5241168478260869
Not better for 5
Completing Train Step at 9th epoch...
At time: 23.322391033172607 accuracy is 0.97265625 and loss is 0.08151347041130066
At time: 23.603015184402466 accuracy is 0.99921875 and loss is 0.011334588378667831
At time: 23.893913984298706 accuracy is 0.99375 and loss is 0.014743883907794953
At time: 24.19920063018799 accuracy is 0.9859375 and loss is 0.026581093668937683
At time: 24.51744508743286 accuracy is 0.9984375 and loss is 0.005252954363822937
At time: 24.878631830215454 accuracy is 1.0 and loss is 0.0017851926386356354
Evaluating...
Done Evaluating: Achieved accuracy of 0.5584239130434783
Not better for 6
Completing Train Step at 10th epoch...
At time: 25.84936261177063 accuracy is 0.9953125 and loss is 0.029734423756599425
At time: 26.13225293159485 accuracy is 0.99375 and loss is 0.01965031623840332
At time: 26.42969250679016 accuracy is 0.9921875 and loss is 0.017375461757183075
At time: 26.755363702774048 accuracy is 0.98671875 and loss is 0.03945359885692597
At time: 27.083662509918213 accuracy is 0.9984375 and loss is 0.007807920873165131
At time: 27.425236701965332 accuracy is 0.99765625 and loss is 0.010811746865510941
Evaluating...
Done Evaluating: Achieved accuracy of 0.5743885869565217
Not better for 7
Completing Train Step at 11th epoch...
At time: 28.418400049209595 accuracy is 0.9984375 and loss is 0.0175050288438797
At time: 28.741543769836426 accuracy is 0.99140625 and loss is 0.023723310232162474
At time: 29.06879734992981 accuracy is 0.9828125 and loss is 0.04161161184310913
At time: 29.394209623336792 accuracy is 0.99453125 and loss is 0.015181580185890197
At time: 29.73284101486206 accuracy is 0.96953125 and loss is 0.08892148733139038
At time: 30.0772225856781 accuracy is 0.9671875 and loss is 0.10451096296310425
Evaluating...
Done Evaluating: Achieved accuracy of 0.5838994565217391
Not better for 8
Completing Train Step at 12th epoch...
At time: 31.017260551452637 accuracy is 0.99921875 and loss is 0.01898276209831238
At time: 31.319628477096558 accuracy is 0.984375 and loss is 0.0533312201499939
At time: 31.620373964309692 accuracy is 0.96328125 and loss is 0.10492737293243408
At time: 31.930681705474854 accuracy is 0.9703125 and loss is 0.07768341898918152
At time: 32.2822642326355 accuracy is 0.9984375 and loss is 0.005812663584947586
At time: 32.66286659240723 accuracy is 0.97109375 and loss is 0.0687211036682129
Evaluating...
Done Evaluating: Achieved accuracy of 0.6283967391304348
Not better for 9
Completing Train Step at 13th epoch...
At time: 33.70537042617798 accuracy is 0.9953125 and loss is 0.019591420888900757
At time: 34.02621555328369 accuracy is 0.9984375 and loss is 0.005840270966291428
At time: 34.339191913604736 accuracy is 0.99765625 and loss is 0.011667874455451966
At time: 34.6647789478302 accuracy is 0.9765625 and loss is 0.05459573268890381
At time: 34.98791551589966 accuracy is 0.98125 and loss is 0.05179796814918518
At time: 35.32959032058716 accuracy is 1.0 and loss is 0.001943671889603138
Evaluating...
Done Evaluating: Achieved accuracy of 0.6195652173913043
Not better for 10
Model not improving. Stopping earlyat 0.6389266304347826 epochs.
Done Training. Achieved Best Accuracy of 0.6389266304347826
Improved accuracyfrom -10000000 to 0.6389266304347826
mlpattn
SETTINGS FOR THIS RUN
{'wordvec_dim': 300, 'attention_dim': 92, 'num_layers': 1, 'hidden_size': 300, 'wordvec_source': 'None', 'batch_size': 64, 'lr': 0.004118995359007592, 'pretrained': None, 'fix_pretrained': None, 'attn_type': 'MLP', 'l2': 0.5452047403651691, 'tune_wordvecs': True, 'rnn_dropout': 0.5138355253295064, 'dropout': 0.44967017158067324}
Using CUDA!
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Not using pretrained wordvectors
Building Vocab...
[]
Getting Batches...
Created Iterator with 140 batches
Getting Batches...
Created Iterator with 47 batches
Building model...
MLP
Using Attention model with following args:
{'attn_type': 'MLP', 'tune_attn': 'True', 'num_classes': 2, 'attention_dim': 92, 'num_layers': 1, 'cuda': True, 'hidden_size': 300, 'batch_size': 64, 'train_word_vecs': True, 'vectors': None, 'rnn_dropout': 0.5138355253295064, 'dropout': 0.44967017158067324, 'vocab_size': 16598, 'input_size': 300}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.31604909896850586 accuracy is 0.57421875 and loss is 0.7090329170227051
At time: 0.5994269847869873 accuracy is 0.61875 and loss is 0.6441698551177979
At time: 0.894723653793335 accuracy is 0.74375 and loss is 0.5558045387268067
At time: 1.2023377418518066 accuracy is 0.76640625 and loss is 0.5517199039459229
At time: 1.522963523864746 accuracy is 0.784375 and loss is 0.4872943878173828
At time: 1.8618571758270264 accuracy is 0.8171875 and loss is 0.43665399551391604
Evaluating...
Done Evaluating: Achieved accuracy of 0.5757472826086957
Achieved new best!
Completing Train Step at 1th epoch...
At time: 2.797830820083618 accuracy is 0.8578125 and loss is 0.44619159698486327
At time: 3.098313331604004 accuracy is 0.878125 and loss is 0.3397960186004639
At time: 3.3983941078186035 accuracy is 0.87265625 and loss is 0.3304877996444702
At time: 3.726879596710205 accuracy is 0.903125 and loss is 0.27138638496398926
At time: 4.0659730434417725 accuracy is 0.8953125 and loss is 0.2527939796447754
At time: 4.411641836166382 accuracy is 0.91875 and loss is 0.21230630874633788
Evaluating...
Done Evaluating: Achieved accuracy of 0.6878396739130435
Achieved new best!
Completing Train Step at 2th epoch...
At time: 5.344777345657349 accuracy is 0.803125 and loss is 0.4444749355316162
At time: 5.642751693725586 accuracy is 0.90859375 and loss is 0.30251569747924806
At time: 5.97151517868042 accuracy is 0.91640625 and loss is 0.24530861377716065
At time: 6.296011447906494 accuracy is 0.94296875 and loss is 0.16716021299362183
At time: 6.6268415451049805 accuracy is 0.9578125 and loss is 0.12915854454040526
At time: 6.9999470710754395 accuracy is 0.971875 and loss is 0.09559673070907593
Evaluating...
Done Evaluating: Achieved accuracy of 0.6494565217391305
Not better for 1
Completing Train Step at 3th epoch...
At time: 7.9536449909210205 accuracy is 0.90234375 and loss is 0.2717087745666504
At time: 8.236173629760742 accuracy is 0.940625 and loss is 0.1737991452217102
At time: 8.5289785861969 accuracy is 0.94140625 and loss is 0.17653604745864868
At time: 8.833141326904297 accuracy is 0.9703125 and loss is 0.09833866357803345
At time: 9.15386438369751 accuracy is 0.97109375 and loss is 0.09302997589111328
At time: 9.493152141571045 accuracy is 0.98203125 and loss is 0.05578690767288208
Evaluating...
Done Evaluating: Achieved accuracy of 0.6715353260869565
Not better for 2
Completing Train Step at 4th epoch...
At time: 10.40393853187561 accuracy is 0.92578125 and loss is 0.24047915935516356
At time: 10.684002876281738 accuracy is 0.9515625 and loss is 0.13420802354812622
At time: 10.973799228668213 accuracy is 0.96640625 and loss is 0.11647293567657471
At time: 11.298763275146484 accuracy is 0.97578125 and loss is 0.07464653253555298
At time: 11.638087749481201 accuracy is 0.9828125 and loss is 0.060665237903594973
At time: 11.985316753387451 accuracy is 0.98984375 and loss is 0.038205310702323914
Evaluating...
Done Evaluating: Achieved accuracy of 0.6752717391304348
Not better for 3
Completing Train Step at 5th epoch...
At time: 12.894179582595825 accuracy is 0.91328125 and loss is 0.2482027530670166
At time: 13.174508333206177 accuracy is 0.96328125 and loss is 0.12138103246688843
At time: 13.465465307235718 accuracy is 0.9578125 and loss is 0.12216542959213257
At time: 13.768710613250732 accuracy is 0.975 and loss is 0.06808921694755554
At time: 14.084109544754028 accuracy is 0.98046875 and loss is 0.05750012397766113
At time: 14.419894456863403 accuracy is 0.990625 and loss is 0.035022154450416565
Evaluating...
Done Evaluating: Achieved accuracy of 0.6552309782608695
Not better for 4
Completing Train Step at 6th epoch...
At time: 15.312151432037354 accuracy is 0.93828125 and loss is 0.20118203163146972
At time: 15.593390464782715 accuracy is 0.96640625 and loss is 0.10297168493270874
At time: 15.883008003234863 accuracy is 0.96484375 and loss is 0.10470542907714844
At time: 16.18595051765442 accuracy is 0.9765625 and loss is 0.06682851314544677
At time: 16.50984287261963 accuracy is 0.99296875 and loss is 0.030685433745384218
At time: 16.85982322692871 accuracy is 0.9890625 and loss is 0.03423615992069244
Evaluating...
Done Evaluating: Achieved accuracy of 0.6372282608695652
Not better for 5
Completing Train Step at 7th epoch...
At time: 17.767070055007935 accuracy is 0.95390625 and loss is 0.15562634468078612
At time: 18.049388647079468 accuracy is 0.97421875 and loss is 0.08154805302619934
At time: 18.343295097351074 accuracy is 0.97734375 and loss is 0.07133291959762574
At time: 18.64826273918152 accuracy is 0.9875 and loss is 0.04864194989204407
At time: 18.991623640060425 accuracy is 0.9890625 and loss is 0.03882550597190857
At time: 19.341050386428833 accuracy is 0.99140625 and loss is 0.027788951992988586
Evaluating...
Done Evaluating: Achieved accuracy of 0.6579483695652174
Not better for 6
Completing Train Step at 8th epoch...
At time: 20.2402822971344 accuracy is 0.93828125 and loss is 0.2145925998687744
At time: 20.52267575263977 accuracy is 0.98046875 and loss is 0.05976059436798096
At time: 20.815848350524902 accuracy is 0.9828125 and loss is 0.058474892377853395
At time: 21.12013292312622 accuracy is 0.98671875 and loss is 0.03797295689582825
At time: 21.438957452774048 accuracy is 0.98671875 and loss is 0.037245503067970274
At time: 21.776813507080078 accuracy is 0.990625 and loss is 0.033528685569763184
Evaluating...
Done Evaluating: Achieved accuracy of 0.6487771739130435
Not better for 7
Completing Train Step at 9th epoch...
At time: 22.67398500442505 accuracy is 0.95234375 and loss is 0.15471524000167847
At time: 22.955924034118652 accuracy is 0.9859375 and loss is 0.0483618289232254
At time: 23.249788761138916 accuracy is 0.9828125 and loss is 0.05664612054824829
At time: 23.55528950691223 accuracy is 0.98515625 and loss is 0.042285919189453125
At time: 23.876087427139282 accuracy is 0.9921875 and loss is 0.02336903363466263
At time: 24.214345693588257 accuracy is 0.9890625 and loss is 0.030493491888046266
Evaluating...
Done Evaluating: Achieved accuracy of 0.6463994565217391
Not better for 8
Completing Train Step at 10th epoch...
At time: 25.122146129608154 accuracy is 0.96015625 and loss is 0.13135026693344115
At time: 25.404542207717896 accuracy is 0.98203125 and loss is 0.05253297686576843
At time: 25.698676109313965 accuracy is 0.9796875 and loss is 0.05888277292251587
At time: 26.00415015220642 accuracy is 0.98671875 and loss is 0.04470169544219971
At time: 26.32479190826416 accuracy is 0.99375 and loss is 0.024420371651649474
At time: 26.6620090007782 accuracy is 0.990625 and loss is 0.030703607201576232
Evaluating...
Done Evaluating: Achieved accuracy of 0.6613451086956522
Not better for 9
Completing Train Step at 11th epoch...
At time: 27.568567276000977 accuracy is 0.965625 and loss is 0.12650128602981567
At time: 27.8488667011261 accuracy is 0.98359375 and loss is 0.0413343608379364
At time: 28.140835762023926 accuracy is 0.98203125 and loss is 0.05910676121711731
At time: 28.44487500190735 accuracy is 0.98046875 and loss is 0.05740397572517395
At time: 28.762649536132812 accuracy is 0.99453125 and loss is 0.023036071658134462
At time: 29.09971046447754 accuracy is 0.9859375 and loss is 0.03699633479118347
Evaluating...
Done Evaluating: Achieved accuracy of 0.6545516304347826
Not better for 10
Model not improving. Stopping earlyat 0.6878396739130435 epochs.
Done Training. Achieved Best Accuracy of 0.6878396739130435
Improved accuracyfrom 0.6389266304347826 to 0.6878396739130435
mlpattn
SETTINGS FOR THIS RUN
{'wordvec_dim': 300, 'attention_dim': 75, 'num_layers': 1, 'hidden_size': 300, 'wordvec_source': 'None', 'batch_size': 64, 'lr': 0.0005624021536393611, 'pretrained': None, 'fix_pretrained': None, 'attn_type': 'MLP', 'l2': 0.6872766971796641, 'tune_wordvecs': True, 'rnn_dropout': 0.8729954465624858, 'dropout': 0.8103429405121696}
Using CUDA!
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Not using pretrained wordvectors
Building Vocab...
[]
Getting Batches...
Created Iterator with 140 batches
Getting Batches...
Created Iterator with 47 batches
Building model...
MLP
Using Attention model with following args:
{'attn_type': 'MLP', 'tune_attn': 'True', 'num_classes': 2, 'attention_dim': 75, 'num_layers': 1, 'cuda': True, 'hidden_size': 300, 'batch_size': 64, 'train_word_vecs': True, 'vectors': None, 'rnn_dropout': 0.8729954465624858, 'dropout': 0.8103429405121696, 'vocab_size': 16598, 'input_size': 300}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.31662821769714355 accuracy is 0.56953125 and loss is 0.7147809028625488
At time: 0.6146864891052246 accuracy is 0.66640625 and loss is 0.6239365577697754
At time: 0.908017635345459 accuracy is 0.65078125 and loss is 0.5886154174804688
At time: 1.2131612300872803 accuracy is 0.7375 and loss is 0.5588427066802979
At time: 1.5322265625 accuracy is 0.8109375 and loss is 0.4598033905029297
At time: 1.8695123195648193 accuracy is 0.821875 and loss is 0.4109226703643799
Evaluating...
Done Evaluating: Achieved accuracy of 0.5193614130434783
Achieved new best!
Completing Train Step at 1th epoch...
At time: 2.7799980640411377 accuracy is 0.78125 and loss is 0.5646660804748536
At time: 3.062206745147705 accuracy is 0.83984375 and loss is 0.39272847175598147
At time: 3.3540706634521484 accuracy is 0.85234375 and loss is 0.3679020404815674
At time: 3.6593010425567627 accuracy is 0.8296875 and loss is 0.3714082956314087
At time: 3.986497640609741 accuracy is 0.8796875 and loss is 0.2939059019088745
At time: 4.344781398773193 accuracy is 0.88125 and loss is 0.27903056144714355
Evaluating...
Done Evaluating: Achieved accuracy of 0.47690217391304346
Not better for 1
Completing Train Step at 2th epoch...
At time: 5.264682292938232 accuracy is 0.8515625 and loss is 0.41215062141418457
At time: 5.543254613876343 accuracy is 0.91015625 and loss is 0.2625887870788574
At time: 5.833933353424072 accuracy is 0.8890625 and loss is 0.29752702713012696
At time: 6.137153625488281 accuracy is 0.92578125 and loss is 0.19694983959197998
At time: 6.453120470046997 accuracy is 0.915625 and loss is 0.19898803234100343
At time: 6.78983998298645 accuracy is 0.9296875 and loss is 0.2122013807296753
Evaluating...
Done Evaluating: Achieved accuracy of 0.5105298913043478
Not better for 2
Completing Train Step at 3th epoch...
At time: 7.689996719360352 accuracy is 0.88359375 and loss is 0.30605511665344237
At time: 7.970358371734619 accuracy is 0.95546875 and loss is 0.15371230840682984
At time: 8.261584281921387 accuracy is 0.94296875 and loss is 0.18306053876876832
At time: 8.56578516960144 accuracy is 0.9359375 and loss is 0.16507539749145508
At time: 8.882269620895386 accuracy is 0.94375 and loss is 0.1260924220085144
At time: 9.232181787490845 accuracy is 0.953125 and loss is 0.10279252529144287
Evaluating...
Done Evaluating: Achieved accuracy of 0.5264945652173914
Achieved new best!
Completing Train Step at 4th epoch...
At time: 10.175145864486694 accuracy is 0.96484375 and loss is 0.13844603300094604
At time: 10.4545259475708 accuracy is 0.98359375 and loss is 0.06376670002937317
At time: 10.76690125465393 accuracy is 0.94921875 and loss is 0.13794132471084594
At time: 11.096229553222656 accuracy is 0.975 and loss is 0.07515631318092346
At time: 11.416799783706665 accuracy is 0.984375 and loss is 0.048348790407180785
At time: 11.755210161209106 accuracy is 0.965625 and loss is 0.10867483615875244
Evaluating...
Done Evaluating: Achieved accuracy of 0.595108695652174
Achieved new best!
Completing Train Step at 5th epoch...
At time: 12.657136678695679 accuracy is 0.98984375 and loss is 0.05919793248176575
At time: 12.93598198890686 accuracy is 0.97421875 and loss is 0.07404183149337769
At time: 13.225509881973267 accuracy is 0.9734375 and loss is 0.0645056962966919
At time: 13.533285856246948 accuracy is 0.965625 and loss is 0.07647731900215149
At time: 13.85346269607544 accuracy is 0.98828125 and loss is 0.03415730893611908
At time: 14.192435503005981 accuracy is 0.99375 and loss is 0.02010674625635147
Evaluating...
Done Evaluating: Achieved accuracy of 0.5940896739130435
Not better for 1
Completing Train Step at 6th epoch...
At time: 15.096492767333984 accuracy is 0.99375 and loss is 0.037640875577926634
At time: 15.374489068984985 accuracy is 0.9734375 and loss is 0.07589544057846069
At time: 15.667055368423462 accuracy is 0.9765625 and loss is 0.055221390724182126
At time: 15.973201513290405 accuracy is 0.9796875 and loss is 0.05401535034179687
At time: 16.291902542114258 accuracy is 0.9828125 and loss is 0.03406938016414642
At time: 16.629929542541504 accuracy is 0.98515625 and loss is 0.041561341285705565
Evaluating...
Done Evaluating: Achieved accuracy of 0.548233695652174
Not better for 2
Completing Train Step at 7th epoch...
At time: 17.52485203742981 accuracy is 0.99609375 and loss is 0.022851625084877016
At time: 17.805790901184082 accuracy is 0.96953125 and loss is 0.07525065541267395
At time: 18.097397565841675 accuracy is 0.99453125 and loss is 0.023624271154403687
At time: 18.404420614242554 accuracy is 0.978125 and loss is 0.06012656688690186
At time: 18.72354483604431 accuracy is 0.9890625 and loss is 0.026850932836532594
At time: 19.06117606163025 accuracy is 0.953125 and loss is 0.12412151098251342
Evaluating...
Done Evaluating: Achieved accuracy of 0.5414402173913043
Not better for 3
Completing Train Step at 8th epoch...
At time: 19.952612161636353 accuracy is 0.99140625 and loss is 0.03802470862865448
At time: 20.233227014541626 accuracy is 0.99140625 and loss is 0.026451581716537477
At time: 20.525506019592285 accuracy is 0.99453125 and loss is 0.019577077031135558
At time: 20.83021640777588 accuracy is 0.9984375 and loss is 0.00909351259469986
At time: 21.148417711257935 accuracy is 0.99609375 and loss is 0.012727475166320801
At time: 21.485401391983032 accuracy is 0.99765625 and loss is 0.007603049278259277
Evaluating...
Done Evaluating: Achieved accuracy of 0.5784646739130435
Not better for 4
Completing Train Step at 9th epoch...
At time: 22.380703926086426 accuracy is 0.9859375 and loss is 0.04598369598388672
At time: 22.65865921974182 accuracy is 0.9921875 and loss is 0.0422417163848877
At time: 22.948342323303223 accuracy is 0.98984375 and loss is 0.033077487349510194
At time: 23.25028419494629 accuracy is 0.996875 and loss is 0.01560940146446228
At time: 23.566225051879883 accuracy is 0.9921875 and loss is 0.0242759108543396
At time: 23.899667978286743 accuracy is 0.996875 and loss is 0.009139201790094375
Evaluating...
Done Evaluating: Achieved accuracy of 0.5618206521739131
Not better for 5
Completing Train Step at 10th epoch...
At time: 24.789819955825806 accuracy is 0.996875 and loss is 0.011552884429693221
At time: 25.07049012184143 accuracy is 0.996875 and loss is 0.02021268308162689
At time: 25.375909090042114 accuracy is 0.99375 and loss is 0.021457922458648682
At time: 25.688101053237915 accuracy is 0.99609375 and loss is 0.012330269813537598
At time: 26.003433227539062 accuracy is 0.99296875 and loss is 0.014095143973827362
At time: 26.342782735824585 accuracy is 0.99296875 and loss is 0.015792711079120635
Evaluating...
Done Evaluating: Achieved accuracy of 0.5903532608695652
Not better for 6
Completing Train Step at 11th epoch...
At time: 27.24335741996765 accuracy is 0.99609375 and loss is 0.013274353742599488
At time: 27.52298378944397 accuracy is 0.99140625 and loss is 0.026409205794334412
At time: 27.81413769721985 accuracy is 0.9953125 and loss is 0.012867623567581176
At time: 28.1192467212677 accuracy is 0.99453125 and loss is 0.015801523625850678
At time: 28.437949657440186 accuracy is 0.9875 and loss is 0.03516192138195038
At time: 28.773486614227295 accuracy is 0.9921875 and loss is 0.018534958362579346
Evaluating...
Done Evaluating: Achieved accuracy of 0.5709918478260869
Not better for 7
Completing Train Step at 12th epoch...
At time: 29.688899040222168 accuracy is 0.99765625 and loss is 0.011194124817848206
At time: 29.983208894729614 accuracy is 0.99921875 and loss is 0.006200825795531273
At time: 30.273993015289307 accuracy is 0.996875 and loss is 0.008275322616100311
At time: 30.57855486869812 accuracy is 0.9953125 and loss is 0.012329446524381638
At time: 30.896450996398926 accuracy is 0.99765625 and loss is 0.00970718264579773
At time: 31.23534846305847 accuracy is 0.98984375 and loss is 0.03908420205116272
Evaluating...
Done Evaluating: Achieved accuracy of 0.59375
Not better for 8
Completing Train Step at 13th epoch...
At time: 32.13790678977966 accuracy is 1.0 and loss is 0.004645520448684692
At time: 32.41628575325012 accuracy is 0.996875 and loss is 0.012138383090496063
At time: 32.70671844482422 accuracy is 0.9953125 and loss is 0.012923651933670044
At time: 33.009284019470215 accuracy is 0.9953125 and loss is 0.011710049957036972
At time: 33.32568335533142 accuracy is 0.9984375 and loss is 0.004590599983930588
At time: 33.662997007369995 accuracy is 0.99765625 and loss is 0.007631775736808777
Evaluating...
Done Evaluating: Achieved accuracy of 0.5910326086956522
Not better for 9
Completing Train Step at 14th epoch...
At time: 34.5624783039093 accuracy is 1.0 and loss is 0.0025153875350952147
At time: 34.840553283691406 accuracy is 0.99921875 and loss is 0.0070722982287406925
At time: 35.13026738166809 accuracy is 0.99453125 and loss is 0.0158440425992012
At time: 35.43564820289612 accuracy is 0.99375 and loss is 0.020135337114334108
At time: 35.75537085533142 accuracy is 0.996875 and loss is 0.01144075095653534
At time: 36.092615604400635 accuracy is 0.996875 and loss is 0.010400964319705963
Evaluating...
Done Evaluating: Achieved accuracy of 0.6331521739130435
Achieved new best!
Completing Train Step at 15th epoch...
At time: 37.001325368881226 accuracy is 0.9984375 and loss is 0.008850369602441788
At time: 37.2828574180603 accuracy is 1.0 and loss is 0.0013972658663988114
At time: 37.57147288322449 accuracy is 0.99140625 and loss is 0.03675086498260498
At time: 37.87845802307129 accuracy is 0.98046875 and loss is 0.040758705139160155
At time: 38.19862127304077 accuracy is 0.99375 and loss is 0.013260719180107117
At time: 38.53651428222656 accuracy is 1.0 and loss is 0.00034190663136541844
Evaluating...
Done Evaluating: Achieved accuracy of 0.6426630434782609
Achieved new best!
Completing Train Step at 16th epoch...
At time: 39.43702960014343 accuracy is 0.9953125 and loss is 0.016068555414676666
At time: 39.715049266815186 accuracy is 0.99609375 and loss is 0.007483695447444916
At time: 40.006643533706665 accuracy is 0.99921875 and loss is 0.001872825250029564
At time: 40.31072497367859 accuracy is 0.99765625 and loss is 0.00622376874089241
At time: 40.62936544418335 accuracy is 0.98828125 and loss is 0.03712635636329651
At time: 40.97873044013977 accuracy is 1.0 and loss is 0.00186737310141325
Evaluating...
Done Evaluating: Achieved accuracy of 0.6229619565217391
Not better for 1
Completing Train Step at 17th epoch...
At time: 41.918442487716675 accuracy is 0.996875 and loss is 0.017526078224182128
At time: 42.21731638908386 accuracy is 0.99296875 and loss is 0.026578634977340698
At time: 42.53363227844238 accuracy is 0.9953125 and loss is 0.013684988021850586
At time: 42.85839509963989 accuracy is 0.99921875 and loss is 0.003842981904745102
At time: 43.17560362815857 accuracy is 0.9953125 and loss is 0.020073193311691283
At time: 43.51353049278259 accuracy is 0.9921875 and loss is 0.02787342369556427
Evaluating...
Done Evaluating: Achieved accuracy of 0.5608016304347826
Not better for 2
Completing Train Step at 18th epoch...
At time: 44.41167640686035 accuracy is 0.996875 and loss is 0.00891234502196312
At time: 44.6909339427948 accuracy is 1.0 and loss is 0.0012334631755948067
At time: 44.98245596885681 accuracy is 0.99375 and loss is 0.019115158915519716
At time: 45.28834509849548 accuracy is 0.99453125 and loss is 0.01238376721739769
At time: 45.60814428329468 accuracy is 0.9984375 and loss is 0.0035723380744457243
At time: 45.94534397125244 accuracy is 1.0 and loss is 0.0008954689837992191
Evaluating...
Done Evaluating: Achieved accuracy of 0.5356657608695652
Not better for 3
Completing Train Step at 19th epoch...
At time: 46.85099744796753 accuracy is 0.990625 and loss is 0.020681710541248323
At time: 47.133846044540405 accuracy is 0.99609375 and loss is 0.015766505897045136
At time: 47.426634073257446 accuracy is 0.996875 and loss is 0.008292732387781143
At time: 47.73193287849426 accuracy is 1.0 and loss is 0.0007631925866007805
At time: 48.05099630355835 accuracy is 0.99921875 and loss is 0.0025367164984345437
At time: 48.38817548751831 accuracy is 0.9875 and loss is 0.03473756909370422
Evaluating...
Done Evaluating: Achieved accuracy of 0.6110733695652174
Not better for 4
Completing Train Step at 20th epoch...
At time: 49.353145122528076 accuracy is 0.9953125 and loss is 0.010325318574905396
At time: 49.651403188705444 accuracy is 1.0 and loss is 0.0015830893069505691
At time: 49.96236491203308 accuracy is 0.9984375 and loss is 0.006393708288669586
At time: 50.28812623023987 accuracy is 0.9828125 and loss is 0.0668051779270172
At time: 50.61348366737366 accuracy is 0.9953125 and loss is 0.014137160778045655
At time: 50.949820041656494 accuracy is 1.0 and loss is 0.0005035194102674722
Evaluating...
Done Evaluating: Achieved accuracy of 0.6052989130434783
Not better for 5
Completing Train Step at 21th epoch...
At time: 51.85002875328064 accuracy is 0.9984375 and loss is 0.002958259917795658
At time: 52.12856936454773 accuracy is 1.0 and loss is 0.000842045247554779
At time: 52.418503284454346 accuracy is 1.0 and loss is 0.0011613220907747746
At time: 52.723313093185425 accuracy is 1.0 and loss is 0.001298120617866516
At time: 53.03815245628357 accuracy is 0.99921875 and loss is 0.0021571697667241096
At time: 53.3760712146759 accuracy is 0.9984375 and loss is 0.00538194365799427
Evaluating...
Done Evaluating: Achieved accuracy of 0.5835597826086957
Not better for 6
Completing Train Step at 22th epoch...
At time: 54.28306269645691 accuracy is 0.996875 and loss is 0.011196555197238922
At time: 54.56469798088074 accuracy is 0.99765625 and loss is 0.005502524226903916
At time: 54.85738921165466 accuracy is 0.99609375 and loss is 0.011550097167491913
At time: 55.159119844436646 accuracy is 0.99921875 and loss is 0.0027235429733991623
At time: 55.47818470001221 accuracy is 0.99921875 and loss is 0.0031402382999658586
At time: 55.81527352333069 accuracy is 0.9984375 and loss is 0.0029622895643115045
Evaluating...
Done Evaluating: Achieved accuracy of 0.5750679347826086
Not better for 7
Completing Train Step at 23th epoch...
At time: 56.74533796310425 accuracy is 0.99453125 and loss is 0.017157822847366333
At time: 57.044188499450684 accuracy is 0.99609375 and loss is 0.0163183718919754
At time: 57.34223794937134 accuracy is 0.9984375 and loss is 0.006068405881524086
At time: 57.64642405509949 accuracy is 0.9984375 and loss is 0.004730169102549553
At time: 57.96515464782715 accuracy is 0.9984375 and loss is 0.0053667396306991575
At time: 58.30306315422058 accuracy is 0.99609375 and loss is 0.008107723295688629
Evaluating...
Done Evaluating: Achieved accuracy of 0.5913722826086957
Not better for 8
Completing Train Step at 24th epoch...
At time: 59.20310974121094 accuracy is 0.99921875 and loss is 0.007200012356042862
At time: 59.480003356933594 accuracy is 1.0 and loss is 0.003250959888100624
At time: 59.79072570800781 accuracy is 0.99453125 and loss is 0.014488515257835389
At time: 60.11612153053284 accuracy is 0.9953125 and loss is 0.015660786628723146
At time: 60.43966197967529 accuracy is 0.99921875 and loss is 0.0025152016431093218
At time: 60.77579736709595 accuracy is 1.0 and loss is 0.00015624705702066422
Evaluating...
Done Evaluating: Achieved accuracy of 0.6399456521739131
Not better for 9
Completing Train Step at 25th epoch...
At time: 61.67598366737366 accuracy is 0.9984375 and loss is 0.008246544003486633
At time: 61.95653057098389 accuracy is 1.0 and loss is 0.0008409999310970307
At time: 62.270456314086914 accuracy is 1.0 and loss is 0.0008890470489859581
At time: 62.59426712989807 accuracy is 0.99921875 and loss is 0.0030184200033545492
At time: 62.91584253311157 accuracy is 0.996875 and loss is 0.005863979458808899
At time: 63.25497603416443 accuracy is 0.99765625 and loss is 0.0059188250452280045
Evaluating...
Done Evaluating: Achieved accuracy of 0.6124320652173914
Not better for 10
Model not improving. Stopping earlyat 0.6426630434782609 epochs.
Done Training. Achieved Best Accuracy of 0.6426630434782609
mlpattn
SETTINGS FOR THIS RUN
{'wordvec_dim': 300, 'attention_dim': 63, 'num_layers': 1, 'hidden_size': 300, 'wordvec_source': 'None', 'batch_size': 64, 'lr': 0.004496483612167738, 'pretrained': None, 'fix_pretrained': None, 'attn_type': 'MLP', 'l2': 0.1486761711213579, 'tune_wordvecs': True, 'rnn_dropout': 0.7262412423017037, 'dropout': 0.4349135627957953}
Using CUDA!
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Not using pretrained wordvectors
Building Vocab...
[]
Getting Batches...
Created Iterator with 140 batches
Getting Batches...
Created Iterator with 47 batches
Building model...
MLP
Using Attention model with following args:
{'attn_type': 'MLP', 'tune_attn': 'True', 'num_classes': 2, 'attention_dim': 63, 'num_layers': 1, 'cuda': True, 'hidden_size': 300, 'batch_size': 64, 'train_word_vecs': True, 'vectors': None, 'rnn_dropout': 0.7262412423017037, 'dropout': 0.4349135627957953, 'vocab_size': 16598, 'input_size': 300}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.3233804702758789 accuracy is 0.58359375 and loss is 0.7055888652801514
At time: 0.6244292259216309 accuracy is 0.6859375 and loss is 0.6311916828155517
At time: 0.9300291538238525 accuracy is 0.74375 and loss is 0.5196941375732422
At time: 1.2367961406707764 accuracy is 0.75859375 and loss is 0.513588809967041
At time: 1.557725429534912 accuracy is 0.828125 and loss is 0.394655179977417
At time: 1.8969759941101074 accuracy is 0.81796875 and loss is 0.43575305938720704
Evaluating...
Done Evaluating: Achieved accuracy of 0.6630434782608695
Achieved new best!
Completing Train Step at 1th epoch...
At time: 2.8017897605895996 accuracy is 0.88125 and loss is 0.4230493545532227
At time: 3.0818252563476562 accuracy is 0.8578125 and loss is 0.374674916267395
At time: 3.381175994873047 accuracy is 0.88046875 and loss is 0.30927205085754395
At time: 3.7038156986236572 accuracy is 0.8796875 and loss is 0.3088926553726196
At time: 4.023833274841309 accuracy is 0.925 and loss is 0.18501278162002563
At time: 4.361376762390137 accuracy is 0.88359375 and loss is 0.2948103427886963
Evaluating...
Done Evaluating: Achieved accuracy of 0.6433423913043478
Not better for 1
Completing Train Step at 2th epoch...
At time: 5.264556884765625 accuracy is 0.93203125 and loss is 0.26986510753631593
At time: 5.5789172649383545 accuracy is 0.90859375 and loss is 0.252677321434021
At time: 5.8899030685424805 accuracy is 0.9234375 and loss is 0.20479309558868408
At time: 6.211287021636963 accuracy is 0.925 and loss is 0.2008882522583008
At time: 6.530774116516113 accuracy is 0.96484375 and loss is 0.10933713912963867
At time: 6.868077754974365 accuracy is 0.9578125 and loss is 0.11094914674758911
Evaluating...
Done Evaluating: Achieved accuracy of 0.5832201086956522
Not better for 2
Completing Train Step at 3th epoch...
At time: 7.775410175323486 accuracy is 0.93671875 and loss is 0.18842633962631225
At time: 8.058125257492065 accuracy is 0.9375 and loss is 0.18140180110931398
At time: 8.353975534439087 accuracy is 0.94296875 and loss is 0.16851595640182496
At time: 8.65904450416565 accuracy is 0.959375 and loss is 0.1226813554763794
At time: 8.977348327636719 accuracy is 0.9703125 and loss is 0.08148961067199707
At time: 9.31370759010315 accuracy is 0.96484375 and loss is 0.09046827554702759
Evaluating...
Done Evaluating: Achieved accuracy of 0.6474184782608695
Not better for 3
Completing Train Step at 4th epoch...
At time: 10.217991352081299 accuracy is 0.9703125 and loss is 0.08943512439727783
At time: 10.499284982681274 accuracy is 0.975 and loss is 0.07627936601638793
At time: 10.791353225708008 accuracy is 0.9734375 and loss is 0.0972997009754181
At time: 11.10766077041626 accuracy is 0.9765625 and loss is 0.0741149365901947
At time: 11.44635272026062 accuracy is 0.97421875 and loss is 0.06852583885192871
At time: 11.790115594863892 accuracy is 0.99140625 and loss is 0.02782842516899109
Evaluating...
Done Evaluating: Achieved accuracy of 0.647078804347826
Not better for 4
Completing Train Step at 5th epoch...
At time: 12.69527268409729 accuracy is 0.9625 and loss is 0.12296069860458374
At time: 12.976420879364014 accuracy is 0.95234375 and loss is 0.14262399673461915
At time: 13.26869010925293 accuracy is 0.95 and loss is 0.11601176261901855
At time: 13.573924541473389 accuracy is 0.95859375 and loss is 0.10533527135849
At time: 13.892296314239502 accuracy is 0.9765625 and loss is 0.05408586859703064
At time: 14.227443218231201 accuracy is 0.9859375 and loss is 0.03943640291690827
Evaluating...
Done Evaluating: Achieved accuracy of 0.6511548913043478
Not better for 5
Completing Train Step at 6th epoch...
At time: 15.160646915435791 accuracy is 0.93515625 and loss is 0.1564715623855591
At time: 15.46063780784607 accuracy is 0.9546875 and loss is 0.13322603702545166
At time: 15.754181146621704 accuracy is 0.96328125 and loss is 0.10002131462097168
At time: 16.06109046936035 accuracy is 0.978125 and loss is 0.06617200374603271
At time: 16.380244970321655 accuracy is 0.98515625 and loss is 0.05207998752593994
At time: 16.720542192459106 accuracy is 0.99375 and loss is 0.025605589151382446
Evaluating...
Done Evaluating: Achieved accuracy of 0.6375679347826086
Not better for 6
Completing Train Step at 7th epoch...
At time: 17.633182525634766 accuracy is 0.96796875 and loss is 0.10478749275207519
At time: 17.916373014450073 accuracy is 0.96640625 and loss is 0.09165912866592407
At time: 18.209749698638916 accuracy is 0.96796875 and loss is 0.10513952970504761
At time: 18.51435399055481 accuracy is 0.97265625 and loss is 0.06536085605621338
At time: 18.848490953445435 accuracy is 0.98671875 and loss is 0.037564519047737124
At time: 19.20784854888916 accuracy is 0.98359375 and loss is 0.036790549755096436
Evaluating...
Done Evaluating: Achieved accuracy of 0.6399456521739131
Not better for 7
Completing Train Step at 8th epoch...
At time: 20.118292093276978 accuracy is 0.96875 and loss is 0.08439428806304931
At time: 20.39935612678528 accuracy is 0.96328125 and loss is 0.09484426975250244
At time: 20.689830541610718 accuracy is 0.959375 and loss is 0.13372670412063598
At time: 20.99516534805298 accuracy is 0.98046875 and loss is 0.06268256902694702
At time: 21.31536889076233 accuracy is 0.98828125 and loss is 0.032670322060585025
At time: 21.65308380126953 accuracy is 0.98828125 and loss is 0.04018119275569916
Evaluating...
Done Evaluating: Achieved accuracy of 0.6402853260869565
Not better for 8
Completing Train Step at 9th epoch...
At time: 22.559793710708618 accuracy is 0.96484375 and loss is 0.10474559068679809
At time: 22.840593099594116 accuracy is 0.9734375 and loss is 0.07129407525062562
At time: 23.133649349212646 accuracy is 0.9734375 and loss is 0.07297510504722596
At time: 23.439404249191284 accuracy is 0.9796875 and loss is 0.06620320677757263
At time: 23.758856773376465 accuracy is 0.99140625 and loss is 0.026457655429840087
At time: 24.097992181777954 accuracy is 0.99296875 and loss is 0.023166443407535552
Evaluating...
Done Evaluating: Achieved accuracy of 0.6362092391304348
Not better for 9
Completing Train Step at 10th epoch...
At time: 25.00006937980652 accuracy is 0.96875 and loss is 0.09576236009597779
At time: 25.27938747406006 accuracy is 0.9765625 and loss is 0.06702543497085571
At time: 25.575592756271362 accuracy is 0.9765625 and loss is 0.07337941527366638
At time: 25.879252910614014 accuracy is 0.98203125 and loss is 0.0524503231048584
At time: 26.196163177490234 accuracy is 0.9953125 and loss is 0.018937723338603975
At time: 26.53096580505371 accuracy is 0.996875 and loss is 0.015910239517688753
Evaluating...
Done Evaluating: Achieved accuracy of 0.6297554347826086
Not better for 10
Model not improving. Stopping earlyat 0.6630434782608695 epochs.
Done Training. Achieved Best Accuracy of 0.6630434782608695
mlpattn
SETTINGS FOR THIS RUN
{'wordvec_dim': 300, 'attention_dim': 7, 'num_layers': 1, 'hidden_size': 300, 'wordvec_source': 'None', 'batch_size': 64, 'lr': 0.0008753863999437333, 'pretrained': None, 'fix_pretrained': None, 'attn_type': 'MLP', 'l2': 0.6073303922562039, 'tune_wordvecs': True, 'rnn_dropout': 0.8516859668950922, 'dropout': 0.5637359136240586}
Using CUDA!
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Not using pretrained wordvectors
Building Vocab...
[]
Getting Batches...
Created Iterator with 140 batches
Getting Batches...
Created Iterator with 47 batches
Building model...
MLP
Using Attention model with following args:
{'attn_type': 'MLP', 'tune_attn': 'True', 'num_classes': 2, 'attention_dim': 7, 'num_layers': 1, 'cuda': True, 'hidden_size': 300, 'batch_size': 64, 'train_word_vecs': True, 'vectors': None, 'rnn_dropout': 0.8516859668950922, 'dropout': 0.5637359136240586, 'vocab_size': 16598, 'input_size': 300}
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.2942991256713867 accuracy is 0.6078125 and loss is 0.7050281524658203
At time: 0.5744297504425049 accuracy is 0.703125 and loss is 0.586870527267456
At time: 0.8641421794891357 accuracy is 0.7453125 and loss is 0.5473599910736084
At time: 1.1666336059570312 accuracy is 0.75390625 and loss is 0.5332161903381347
At time: 1.4850883483886719 accuracy is 0.80703125 and loss is 0.43386502265930177
At time: 1.8214242458343506 accuracy is 0.82890625 and loss is 0.3933437347412109
Evaluating...
Done Evaluating: Achieved accuracy of 0.514266304347826
Achieved new best!
Completing Train Step at 1th epoch...
At time: 2.7510287761688232 accuracy is 0.76484375 and loss is 0.5403162956237793
At time: 3.0474653244018555 accuracy is 0.8703125 and loss is 0.36939539909362795
At time: 3.338092088699341 accuracy is 0.86484375 and loss is 0.34791505336761475
At time: 3.643345832824707 accuracy is 0.8546875 and loss is 0.34508025646209717
At time: 3.960659980773926 accuracy is 0.89765625 and loss is 0.23852119445800782
At time: 4.297488689422607 accuracy is 0.90625 and loss is 0.251019024848938
Evaluating...
Done Evaluating: Achieved accuracy of 0.6413043478260869
Achieved new best!
Completing Train Step at 2th epoch...
At time: 5.199981451034546 accuracy is 0.8859375 and loss is 0.3211863040924072
At time: 5.479503631591797 accuracy is 0.94375 and loss is 0.15355758666992186
At time: 5.7728283405303955 accuracy is 0.921875 and loss is 0.2501637935638428
At time: 6.0778584480285645 accuracy is 0.91875 and loss is 0.21058619022369385
At time: 6.396505355834961 accuracy is 0.93671875 and loss is 0.20444262027740479
At time: 6.734345436096191 accuracy is 0.93046875 and loss is 0.17383638620376587
Evaluating...
Done Evaluating: Achieved accuracy of 0.6039402173913043
Not better for 1
Completing Train Step at 3th epoch...
At time: 7.6315531730651855 accuracy is 0.93515625 and loss is 0.19750689268112182
At time: 7.9206202030181885 accuracy is 0.99453125 and loss is 0.04427075386047363
At time: 8.233574151992798 accuracy is 0.946875 and loss is 0.12918001413345337
At time: 8.553025245666504 accuracy is 0.93828125 and loss is 0.22417192459106444
At time: 8.871771097183228 accuracy is 0.90234375 and loss is 0.26757800579071045
At time: 9.209092378616333 accuracy is 0.9703125 and loss is 0.08971944451332092
Evaluating...
Done Evaluating: Achieved accuracy of 0.6463994565217391
Achieved new best!
Completing Train Step at 4th epoch...
At time: 10.11148738861084 accuracy is 0.96953125 and loss is 0.112342369556427
At time: 10.39302921295166 accuracy is 0.99609375 and loss is 0.03128567934036255
At time: 10.68434762954712 accuracy is 0.98203125 and loss is 0.04607047140598297
At time: 10.988635778427124 accuracy is 0.96328125 and loss is 0.10167429447174073
At time: 11.307608604431152 accuracy is 0.96640625 and loss is 0.12674996852874756
At time: 11.643277645111084 accuracy is 0.9609375 and loss is 0.11337360143661498
Evaluating...
Done Evaluating: Achieved accuracy of 0.6042798913043478
Not better for 1
Completing Train Step at 5th epoch...
At time: 12.53915286064148 accuracy is 0.96640625 and loss is 0.10154534578323364
At time: 12.818528175354004 accuracy is 0.9984375 and loss is 0.018976882100105286
At time: 13.108995199203491 accuracy is 0.98828125 and loss is 0.03750559389591217
At time: 13.411887407302856 accuracy is 0.9921875 and loss is 0.02359088808298111
At time: 13.728356122970581 accuracy is 0.9828125 and loss is 0.056794261932373045
At time: 14.063264846801758 accuracy is 0.9796875 and loss is 0.061427724361419675
Evaluating...
Done Evaluating: Achieved accuracy of 0.6212635869565217
Not better for 2
Completing Train Step at 6th epoch...
At time: 14.987995624542236 accuracy is 0.9890625 and loss is 0.042956221103668216
At time: 15.286473274230957 accuracy is 0.99609375 and loss is 0.018919223546981813
At time: 15.582745790481567 accuracy is 0.99765625 and loss is 0.017114007472991945
At time: 15.88658618927002 accuracy is 0.97578125 and loss is 0.08036874532699585
At time: 16.202755451202393 accuracy is 0.96796875 and loss is 0.08199356198310852
At time: 16.53865075111389 accuracy is 0.98671875 and loss is 0.03507187664508819
Evaluating...
Done Evaluating: Achieved accuracy of 0.6531929347826086
Achieved new best!
Completing Train Step at 7th epoch...
At time: 17.45220923423767 accuracy is 0.99375 and loss is 0.032476109266281125
At time: 17.747270584106445 accuracy is 0.99375 and loss is 0.02039188742637634
At time: 18.050222635269165 accuracy is 0.9921875 and loss is 0.020808321237564088
At time: 18.373140335083008 accuracy is 0.9875 and loss is 0.03341885805130005
At time: 18.703160047531128 accuracy is 0.98984375 and loss is 0.03601883351802826
At time: 19.040214776992798 accuracy is 0.9921875 and loss is 0.02277940362691879
Evaluating...
Done Evaluating: Achieved accuracy of 0.556046195652174
Not better for 1
Completing Train Step at 8th epoch...
At time: 19.937650203704834 accuracy is 0.98046875 and loss is 0.05799173712730408
At time: 20.21796202659607 accuracy is 0.9984375 and loss is 0.009441429376602173
At time: 20.50755000114441 accuracy is 0.99765625 and loss is 0.007999768853187561
At time: 20.809754848480225 accuracy is 0.9890625 and loss is 0.023639726638793945
At time: 21.130568742752075 accuracy is 1.0 and loss is 0.004580420628190041
At time: 21.46696901321411 accuracy is 1.0 and loss is 0.0010874537751078607
Evaluating...
Done Evaluating: Achieved accuracy of 0.5635190217391305
Not better for 2
Completing Train Step at 9th epoch...
At time: 22.368356943130493 accuracy is 1.0 and loss is 0.010517358779907227
At time: 22.648509979248047 accuracy is 1.0 and loss is 0.0029963456094264985
At time: 22.938499212265015 accuracy is 0.9953125 and loss is 0.015514986217021942
At time: 23.243666410446167 accuracy is 0.9984375 and loss is 0.008154875040054322
At time: 23.56231117248535 accuracy is 0.99453125 and loss is 0.01060534194111824
At time: 23.899659872055054 accuracy is 0.98515625 and loss is 0.039137420058250424
Evaluating...
Done Evaluating: Achieved accuracy of 0.6144701086956522
Not better for 3
Completing Train Step at 10th epoch...
At time: 24.802762269973755 accuracy is 0.99296875 and loss is 0.031686055660247806
At time: 25.083127737045288 accuracy is 0.98203125 and loss is 0.05118722915649414
At time: 25.37611484527588 accuracy is 0.9875 and loss is 0.026907578110694885
At time: 25.680877447128296 accuracy is 0.996875 and loss is 0.012232621014118195
At time: 25.999796152114868 accuracy is 0.98359375 and loss is 0.03657104671001434
At time: 26.35641622543335 accuracy is 0.99921875 and loss is 0.004469246044754982
Evaluating...
Done Evaluating: Achieved accuracy of 0.5886548913043478
Not better for 4
Completing Train Step at 11th epoch...
At time: 27.272897958755493 accuracy is 0.99765625 and loss is 0.01112002432346344
At time: 27.55191159248352 accuracy is 0.99296875 and loss is 0.020948526263237
At time: 27.844261646270752 accuracy is 0.9890625 and loss is 0.027305710315704345
At time: 28.14909839630127 accuracy is 0.99609375 and loss is 0.010059963911771774
At time: 28.466513633728027 accuracy is 0.99765625 and loss is 0.004383435845375061
At time: 28.80258536338806 accuracy is 0.97890625 and loss is 0.06076157093048096
Evaluating...
Done Evaluating: Achieved accuracy of 0.6525135869565217
Not better for 5
Completing Train Step at 12th epoch...
At time: 29.717496871948242 accuracy is 0.99765625 and loss is 0.009106770157814026
At time: 30.01497793197632 accuracy is 1.0 and loss is 0.0031945414841175078
At time: 30.31189751625061 accuracy is 0.99140625 and loss is 0.028975528478622437
At time: 30.616204977035522 accuracy is 0.9828125 and loss is 0.04850809872150421
At time: 30.9346661567688 accuracy is 0.99921875 and loss is 0.004343247413635254
At time: 31.269511461257935 accuracy is 1.0 and loss is 0.0012851327657699585
Evaluating...
Done Evaluating: Achieved accuracy of 0.6644021739130435
Achieved new best!
Completing Train Step at 13th epoch...
At time: 32.16534924507141 accuracy is 1.0 and loss is 0.004647023975849152
At time: 32.44458365440369 accuracy is 0.99765625 and loss is 0.00456877127289772
At time: 32.75250291824341 accuracy is 1.0 and loss is 0.0008676684461534024
At time: 33.07634258270264 accuracy is 0.996875 and loss is 0.018154294788837434
At time: 33.39929509162903 accuracy is 0.9859375 and loss is 0.03122439682483673
At time: 33.73288154602051 accuracy is 0.99296875 and loss is 0.019597384333610534
Evaluating...
Done Evaluating: Achieved accuracy of 0.6474184782608695
Not better for 1
Completing Train Step at 14th epoch...
At time: 34.61285376548767 accuracy is 1.0 and loss is 0.0023538023233413696
At time: 34.88951253890991 accuracy is 0.98984375 and loss is 0.03616832494735718
At time: 35.1915385723114 accuracy is 0.98359375 and loss is 0.04572840929031372
At time: 35.50136089324951 accuracy is 0.99453125 and loss is 0.011565280705690384
At time: 35.82104754447937 accuracy is 1.0 and loss is 0.00022587040439248085
At time: 36.15612864494324 accuracy is 1.0 and loss is 0.0005244124215096236
Evaluating...
Done Evaluating: Achieved accuracy of 0.5730298913043478
Not better for 2
Completing Train Step at 15th epoch...
At time: 37.054405212402344 accuracy is 0.99765625 and loss is 0.014765232801437378
At time: 37.33491349220276 accuracy is 0.99921875 and loss is 0.0028398472815752028
At time: 37.62964200973511 accuracy is 1.0 and loss is 0.0005292319692671299
At time: 37.93286943435669 accuracy is 0.99609375 and loss is 0.011662103235721588
At time: 38.2496497631073 accuracy is 0.99140625 and loss is 0.019287684559822084
At time: 38.58348727226257 accuracy is 0.99765625 and loss is 0.010267709195613862
Evaluating...
Done Evaluating: Achieved accuracy of 0.6226222826086957
Not better for 3
Completing Train Step at 16th epoch...
At time: 39.486674547195435 accuracy is 1.0 and loss is 0.0023580878973007203
At time: 39.767478227615356 accuracy is 0.9953125 and loss is 0.013929936289787292
At time: 40.06008553504944 accuracy is 0.9875 and loss is 0.029857948422431946
At time: 40.36459469795227 accuracy is 0.9953125 and loss is 0.01853416711091995
At time: 40.68175768852234 accuracy is 1.0 and loss is 6.512012332677841e-05
At time: 41.01770877838135 accuracy is 0.996875 and loss is 0.006889856606721878
Evaluating...
Done Evaluating: Achieved accuracy of 0.65625
Not better for 4
Completing Train Step at 17th epoch...
At time: 41.92016124725342 accuracy is 0.99921875 and loss is 0.00636630728840828
At time: 42.199503898620605 accuracy is 1.0 and loss is 0.0007313866633921861
At time: 42.489837884902954 accuracy is 1.0 and loss is 0.0014968505129218102
At time: 42.79341435432434 accuracy is 0.98984375 and loss is 0.026429390907287596
At time: 43.11046552658081 accuracy is 0.996875 and loss is 0.010291899740695953
At time: 43.449477672576904 accuracy is 1.0 and loss is 0.0005088799633085727
Evaluating...
Done Evaluating: Achieved accuracy of 0.639266304347826
Not better for 5
Completing Train Step at 18th epoch...
At time: 44.354509115219116 accuracy is 1.0 and loss is 0.002439377084374428
At time: 44.63490295410156 accuracy is 0.996875 and loss is 0.009406571835279464
At time: 44.92629384994507 accuracy is 0.996875 and loss is 0.01916545331478119
At time: 45.2298686504364 accuracy is 0.9984375 and loss is 0.008087153732776641
At time: 45.549527168273926 accuracy is 1.0 and loss is 0.00017778361216187478
At time: 45.88578486442566 accuracy is 1.0 and loss is 9.125284850597382e-06
Evaluating...
Done Evaluating: Achieved accuracy of 0.5954483695652174
Not better for 6
Completing Train Step at 19th epoch...
At time: 46.78650689125061 accuracy is 0.9984375 and loss is 0.010726000368595123
At time: 47.064602851867676 accuracy is 0.9953125 and loss is 0.02024605721235275
At time: 47.37845587730408 accuracy is 0.99765625 and loss is 0.008336983621120453
At time: 47.70362663269043 accuracy is 0.99921875 and loss is 0.003301025182008743
At time: 48.022764444351196 accuracy is 1.0 and loss is 0.00040092538110911844
At time: 48.35869383811951 accuracy is 0.9953125 and loss is 0.010528086870908736
Evaluating...
Done Evaluating: Achieved accuracy of 0.6433423913043478
Not better for 7
Completing Train Step at 20th epoch...
At time: 49.25360107421875 accuracy is 1.0 and loss is 0.0024719350039958954
At time: 49.528735399246216 accuracy is 0.99921875 and loss is 0.0015141388401389122
At time: 49.82261347770691 accuracy is 1.0 and loss is 0.0032060783356428145
At time: 50.14653396606445 accuracy is 0.99375 and loss is 0.0173955038189888
At time: 50.46911406517029 accuracy is 0.99765625 and loss is 0.007634744048118591
At time: 50.805267572402954 accuracy is 1.0 and loss is 0.0004213591106235981
Evaluating...
Done Evaluating: Achieved accuracy of 0.6518342391304348
Not better for 8
Completing Train Step at 21th epoch...
At time: 51.6977653503418 accuracy is 0.99921875 and loss is 0.004031604900956154
At time: 51.977059841156006 accuracy is 0.99609375 and loss is 0.01177375465631485
At time: 52.29987835884094 accuracy is 0.99765625 and loss is 0.004536152258515358
At time: 52.606640577316284 accuracy is 1.0 and loss is 0.0006016937550157309
At time: 52.92320275306702 accuracy is 0.99921875 and loss is 0.002343148924410343
At time: 53.25834584236145 accuracy is 0.996875 and loss is 0.00809430405497551
Evaluating...
Done Evaluating: Achieved accuracy of 0.5927309782608695
Not better for 9
Completing Train Step at 22th epoch...
At time: 54.1519775390625 accuracy is 0.996875 and loss is 0.020858803391456605
At time: 54.43911862373352 accuracy is 0.99921875 and loss is 0.0030213193967938423
At time: 54.75180792808533 accuracy is 0.99921875 and loss is 0.0012142314575612546
At time: 55.07342004776001 accuracy is 0.9984375 and loss is 0.005070623755455017
At time: 55.39231061935425 accuracy is 0.9875 and loss is 0.0417111873626709
At time: 55.729004859924316 accuracy is 0.99453125 and loss is 0.019192217290401457
Evaluating...
Done Evaluating: Achieved accuracy of 0.6256793478260869
Not better for 10
Model not improving. Stopping earlyat 0.6644021739130435 epochs.
Done Training. Achieved Best Accuracy of 0.6644021739130435
mlpattn
Saving Model Parameters and Results...
Path:trained_models/classifier/MPQA/viz/bestNonemodel.pt



RESULTS:
[{'best_accuracy': 0.6389266304347826, 'params': {'data': 'MPQA', 'wordvec_dim': 300, 'attention_dim': 49, 'num_layers': 1, 'hidden_size': 300, 'wordvec_source': 'None', 'batch_size': 64, 'lr': 0.0020792530633072207, 'pretrained': None, 'fix_pretrained': None, 'attn_type': 'MLP', 'l2': 0.8390095297425773, 'tune_wordvecs': True, 'rnn_dropout': 0.9828107957486674, 'dropout': 0.18048291831925622}}, {'best_accuracy': 0.6878396739130435, 'params': {'data': 'MPQA', 'wordvec_dim': 300, 'attention_dim': 92, 'num_layers': 1, 'hidden_size': 300, 'wordvec_source': 'None', 'batch_size': 64, 'lr': 0.004118995359007592, 'pretrained': None, 'fix_pretrained': None, 'attn_type': 'MLP', 'l2': 0.5452047403651691, 'tune_wordvecs': True, 'rnn_dropout': 0.5138355253295064, 'dropout': 0.44967017158067324}}, {'best_accuracy': 0.6426630434782609, 'params': {'data': 'MPQA', 'wordvec_dim': 300, 'attention_dim': 75, 'num_layers': 1, 'hidden_size': 300, 'wordvec_source': 'None', 'batch_size': 64, 'lr': 0.0005624021536393611, 'pretrained': None, 'fix_pretrained': None, 'attn_type': 'MLP', 'l2': 0.6872766971796641, 'tune_wordvecs': True, 'rnn_dropout': 0.8729954465624858, 'dropout': 0.8103429405121696}}, {'best_accuracy': 0.6630434782608695, 'params': {'data': 'MPQA', 'wordvec_dim': 300, 'attention_dim': 63, 'num_layers': 1, 'hidden_size': 300, 'wordvec_source': 'None', 'batch_size': 64, 'lr': 0.004496483612167738, 'pretrained': None, 'fix_pretrained': None, 'attn_type': 'MLP', 'l2': 0.1486761711213579, 'tune_wordvecs': True, 'rnn_dropout': 0.7262412423017037, 'dropout': 0.4349135627957953}}, {'best_accuracy': 0.6644021739130435, 'params': {'data': 'MPQA', 'wordvec_dim': 300, 'attention_dim': 7, 'num_layers': 1, 'hidden_size': 300, 'wordvec_source': 'None', 'batch_size': 64, 'lr': 0.0008753863999437333, 'pretrained': None, 'fix_pretrained': None, 'attn_type': 'MLP', 'l2': 0.6073303922562039, 'tune_wordvecs': True, 'rnn_dropout': 0.8516859668950922, 'dropout': 0.5637359136240586}}]
