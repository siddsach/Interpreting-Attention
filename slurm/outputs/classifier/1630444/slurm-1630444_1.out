/home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/classifier/attention_rnn/model.py:206: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  A = torch.squeeze(nn.functional.softmax(s2))
/home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/classifier/attention_rnn/model.py:223: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  decoded = self.normalize(self.decoder(M))
ROOT_PATH: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language
ROOT_PATH: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language
Using CUDA!
MLP
Building RNN Classifier...

[93m    Warning: no model found for 'en'[0m

    Only loading the 'en' tokenizer.

Retrieving Data from file: /home-nfs/siddsach/ml/Interpreting-Attention/interpreting_language/data/mpqa/mpqa_subj_labels.pickle...
Loading Vectors From Memory...
Using these vectors: ['googlenews']
Getting google news vectors
Building Vocab...
[<torchtext.vocab.Vectors object at 0x7efd5bdc1c88>]
Getting Batches...
Created Iterator with 261 batches
Getting Batches...
Created Iterator with 87 batches
Building model...
MLP
Using Attention model with following args:
{'num_layers': 2, 'num_classes': 2, 'rnn_dropout': 0.0, 'batch_size': 32, 'train_word_vecs': False, 'dropout': 0.5, 'hidden_size': 300, 'attention_dim': 300, 'tune_attn': False, 'cuda': True, 'vectors': 
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
          ...             â‹±             ...          
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
 0.0000  0.0000  0.0000  ...   0.0000  0.0000  0.0000
[torch.FloatTensor of size 15284x300]
, 'input_size': 300, 'attn_type': 'MLP', 'vocab_size': 15284}
Not Tuning Word Vectors!
Begin Training...
Completing Train Step at 0th epoch...
At time: 0.45400571823120117 accuracy is 0.575 and loss is 0.7328157424926758
At time: 0.6592936515808105 accuracy is 0.5515625 and loss is 0.6889339447021484
At time: 0.864598274230957 accuracy is 0.5109375 and loss is 0.6976338863372803
At time: 1.078139066696167 accuracy is 0.571875 and loss is 0.6796834945678711
At time: 1.2986924648284912 accuracy is 0.5984375 and loss is 0.707792329788208
At time: 1.531989574432373 accuracy is 0.6984375 and loss is 0.635004997253418
At time: 1.770226240158081 accuracy is 0.575 and loss is 0.6718575954437256
At time: 2.018202543258667 accuracy is 0.6234375 and loss is 0.6563745975494385
At time: 2.2780492305755615 accuracy is 0.665625 and loss is 0.6307208061218261
At time: 2.5497467517852783 accuracy is 0.671875 and loss is 0.6048156261444092
At time: 2.8379406929016113 accuracy is 0.728125 and loss is 0.5732450485229492
At time: 3.150639295578003 accuracy is 0.709375 and loss is 0.5711989879608155
Evaluating...
Done Evaluating: Achieved accuracy of 0.7416424418604651
Achieved new best!
Completing Train Step at 1th epoch...
At time: 4.217879295349121 accuracy is 0.5625 and loss is 0.7467698097229004
At time: 4.416673898696899 accuracy is 0.5875 and loss is 0.6495185852050781
At time: 4.62114953994751 accuracy is 0.6234375 and loss is 0.6146344661712646
At time: 4.832271337509155 accuracy is 0.703125 and loss is 0.6289040565490722
At time: 5.050855398178101 accuracy is 0.6859375 and loss is 0.5674044132232666
At time: 5.2762978076934814 accuracy is 0.7390625 and loss is 0.5456088066101075
At time: 5.508676052093506 accuracy is 0.7078125 and loss is 0.5960632801055908
At time: 5.753692388534546 accuracy is 0.75625 and loss is 0.5356137752532959
At time: 6.0074851512908936 accuracy is 0.7609375 and loss is 0.5228042602539062
At time: 6.275071144104004 accuracy is 0.7265625 and loss is 0.5374586105346679
At time: 6.555002689361572 accuracy is 0.7828125 and loss is 0.4863136291503906
At time: 6.854417324066162 accuracy is 0.746875 and loss is 0.5225469589233398
Evaluating...
Done Evaluating: Achieved accuracy of 0.7678052325581395
Achieved new best!
Completing Train Step at 2th epoch...
At time: 7.894036293029785 accuracy is 0.6703125 and loss is 0.6728150367736816
At time: 8.091738939285278 accuracy is 0.703125 and loss is 0.5924035549163819
At time: 8.30005407333374 accuracy is 0.6921875 and loss is 0.5518408298492432
At time: 8.512133359909058 accuracy is 0.75625 and loss is 0.5104630470275879
At time: 8.732532739639282 accuracy is 0.7734375 and loss is 0.49136624336242674
At time: 8.959291219711304 accuracy is 0.75 and loss is 0.5344244480133057
At time: 9.19307827949524 accuracy is 0.7671875 and loss is 0.4882004737854004
At time: 9.436773300170898 accuracy is 0.79375 and loss is 0.47872653007507326
At time: 9.690913438796997 accuracy is 0.7921875 and loss is 0.46279120445251465
At time: 9.956532001495361 accuracy is 0.775 and loss is 0.4760907649993896
At time: 10.23518967628479 accuracy is 0.8078125 and loss is 0.4628185749053955
At time: 10.535957098007202 accuracy is 0.7609375 and loss is 0.4989777088165283
Evaluating...
Done Evaluating: Achieved accuracy of 0.7950581395348837
Achieved new best!
Completing Train Step at 3th epoch...
At time: 11.574865102767944 accuracy is 0.6828125 and loss is 0.6048502922058105
At time: 11.773330450057983 accuracy is 0.778125 and loss is 0.5131853103637696
At time: 11.979647636413574 accuracy is 0.7703125 and loss is 0.48323769569396974
At time: 12.191000938415527 accuracy is 0.790625 and loss is 0.46813039779663085
At time: 12.405984163284302 accuracy is 0.8046875 and loss is 0.4459710597991943
At time: 12.631176471710205 accuracy is 0.7921875 and loss is 0.48294405937194823
At time: 12.86446475982666 accuracy is 0.7765625 and loss is 0.47647991180419924
At time: 13.104987621307373 accuracy is 0.78125 and loss is 0.44667668342590333
At time: 13.366087436676025 accuracy is 0.8125 and loss is 0.4350736618041992
At time: 13.636513471603394 accuracy is 0.79375 and loss is 0.4465214729309082
At time: 13.921645641326904 accuracy is 0.81875 and loss is 0.38506906032562255
At time: 14.229998350143433 accuracy is 0.78125 and loss is 0.42353243827819825
Evaluating...
Done Evaluating: Achieved accuracy of 0.7834302325581395
Not better for 1
Completing Train Step at 4th epoch...
At time: 15.332708358764648 accuracy is 0.7375 and loss is 0.5964252948760986
At time: 15.572009563446045 accuracy is 0.7796875 and loss is 0.4732049465179443
At time: 15.819305181503296 accuracy is 0.8171875 and loss is 0.44051203727722166
At time: 16.06941866874695 accuracy is 0.8125 and loss is 0.4089709758758545
At time: 16.323400497436523 accuracy is 0.7828125 and loss is 0.43805623054504395
At time: 16.56826424598694 accuracy is 0.771875 and loss is 0.4826961517333984
At time: 16.798811674118042 accuracy is 0.78125 and loss is 0.44342770576477053
At time: 17.035638332366943 accuracy is 0.796875 and loss is 0.43766069412231445
At time: 17.28403067588806 accuracy is 0.815625 and loss is 0.4128398418426514
At time: 17.543567419052124 accuracy is 0.8171875 and loss is 0.41947102546691895
At time: 17.834670305252075 accuracy is 0.825 and loss is 0.3706326723098755
At time: 18.14225172996521 accuracy is 0.7921875 and loss is 0.4153880596160889
Evaluating...
Done Evaluating: Achieved accuracy of 0.7728924418604651
Not better for 2
Completing Train Step at 5th epoch...
At time: 19.182467222213745 accuracy is 0.7375 and loss is 0.5830882549285888
At time: 19.381184101104736 accuracy is 0.796875 and loss is 0.48917255401611326
At time: 19.586403369903564 accuracy is 0.7890625 and loss is 0.4462931156158447
At time: 19.798023223876953 accuracy is 0.8015625 and loss is 0.44452338218688964
At time: 20.013764142990112 accuracy is 0.778125 and loss is 0.4521788120269775
At time: 20.24062705039978 accuracy is 0.821875 and loss is 0.41304502487182615
At time: 20.472050189971924 accuracy is 0.80625 and loss is 0.4520224094390869
At time: 20.713417053222656 accuracy is 0.815625 and loss is 0.4053979396820068
At time: 20.96520209312439 accuracy is 0.81875 and loss is 0.3874866485595703
At time: 21.228347778320312 accuracy is 0.815625 and loss is 0.39878230094909667
At time: 21.507924556732178 accuracy is 0.825 and loss is 0.3725067377090454
At time: 21.807785749435425 accuracy is 0.8171875 and loss is 0.40420899391174314
Evaluating...
Done Evaluating: Achieved accuracy of 0.7921511627906976
Not better for 3
Completing Train Step at 6th epoch...
At time: 22.839481830596924 accuracy is 0.715625 and loss is 0.5950276851654053
At time: 23.038531064987183 accuracy is 0.8 and loss is 0.47110819816589355
At time: 23.2430100440979 accuracy is 0.803125 and loss is 0.44193110466003416
At time: 23.453123092651367 accuracy is 0.8375 and loss is 0.3823536396026611
At time: 23.667808532714844 accuracy is 0.825 and loss is 0.38185222148895265
At time: 23.890674591064453 accuracy is 0.8109375 and loss is 0.4104934215545654
At time: 24.122594356536865 accuracy is 0.7796875 and loss is 0.45589160919189453
At time: 24.363288402557373 accuracy is 0.821875 and loss is 0.3995447874069214
At time: 24.615148544311523 accuracy is 0.8328125 and loss is 0.3591639995574951
At time: 24.87861919403076 accuracy is 0.8234375 and loss is 0.3960140228271484
At time: 25.15626358985901 accuracy is 0.8484375 and loss is 0.3279921531677246
At time: 25.457031726837158 accuracy is 0.7953125 and loss is 0.4348489284515381
Evaluating...
Done Evaluating: Achieved accuracy of 0.764171511627907
Not better for 4
Completing Train Step at 7th epoch...
At time: 26.491634607315063 accuracy is 0.75625 and loss is 0.5536588191986084
At time: 26.690311908721924 accuracy is 0.8046875 and loss is 0.46824951171875
At time: 26.894940614700317 accuracy is 0.815625 and loss is 0.4001744747161865
At time: 27.10569739341736 accuracy is 0.834375 and loss is 0.3690836429595947
At time: 27.32048010826111 accuracy is 0.821875 and loss is 0.37963964939117434
At time: 27.54352855682373 accuracy is 0.8328125 and loss is 0.37642626762390136
At time: 27.77502942085266 accuracy is 0.8015625 and loss is 0.3897911787033081
At time: 28.016050338745117 accuracy is 0.821875 and loss is 0.37944836616516114
At time: 28.2694149017334 accuracy is 0.8359375 and loss is 0.3367972135543823
At time: 28.533162355422974 accuracy is 0.8453125 and loss is 0.3478698253631592
At time: 28.81824040412903 accuracy is 0.846875 and loss is 0.31733710765838624
At time: 29.11807894706726 accuracy is 0.8171875 and loss is 0.3943238496780396
Evaluating...
Done Evaluating: Achieved accuracy of 0.7688953488372093
Not better for 5
Completing Train Step at 8th epoch...
At time: 30.158955097198486 accuracy is 0.746875 and loss is 0.5460596084594727
At time: 30.3574640750885 accuracy is 0.7953125 and loss is 0.46773900985717776
At time: 30.5623197555542 accuracy is 0.834375 and loss is 0.38528785705566404
At time: 30.773135900497437 accuracy is 0.8421875 and loss is 0.37168283462524415
At time: 30.99042534828186 accuracy is 0.8609375 and loss is 0.32282042503356934
At time: 31.21472954750061 accuracy is 0.859375 and loss is 0.33306031227111815
At time: 31.446998119354248 accuracy is 0.8359375 and loss is 0.3774031400680542
At time: 31.688952684402466 accuracy is 0.828125 and loss is 0.36705865859985354
At time: 31.942166328430176 accuracy is 0.84375 and loss is 0.3299661159515381
At time: 32.20673680305481 accuracy is 0.8625 and loss is 0.33941500186920165
At time: 32.48533606529236 accuracy is 0.8828125 and loss is 0.2560799360275269
At time: 32.783576011657715 accuracy is 0.8359375 and loss is 0.4069324493408203
Evaluating...
Done Evaluating: Achieved accuracy of 0.7543604651162791
Not better for 6
Completing Train Step at 9th epoch...
At time: 33.81759572029114 accuracy is 0.753125 and loss is 0.5197774410247803
At time: 34.01616096496582 accuracy is 0.8328125 and loss is 0.42694873809814454
At time: 34.22262668609619 accuracy is 0.8703125 and loss is 0.325754451751709
At time: 34.43345046043396 accuracy is 0.85 and loss is 0.3480158805847168
At time: 34.65152049064636 accuracy is 0.8609375 and loss is 0.29738404750823977
At time: 34.87588572502136 accuracy is 0.8546875 and loss is 0.3375051975250244
At time: 35.10870337486267 accuracy is 0.8015625 and loss is 0.4273398399353027
At time: 35.35051655769348 accuracy is 0.853125 and loss is 0.33083291053771974
At time: 35.60413646697998 accuracy is 0.85 and loss is 0.32399773597717285
At time: 35.86781406402588 accuracy is 0.8625 and loss is 0.3145726203918457
At time: 36.14744830131531 accuracy is 0.9109375 and loss is 0.2290663480758667
At time: 36.44663882255554 accuracy is 0.8546875 and loss is 0.35722100734710693
Evaluating...
Done Evaluating: Achieved accuracy of 0.762718023255814
Not better for 7
Completing Train Step at 10th epoch...
At time: 37.485270738601685 accuracy is 0.7640625 and loss is 0.5135957717895507
At time: 37.683635234832764 accuracy is 0.84375 and loss is 0.3835360765457153
At time: 37.8895800113678 accuracy is 0.884375 and loss is 0.2875060558319092
At time: 38.102787494659424 accuracy is 0.8625 and loss is 0.3253875494003296
At time: 38.31933116912842 accuracy is 0.890625 and loss is 0.2728508710861206
At time: 38.54354643821716 accuracy is 0.85625 and loss is 0.32533385753631594
At time: 38.77608823776245 accuracy is 0.809375 and loss is 0.4474637985229492
At time: 39.01681900024414 accuracy is 0.865625 and loss is 0.30353422164916993
At time: 39.26987409591675 accuracy is 0.8703125 and loss is 0.3105937004089355
At time: 39.53406739234924 accuracy is 0.890625 and loss is 0.2665101528167725
At time: 39.81254172325134 accuracy is 0.8921875 and loss is 0.23790619373321534
At time: 40.110020875930786 accuracy is 0.875 and loss is 0.27688000202178953
Evaluating...
Done Evaluating: Achieved accuracy of 0.7481831395348837
Not better for 8
Completing Train Step at 11th epoch...
At time: 41.149799823760986 accuracy is 0.7953125 and loss is 0.46552176475524903
At time: 41.34791564941406 accuracy is 0.8515625 and loss is 0.348476767539978
At time: 41.5538911819458 accuracy is 0.890625 and loss is 0.27975242137908934
At time: 41.76626968383789 accuracy is 0.875 and loss is 0.29970369338989256
At time: 41.982176542282104 accuracy is 0.890625 and loss is 0.2433523416519165
At time: 42.2051043510437 accuracy is 0.8640625 and loss is 0.2950416564941406
At time: 42.437002420425415 accuracy is 0.8390625 and loss is 0.3848411083221436
At time: 42.67807960510254 accuracy is 0.884375 and loss is 0.26830401420593264
At time: 42.93138837814331 accuracy is 0.8796875 and loss is 0.2756326198577881
At time: 43.19514727592468 accuracy is 0.90625 and loss is 0.23482227325439453
At time: 43.4727668762207 accuracy is 0.9234375 and loss is 0.1814347267150879
At time: 43.7709743976593 accuracy is 0.9171875 and loss is 0.2168505907058716
Evaluating...
Done Evaluating: Achieved accuracy of 0.7401889534883721
Not better for 9
Completing Train Step at 12th epoch...
At time: 44.80770969390869 accuracy is 0.7953125 and loss is 0.47111968994140624
At time: 45.01242995262146 accuracy is 0.8484375 and loss is 0.34024159908294677
At time: 45.21886444091797 accuracy is 0.9078125 and loss is 0.24490320682525635
At time: 45.42972731590271 accuracy is 0.871875 and loss is 0.28111045360565184
At time: 45.64621424674988 accuracy is 0.9046875 and loss is 0.2488316535949707
At time: 45.87017822265625 accuracy is 0.89375 and loss is 0.2573976755142212
At time: 46.10284161567688 accuracy is 0.8671875 and loss is 0.35642132759094236
At time: 46.34385561943054 accuracy is 0.88125 and loss is 0.24859800338745117
At time: 46.59681987762451 accuracy is 0.8984375 and loss is 0.24819371700286866
At time: 46.86004948616028 accuracy is 0.9203125 and loss is 0.20237112045288086
At time: 47.14090371131897 accuracy is 0.9390625 and loss is 0.17007646560668946
At time: 47.44166922569275 accuracy is 0.9234375 and loss is 0.17882719039916992
Evaluating...
Done Evaluating: Achieved accuracy of 0.7503633720930233
Not better for 10
Model not improving. Stopping earlyat 0.7950581395348837 epochs.
Done Training. Achieved Best Accuracy of 0.7950581395348837
